import{_ as J}from"./InstrumentIcon.vue_vue_type_style_index_0_scoped_cbf9e092_lang-D-dukWxj.js";import{c as h,e as c,o as r,f as a,k as $,i as G,t as x,n as V,F as M,h as q,s as O,O as T,G as Q,x as _,l as A,r as S,p as F,C as z,g as U,K as W,J as D,D as L,q as K,w as ee}from"./vendor-2iZwFq-s.js";import{I as j,a as te,h as ae}from"./useTypeRegistry-CiWZAadw.js";import{a as le}from"./index-BoNbj_6K.js";const se=["value"],ne={key:1,class:"form-control"},oe={class:"label"},ie={class:"label-text font-medium"},re={key:0,class:"text-error"},de=["value","placeholder","required","disabled","pattern"],ue=["value","placeholder","required","disabled","min","max","step"],ce=["value","required","disabled"],me={value:""},pe=["value"],fe=["value","required","disabled"],ye=["value","placeholder","required","disabled","rows"],ve={key:5,class:"label"},be={class:"label-text-alt text-base-content/60"},R={__name:"DynamicField",props:{modelValue:{type:[String,Number,Boolean,null],default:null},fieldKey:{type:String,required:!0},config:{type:Object,required:!0},disabled:{type:Boolean,default:!1},size:{type:String,default:"md",validator:e=>["sm","md","lg"].includes(e)}},emits:["update:modelValue"],setup(e,{emit:f}){const s=e,u=f,v=h(()=>`w-full ${{sm:"input-sm",md:"",lg:"input-lg"}[s.size]}`);function b(y){let i=y.target.value;s.config.type==="number"&&i!==""&&(i=Number(i)),u("update:modelValue",i)}const g=h(()=>s.config.options?s.config.options.map(y=>{var i;if(typeof y=="string"){const o=((i=s.config.optionLabels)==null?void 0:i[y])||y;return{value:y,label:o}}return y}):[]);return h(()=>!!s.config.dependsOn&&!!s.config.optionsByParent),(y,i)=>e.config.type==="hidden"?(r(),c("input",{key:0,type:"hidden",value:e.modelValue??e.config.defaultValue},null,8,se)):(r(),c("div",ne,[a("label",oe,[a("span",ie,[G(x(e.config.label)+" ",1),e.config.required?(r(),c("span",re,"*")):$("",!0)])]),e.config.type==="text"||e.config.type==="string"?(r(),c("input",{key:0,type:"text",value:e.modelValue,onInput:b,class:V(["input input-bordered",v.value]),placeholder:e.config.placeholder||"",required:e.config.required,disabled:e.disabled,pattern:e.config.pattern},null,42,de)):e.config.type==="number"?(r(),c("input",{key:1,type:"number",value:e.modelValue,onInput:b,class:V(["input input-bordered",v.value]),placeholder:e.config.placeholder||"",required:e.config.required,disabled:e.disabled,min:e.config.min,max:e.config.max,step:e.config.step||"any"},null,42,ue)):e.config.type==="select"?(r(),c("select",{key:2,value:e.modelValue,onChange:b,class:V(["select select-bordered",v.value]),required:e.config.required,disabled:e.disabled},[a("option",me,x(e.config.placeholder||"Select..."),1),(r(!0),c(M,null,q(g.value,o=>(r(),c("option",{key:o.value,value:o.value},x(o.label),9,pe))),128))],42,ce)):e.config.type==="date"?(r(),c("input",{key:3,type:"date",value:e.modelValue,onInput:b,class:V(["input input-bordered",v.value]),required:e.config.required,disabled:e.disabled},null,42,fe)):e.config.type==="textarea"?(r(),c("textarea",{key:4,value:e.modelValue,onInput:b,class:V(["textarea textarea-bordered",v.value]),placeholder:e.config.placeholder||"",required:e.config.required,disabled:e.disabled,rows:e.config.rows||3},null,42,ye)):$("",!0),e.config.helpText?(r(),c("label",ve,[a("span",be,x(e.config.helpText),1)])):$("",!0)]))}},he={__name:"DynamicFieldGroup",props:{modelValue:{type:Object,default:()=>({})},schema:{type:Object,required:!0},columns:{type:Number,default:2},size:{type:String,default:"sm"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:f}){const s=e,u=f,v=h(()=>Object.entries(s.schema).filter(([,o])=>o.type!=="hidden")),b=h(()=>Object.entries(s.schema).filter(([,o])=>o.type==="hidden")),g=h(()=>{const o={1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4"};return o[s.columns]||o[2]});function y(o,d){u("update:modelValue",{...s.modelValue,[o]:d})}function i(o,d){const p=s.modelValue[o];return p??d.defaultValue??null}return(o,d)=>(r(),c("div",null,[(r(!0),c(M,null,q(b.value,([p,k])=>(r(),O(R,{key:p,"field-key":p,config:k,"model-value":i(p,k),"onUpdate:modelValue":I=>y(p,I)},null,8,["field-key","config","model-value","onUpdate:modelValue"]))),128)),a("div",{class:V(["grid gap-4",g.value])},[(r(!0),c(M,null,q(v.value,([p,k])=>(r(),O(R,{key:p,"field-key":p,config:k,"model-value":i(p,k),size:e.size,disabled:e.disabled,"onUpdate:modelValue":I=>y(p,I)},null,8,["field-key","config","model-value","size","disabled","onUpdate:modelValue"]))),128))],2)]))}};/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ge=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(f,s,u)=>u?u.toUpperCase():s.toLowerCase()),ke=e=>{const f=ge(e);return f.charAt(0).toUpperCase()+f.slice(1)},xe=(...e)=>e.filter((f,s,u)=>!!f&&f.trim()!==""&&u.indexOf(f)===s).join(" ").trim(),H=e=>e==="";/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var C={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=({name:e,iconNode:f,absoluteStrokeWidth:s,"absolute-stroke-width":u,strokeWidth:v,"stroke-width":b,size:g=C.width,color:y=C.stroke,...i},{slots:o})=>T("svg",{...C,...i,width:g,height:g,stroke:y,"stroke-width":H(s)||H(u)||s===!0||u===!0?Number(v||b||C["stroke-width"])*24/Number(g):v||b||C["stroke-width"],class:xe("lucide",i.class,...e?[`lucide-${Z(ke(e))}-icon`,`lucide-${Z(e)}`]:["lucide-icon"])},[...f.map(d=>T(...d)),...o.default?[o.default()]:[]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=(e,f)=>(s,{slots:u,attrs:v})=>T(we,{...v,...s,iconNode:f,name:e},u);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=w("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=w("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=w("leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=w("microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=w("radar",[["path",{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34",key:"z3du51"}],["path",{d:"M4 6h.01",key:"oypzma"}],["path",{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35",key:"qzzz0"}],["path",{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67",key:"1yjesh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67",key:"1u2y91"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"m13.41 10.59 5.66-5.66",key:"mhq4k0"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=w("rainbow",[["path",{d:"M22 17a10 10 0 0 0-20 0",key:"ozegv"}],["path",{d:"M6 17a6 6 0 0 1 12 0",key:"5giftw"}],["path",{d:"M10 17a2 2 0 0 1 4 0",key:"gnsikk"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=w("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=w("thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-vue-next v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=w("waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),Se={__name:"InstrumentIcon",props:{icon:{type:String,required:!0},size:{type:Number,default:20},strokeWidth:{type:Number,default:2},color:{type:String,default:"currentColor"}},setup(e){const u={camera:P,"layer-group":Ve,sun:Ce,leaf:Me,microscope:qe,rainbow:ze,"temperature-high":$e,"wave-square":je,"satellite-dish":Ie}[e.icon]||P;return(v,b)=>(r(),O(_(A(u)),{size:e.size,"stroke-width":e.strokeWidth,style:Q({color:e.color}),class:"inline-block flex-shrink-0"},null,8,["size","stroke-width","style"]))}},Oe=le(Se,[["__scopeId","data-v-cbf9e092"]]),Ne={key:0,class:"form-control"},Te={class:"grid grid-cols-2 md:grid-cols-3 gap-2"},Ae=["value"],Ue={class:"form-control"},Be={class:"bg-base-200 px-4 py-3 rounded-lg font-mono"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Fe={class:"form-control"},De=["value"],Le={class:"form-control"},Re=["value"],Ze={key:1,class:"form-control"},He={class:"label"},Pe={class:"label-text font-medium"},Ge={class:"bg-base-200 p-4 rounded-lg"},Xe={key:2,class:"alert"},Ye={class:"collapse collapse-arrow bg-base-200"},Je={class:"collapse-content space-y-4"},Qe={class:"form-control"},_e={class:"form-control"},We={class:"flex justify-end gap-2 pt-4"},Ke=["disabled"],et=["disabled"],tt={key:0,class:"loading loading-spinner loading-sm"},at={__name:"InstrumentForm",props:{instrument:{type:Object,default:null},platformId:{type:Number,required:!0},platformName:{type:String,required:!0},platformType:{type:String,default:"fixed"},loading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(e,{emit:f}){const s=e,u=f,v=h(()=>Object.entries(j).filter(([n,t])=>t.platformCompatibility?t.platformCompatibility.includes(s.platformType):!0).map(([n,t])=>({value:n,label:t.name,code:t.code,icon:t.icon}))),b=["Active","Inactive","Maintenance","Decommissioned"],g=["active","paused","stopped","error"],y=h(()=>!!s.instrument),i=S("phenocam"),o=S({}),d=S({display_name:"",description:"",status:"Active",measurement_status:"active"}),p=h(()=>te(i.value)),k=h(()=>{const n=p.value;if(!(n!=null&&n.fields))return{};const t={};return Object.entries(n.fields).forEach(([m,l])=>{t[m]={type:l.type||"text",label:l.label,required:l.required||!1,placeholder:l.placeholder,options:l.options,min:l.min,max:l.max,step:l.step,unit:l.unit,defaultValue:l.defaultValue}}),t}),I=h(()=>{const n=ae(i.value)||"XXX";return`${s.platformName}_${n}##`});F(()=>s.instrument,n=>{if(n){const t=Object.keys(j).find(m=>j[m].name===n.instrument_type||m===n.instrument_type.toLowerCase().replace(/\s+/g,""))||"phenocam";i.value=t,d.value={display_name:n.display_name||"",description:n.description||"",status:n.status||"Active",measurement_status:n.measurement_status||"active"},o.value=n.specifications||{}}},{immediate:!0}),F(i,(n,t)=>{if(n!==t&&!y.value){const m=j[n],l={};m!=null&&m.fields&&Object.entries(m.fields).forEach(([N,E])=>{E.defaultValue!==void 0&&(l[N]=E.defaultValue)}),o.value=l}});const B=h(()=>{if(!i.value)return!1;const n=p.value;if(!(n!=null&&n.fields))return!0;for(const[t,m]of Object.entries(n.fields))if(m.required){const l=o.value[t];if(l==null||l==="")return!1}return!0});function X(){if(!B.value)return;const n=p.value,t={platform_id:s.platformId,instrument_type:(n==null?void 0:n.name)||i.value,display_name:d.value.display_name||void 0,description:d.value.description||void 0,status:d.value.status,measurement_status:d.value.measurement_status,specifications:{...o.value}};Object.keys(t).forEach(m=>{(t[m]===void 0||t[m]==="")&&delete t[m]}),Object.keys(t.specifications).forEach(m=>{(t.specifications[m]===void 0||t.specifications[m]==="")&&delete t.specifications[m]}),u("submit",t)}function Y(){u("cancel")}return(n,t)=>{var m;return r(),c("form",{onSubmit:K(X,["prevent"]),class:"space-y-6"},[y.value?$("",!0):(r(),c("div",Ne,[t[6]||(t[6]=a("label",{class:"label"},[a("span",{class:"label-text font-medium"},"Instrument Type *")],-1)),a("div",Te,[(r(!0),c(M,null,q(v.value,l=>(r(),c("label",{key:l.value,class:V(["flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer transition-colors text-sm",i.value===l.value?"border-primary bg-primary/10":"border-base-300 hover:border-primary/50"])},[z(a("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=N=>i.value=N),value:l.value,class:"radio radio-primary radio-sm"},null,8,Ae),[[W,i.value]]),U(A(Oe),{icon:l.icon,size:18,"stroke-width":2,color:l.color},null,8,["icon","color"]),a("span",null,x(l.label),1)],2))),128))])])),a("div",Ue,[t[7]||(t[7]=a("label",{class:"label"},[a("span",{class:"label-text font-medium"},"Instrument Name Preview")],-1)),a("div",Be,x(I.value),1),t[8]||(t[8]=a("label",{class:"label"},[a("span",{class:"label-text-alt text-base-content/60"}," Auto-generated based on platform and instrument type ")],-1))]),a("div",Ee,[a("div",Fe,[t[9]||(t[9]=a("label",{class:"label"},[a("span",{class:"label-text font-medium"},"Status")],-1)),z(a("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>d.value.status=l),class:"select select-bordered w-full"},[(r(),c(M,null,q(b,l=>a("option",{key:l,value:l},x(l),9,De)),64))],512),[[D,d.value.status]])]),a("div",Le,[t[10]||(t[10]=a("label",{class:"label"},[a("span",{class:"label-text font-medium"},"Measurement Status")],-1)),z(a("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>d.value.measurement_status=l),class:"select select-bordered w-full"},[(r(),c(M,null,q(g,l=>a("option",{key:l,value:l},x(l),9,Re)),64))],512),[[D,d.value.measurement_status]])])]),Object.keys(k.value).length>0?(r(),c("div",Ze,[a("label",He,[a("span",Pe,x(((m=p.value)==null?void 0:m.name)||"Instrument")+" Specifications ",1)]),a("div",Ge,[U(A(he),{modelValue:o.value,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value=l),schema:k.value,columns:2,size:"sm"},null,8,["modelValue","schema"])])])):(r(),c("div",Xe,[...t[11]||(t[11]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),a("span",null,"No additional specifications required for this instrument type.",-1)])])),a("div",Ye,[t[14]||(t[14]=a("input",{type:"checkbox"},null,-1)),t[15]||(t[15]=a("div",{class:"collapse-title font-medium"}," Optional Fields ",-1)),a("div",Je,[a("div",Qe,[t[12]||(t[12]=a("label",{class:"label"},[a("span",{class:"label-text"},"Display Name")],-1)),z(a("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>d.value.display_name=l),type:"text",class:"input input-bordered",placeholder:"Human-readable name"},null,512),[[L,d.value.display_name]])]),a("div",_e,[t[13]||(t[13]=a("label",{class:"label"},[a("span",{class:"label-text"},"Description")],-1)),z(a("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>d.value.description=l),class:"textarea textarea-bordered",rows:"2",placeholder:"Instrument description..."},null,512),[[L,d.value.description]])])])]),a("div",We,[a("button",{type:"button",class:"btn btn-ghost",onClick:Y,disabled:e.loading}," Cancel ",8,Ke),a("button",{type:"submit",class:"btn btn-primary",disabled:!B.value||e.loading},[e.loading?(r(),c("span",tt)):$("",!0),G(" "+x(y.value?"Update Instrument":"Create Instrument"),1)],8,et)])],32)}}},it={__name:"InstrumentFormModal",props:{modelValue:{type:Boolean,default:!1},instrument:{type:Object,default:null},platformId:{type:Number,required:!0},platformName:{type:String,required:!0},platformType:{type:String,default:"fixed"}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:f}){const s=e,u=f,v=S(!1),b=h(()=>!!s.instrument),g=h(()=>b.value?"Edit Instrument":"Create Instrument");async function y(d){v.value=!0;try{u("submit",d)}finally{v.value=!1}}function i(){u("update:modelValue",!1),u("cancel")}function o(){u("update:modelValue",!1)}return(d,p)=>(r(),O(J,{"model-value":e.modelValue,title:g.value,size:"lg","onUpdate:modelValue":p[0]||(p[0]=k=>d.$emit("update:modelValue",k)),onClose:o},{default:ee(()=>[U(at,{instrument:e.instrument,"platform-id":e.platformId,"platform-name":e.platformName,"platform-type":e.platformType,loading:v.value,onSubmit:y,onCancel:i},null,8,["instrument","platform-id","platform-name","platform-type","loading"])]),_:1},8,["model-value","title"]))}};export{it as _};
