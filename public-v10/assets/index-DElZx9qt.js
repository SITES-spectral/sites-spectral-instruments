const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginView-BYGaLZ6Z.js","assets/vendor-DIThaKhE.js","assets/DashboardView-BYo5H3dc.js","assets/BaseModal-CYDQdZr3.js","assets/ExportModal-SNLpOu0L.js","assets/DashboardView-9lEwX2Zo.css","assets/AdminDashboardView-BNkn9Yny.js","assets/AdminView-Hjqh_-kc.js","assets/StationView-HLl63A5C.js","assets/useTypeRegistry-Cq5ebRSc.js","assets/SatellitePlatformDetails-BjgdXvpg.js","assets/PlatformView-BWYmUbRr.js","assets/InstrumentFormModal-Drrb1Oa2.js","assets/InstrumentView-BULM1hKe.js","assets/InstrumentView-C-nXLWy3.css","assets/NotFoundView-atMAHYoN.js"])))=>i.map(i=>d[i]);
import{d as G,r as A,c as S,u as ee,a as fe,b as te,e as x,o as _,f as r,g as C,w as E,h as H,F as O,i as q,t as B,j as ne,k as L,l as z,n as T,m as ve,p as pe,q as se,T as he,s as Q,v as ge,x as we,y as _e,z as ye,A as be,B as xe}from"./vendor-DIThaKhE.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))t(c);new MutationObserver(c=>{for(const i of c)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&t(m)}).observe(document,{childList:!0,subtree:!0});function n(c){const i={};return c.integrity&&(i.integrity=c.integrity),c.referrerPolicy&&(i.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?i.credentials="include":c.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(c){if(c.ep)return;c.ep=!0;const i=n(c);fetch(c.href,i)}})();const U="/api/v10";function ke(){return localStorage.getItem("auth_token")}function Z(){const e=new Headers({"Content-Type":"application/json"}),a=ke();return a&&e.set("Authorization",`Bearer ${a}`),e}async function W(e){const a=await e.json();if(!e.ok)throw e.status===401?(localStorage.removeItem("auth_token"),window.location.href="/login",new Error("Session expired. Please login again.")):new Error(a.error||a.message||`HTTP error ${e.status}`);return a}const P={async get(e,a={}){const n=new URL(`${U}${e}`,window.location.origin);Object.entries(a).forEach(([c,i])=>{i!=null&&n.searchParams.set(c,i)});const t=await fetch(n.toString(),{method:"GET",headers:Z()});return W(t)},async post(e,a={}){const n=await fetch(`${U}${e}`,{method:"POST",headers:Z(),body:JSON.stringify(a)});return W(n)},async put(e,a={}){const n=await fetch(`${U}${e}`,{method:"PUT",headers:Z(),body:JSON.stringify(a)});return W(n)},async delete(e,a={}){const n=new URL(`${U}${e}`,window.location.origin);Object.entries(a).forEach(([c,i])=>{i!=null&&n.searchParams.set(c,i)});const t=await fetch(n.toString(),{method:"DELETE",headers:Z()});return W(t)}},Se=["admin","spectral-admin","sites-admin","sites-spectral-admin"],X=["admin","spectral-admin","sites-admin","sites-spectral-admin"],J=G("auth",()=>{const e=A(null),a=A(localStorage.getItem("auth_token")),n=A("/"),t=S(()=>e.value?!!(Se.includes(e.value.role)||X.includes(e.value.username)):!1),c=S(()=>{if(!e.value)return!1;if(e.value.role==="station-admin")return!0;const s=e.value.username||"";return s.endsWith("-admin")&&!X.includes(s)}),i=S(()=>!e.value||t.value||c.value?!1:e.value.role==="station"||!!e.value.station_id),m=S(()=>!!a.value&&!!e.value),f=S(()=>{var s;return t.value?"admin":c.value?"station-admin":i.value?"station":((s=e.value)==null?void 0:s.role)||"readonly"}),p=S(()=>{var s;return((s=e.value)==null?void 0:s.station_id)||null}),y=S(()=>{var o;if(!((o=e.value)!=null&&o.username))return null;const s=e.value.username;return s.endsWith("-admin")&&!X.includes(s)?s.replace(/-admin$/,""):i.value&&!s.includes("-")?s:null});function v(s){if(t.value)return!0;if(c.value){const o=y.value;return typeof s=="string"?s.toLowerCase()===(o==null?void 0:o.toLowerCase()):p.value===s}return!!(i.value&&p.value===s)}async function d(s,o){try{const w=await P.post("/auth/login",{username:s,password:o});return w.success?(a.value=w.token,e.value=w.user,localStorage.setItem("auth_token",w.token),!0):!1}catch(w){return console.error("Login error:",w),!1}}function g(){a.value=null,e.value=null,localStorage.removeItem("auth_token")}async function k(){if(!a.value)return!1;try{const s=await P.get("/auth/me");return s.success?(e.value=s.user,!0):(g(),!1)}catch{return g(),!1}}function b(s){n.value=s}function h(){const s=n.value;return n.value="/",s}return{user:e,token:a,redirectPath:n,isAuthenticated:m,isAdmin:t,isStationAdmin:c,isStationUser:i,userRole:f,userStation:p,userStationFromUsername:y,canEditStation:v,login:d,logout:g,initialize:k,setRedirectPath:b,getRedirectPath:h}}),oe=G("stations",()=>{const e=A([]),a=A(null),n=A(!1),t=A(null),c=S(()=>e.value.length),i=S(()=>e.value.filter(d=>d.status==="Active")),m=S(()=>d=>e.value.find(g=>g.acronym===d));async function f(){n.value=!0,t.value=null;try{const d=await P.get("/stations");d.data?e.value=d.data||[]:d.success?e.value=d.data||[]:t.value=d.error||"Failed to fetch stations"}catch(d){t.value=d.message}finally{n.value=!1}}async function p(d){n.value=!0,t.value=null;try{const g=await P.get(`/stations/${d}`),k=g.data||(g.success?g.data:null);return k?(a.value=k,k):(t.value=g.error||"Station not found",null)}catch(g){return t.value=g.message,null}finally{n.value=!1}}async function y(d,g){n.value=!0,t.value=null;try{const k=await P.put(`/stations/${d}`,g),b=k.data||(k.success?k.data:null);if(b){a.value=b;const h=e.value.findIndex(s=>s.id===d);return h!==-1&&(e.value[h]=b),b}else return t.value=k.error||"Failed to update station",null}catch(k){return t.value=k.message,null}finally{n.value=!1}}function v(){a.value=null}return{stations:e,currentStation:a,loading:n,error:t,stationCount:c,activeStations:i,getStationByAcronym:m,fetchStations:f,fetchStation:p,updateStation:y,clearCurrentStation:v}}),Ae={class:"navbar bg-base-100 shadow-lg sticky top-0 z-50"},$e={class:"navbar-start"},Pe={class:"navbar-center hidden lg:flex"},Ie={class:"breadcrumbs text-sm"},Me={class:"navbar-end"},Ce={key:0,class:"dropdown dropdown-end mr-2"},Ee={tabindex:"0",class:"menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow-lg bg-base-100 rounded-box w-52"},ze={class:"dropdown dropdown-end"},Ve={tabindex:"0",role:"button",class:"btn btn-ghost gap-2"},Le={class:"avatar placeholder"},Be={class:"bg-neutral text-neutral-content rounded-full w-8"},Te={class:"text-xs"},je={class:"hidden sm:inline"},He={tabindex:"0",class:"menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow-lg bg-base-100 rounded-box w-52"},Ne={key:0},De={key:1},Re={__name:"TheNavbar",setup(e){const a=ee(),n=fe(),t=J(),c=oe(),i=S(()=>{const y=[{name:"Home",path:"/"}];return a.params.acronym&&y.push({name:a.params.acronym,path:`/stations/${a.params.acronym}`}),y}),m=S(()=>{var v,d;const y=(v=t.user)==null?void 0:v.station_normalized_name;if(y&&!t.isAdmin){const g=c.stations.find(k=>k.normalized_name===y);if(g!=null&&g.display_name)return g.display_name}return((d=t.user)==null?void 0:d.username)||"User"}),f=S(()=>{const y=t.userRole;return{admin:"badge-primary",station:"badge-secondary",readonly:"badge-ghost"}[y]||"badge-ghost"});async function p(){t.logout(),n.push("/login")}return(y,v)=>{const d=te("router-link");return _(),x("nav",Ae,[r("div",$e,[C(d,{to:"/",class:"btn btn-ghost normal-case text-xl"},{default:E(()=>[...v[0]||(v[0]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1),H(" SITES Spectral ",-1)])]),_:1})]),r("div",Pe,[r("div",Ie,[r("ul",null,[(_(!0),x(O,null,q(i.value,g=>(_(),x("li",{key:g.path},[C(d,{to:g.path,class:"hover:text-primary"},{default:E(()=>[H(B(g.name),1)]),_:2},1032,["to"])]))),128))])])]),r("div",Me,[v[8]||(v[8]=ne('<label class="swap swap-rotate btn btn-ghost btn-circle mr-2"><input type="checkbox" class="theme-controller" value="dark"><svg class="swap-on fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"></path></svg><svg class="swap-off fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"></path></svg></label>',1)),z(t).isAdmin?(_(),x("div",Ce,[r("div",{tabindex:"0",role:"button",class:T(["btn btn-ghost btn-sm",{"btn-active":z(a).path.startsWith("/admin")}])},[...v[1]||(v[1]=[ne('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg><span class="hidden md:inline">Admin</span><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',3)])],2),r("ul",Ee,[r("li",null,[C(d,{to:"/admin",class:T({active:z(a).path==="/admin"})},{default:E(()=>[...v[2]||(v[2]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),H(" Dashboard ",-1)])]),_:1},8,["class"])]),r("li",null,[C(d,{to:"/admin/settings",class:T({active:z(a).path==="/admin/settings"})},{default:E(()=>[...v[3]||(v[3]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),H(" Users & Settings ",-1)])]),_:1},8,["class"])])])])):L("",!0),r("div",ze,[r("div",Ve,[r("div",Le,[r("div",Be,[r("span",Te,B(m.value.charAt(0).toUpperCase()),1)])]),r("span",je,B(m.value),1),r("span",{class:T(["badge badge-sm",f.value])},B(z(t).userRole),3)]),r("ul",He,[z(t).isAdmin?(_(),x("li",Ne,[C(d,{to:"/admin"},{default:E(()=>[...v[4]||(v[4]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),H(" Admin Dashboard ",-1)])]),_:1})])):L("",!0),z(t).isAdmin?(_(),x("li",De,[C(d,{to:"/admin/settings"},{default:E(()=>[...v[5]||(v[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),H(" Users & Settings ",-1)])]),_:1})])):L("",!0),v[6]||(v[6]=r("li",null,[r("a",{class:"justify-between"},[H(" Profile "),r("span",{class:"badge badge-sm badge-outline"},"Coming soon")])],-1)),v[7]||(v[7]=r("li",{class:"divider"},null,-1)),r("li",null,[r("button",{onClick:p,class:"text-error"}," Logout ")])])])])])}}},Fe=G("platforms",()=>{const e=A([]),a=A(null),n=A(!1),t=A(null),c=S(()=>e.value.length),i=S(()=>{const b={fixed:[],uav:[],satellite:[]};return e.value.forEach(h=>{const s=h.platform_type||"fixed";b[s]&&b[s].push(h)}),b}),m=S(()=>e.value.filter(b=>b.status==="Active"));async function f(b){n.value=!0,t.value=null;try{const h=await P.get(`/platforms/station/${b}`);h.data?e.value=h.data||[]:h.success?e.value=h.data||[]:t.value=h.error||"Failed to fetch platforms"}catch(h){t.value=h.message}finally{n.value=!1}}async function p(b){n.value=!0,t.value=null;try{const h=await P.get(`/platforms/${b}`),s=h.data||(h.success?h.data:null);return s?(a.value=s,s):(t.value=h.error||"Platform not found",null)}catch(h){return t.value=h.message,null}finally{n.value=!1}}async function y(b){n.value=!0,t.value=null;try{const h=await P.post("/platforms",b),s=h.data||(h.success?h.data:null);return s?(e.value.push(s),s):(t.value=h.error||"Failed to create platform",null)}catch(h){return t.value=h.message,null}finally{n.value=!1}}async function v(b,h){var s;n.value=!0,t.value=null;try{const o=await P.put(`/platforms/${b}`,h),w=o.data||(o.success?o.data:null);if(w){const I=e.value.findIndex(j=>j.id===b);return I!==-1&&(e.value[I]=w),((s=a.value)==null?void 0:s.id)===b&&(a.value=w),w}else return t.value=o.error||"Failed to update platform",null}catch(o){return t.value=o.message,null}finally{n.value=!1}}async function d(b){var h;n.value=!0,t.value=null;try{const s=await P.delete(`/platforms/${b}`);return s.deleted||s.success?(e.value=e.value.filter(o=>o.id!==b),((h=a.value)==null?void 0:h.id)===b&&(a.value=null),!0):(t.value=s.error||"Failed to delete platform",!1)}catch(s){return t.value=s.message,!1}finally{n.value=!1}}function g(){a.value=null}function k(){e.value=[],a.value=null}return{platforms:e,currentPlatform:a,loading:n,error:t,platformCount:c,platformsByType:i,activePlatforms:m,fetchPlatformsByStation:f,fetchPlatform:p,createPlatform:y,updatePlatform:v,deletePlatform:d,clearCurrentPlatform:g,clearPlatforms:k}}),Oe=G("instruments",()=>{const e=A([]),a=A(null),n=A(!1),t=A(null),c=S(()=>e.value.length),i=S(()=>{const s={};return e.value.forEach(o=>{const w=o.instrument_type||"Unknown";s[w]||(s[w]=[]),s[w].push(o)}),s}),m=S(()=>e.value.filter(s=>s.status==="Active")),f=S(()=>e.value.filter(s=>s.measurement_status==="Operational"));async function p(s){n.value=!0,t.value=null;try{const o=await P.get(`/instruments/platform/${s}`);o.data?e.value=o.data||[]:o.success?e.value=o.data||[]:t.value=o.error||"Failed to fetch instruments"}catch(o){t.value=o.message}finally{n.value=!1}}async function y(s){n.value=!0,t.value=null;try{const o=await P.get(`/instruments/station/${s}`);o.data?e.value=o.data||[]:o.success?e.value=o.data||[]:t.value=o.error||"Failed to fetch instruments"}catch(o){t.value=o.message}finally{n.value=!1}}async function v(s){n.value=!0,t.value=null;try{const o=await P.get(`/instruments/${s}`),w=o.data||(o.success?o.data:null);return w?(a.value=w,w):(t.value=o.error||"Instrument not found",null)}catch(o){return t.value=o.message,null}finally{n.value=!1}}async function d(s){n.value=!0,t.value=null;try{const o=await P.post("/instruments",s),w=o.data||(o.success?o.data:null);return w?(e.value.push(w),w):(t.value=o.error||"Failed to create instrument",null)}catch(o){return t.value=o.message,null}finally{n.value=!1}}async function g(s,o){var w;n.value=!0,t.value=null;try{const I=await P.put(`/instruments/${s}`,o),j=I.data||(I.success?I.data:null);if(j){const R=e.value.findIndex(Y=>Y.id===s);return R!==-1&&(e.value[R]=j),((w=a.value)==null?void 0:w.id)===s&&(a.value=j),j}else return t.value=I.error||"Failed to update instrument",null}catch(I){return t.value=I.message,null}finally{n.value=!1}}async function k(s){var o;n.value=!0,t.value=null;try{const w=await P.delete(`/instruments/${s}`);return w.deleted||w.success?(e.value=e.value.filter(I=>I.id!==s),((o=a.value)==null?void 0:o.id)===s&&(a.value=null),!0):(t.value=w.error||"Failed to delete instrument",!1)}catch(w){return t.value=w.message,!1}finally{n.value=!1}}function b(){a.value=null}function h(){e.value=[],a.value=null}return{instruments:e,currentInstrument:a,loading:n,error:t,instrumentCount:c,instrumentsByType:i,activeInstruments:m,operationalInstruments:f,fetchInstrumentsByPlatform:p,fetchInstrumentsByStation:y,fetchInstrument:v,createInstrument:d,updateInstrument:g,deleteInstrument:k,clearCurrentInstrument:b,clearInstruments:h}}),qe={class:"w-64 bg-base-100 min-h-screen border-r border-base-200 fixed left-0 top-16 overflow-y-auto pb-20"},Ue={class:"p-3"},Ze={class:"flex items-center justify-between mb-3 px-1"},We={class:"badge badge-primary badge-xs"},Ge={key:0,class:"flex justify-center py-8"},Je={key:1,class:"alert alert-error text-xs p-2"},Ke={key:2,class:"menu menu-xs bg-base-100 rounded-lg p-0 gap-0.5"},Ye={class:"flex items-center gap-1 p-0"},Qe=["onClick"],Xe={class:"font-medium"},et={class:"text-xs text-base-content/50 truncate hidden lg:inline"},tt={key:0,class:"ml-4 pl-2 border-l border-base-300"},nt={key:0,class:"py-2 pl-2"},st={class:"flex items-center gap-1 p-0"},at=["onClick"],rt={xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 flex-shrink-0 text-base-content/60",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ot=["d"],lt={class:"truncate"},it={key:0,class:"ml-4 pl-2 border-l border-base-300"},ut={key:0,class:"py-1 pl-2"},ct={xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 flex-shrink-0 text-base-content/50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},dt=["d"],mt={class:"truncate"},ft={key:1,class:"py-1 pl-2 text-xs text-base-content/40 italic"},vt={key:1,class:"py-2 pl-2 text-xs text-base-content/40 italic"},pt={key:3,class:"mt-6 pt-4 border-t border-base-200"},ht={class:"menu menu-xs p-0"},gt={__name:"TheSidebar",setup(e){const a=ee(),n=oe(),t=Fe(),c=Oe(),i=J(),m=A(new Set),f=A(new Set),p=A({}),y=A({}),v=A(new Set),d=A(new Set);ve(async()=>{n.stations.length===0&&await n.fetchStations()});const g=S(()=>a.params.acronym),k=S(()=>a.params.id?parseInt(a.params.id):null),b=S(()=>a.name==="instrument"&&a.params.id?parseInt(a.params.id):null);pe([g,k,b],async()=>{if(g.value){m.value.add(g.value);const u=h.value.find(l=>l.acronym===g.value);u&&!p.value[u.id]&&await w(u)}if(k.value&&t.currentPlatform){const u=t.currentPlatform;m.value.add(u.station_acronym),f.value.add(k.value),y.value[k.value]||await I(k.value)}if(b.value&&c.currentInstrument){const l=c.currentInstrument.platform_id;f.value.add(l),y.value[l]||await I(l)}},{immediate:!0});const h=S(()=>{var V;const u=n.activeStations;if(i.isAdmin)return u;const l=(V=i.user)==null?void 0:V.station_normalized_name;return l?u.filter(M=>{var $;return M.normalized_name===l||(($=M.acronym)==null?void 0:$.toLowerCase())===l.toLowerCase()}):u});async function s(u){const l=u.acronym;m.value.has(l)?m.value.delete(l):(m.value.add(l),p.value[u.id]||await w(u))}async function o(u){f.value.has(u)?f.value.delete(u):(f.value.add(u),y.value[u]||await I(u))}async function w(u){if(!v.value.has(u.id)){v.value.add(u.id);try{const l=await fetch(`/api/v10/platforms/station/${u.id}`);if(l.ok){const V=await l.json();p.value[u.id]=V.data||[]}}catch(l){console.error("Failed to load platforms:",l)}finally{v.value.delete(u.id)}}}async function I(u){if(!d.value.has(u)){d.value.add(u);try{const l=await fetch(`/api/v10/instruments/platform/${u}`);if(l.ok){const V=await l.json();y.value[u]=V.data||[]}}catch(l){console.error("Failed to load instruments:",l)}finally{d.value.delete(u)}}}function j(u){return p.value[u]||[]}function R(u){return y.value[u]||[]}function Y(u){return g.value===u&&!k.value}function ue(u){return k.value===u&&!b.value}function ce(u){return b.value===u}function de(u){const l={fixed:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4",uav:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8",satellite:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"};return l[u]||l.fixed}function me(u){const l=(u==null?void 0:u.toLowerCase())||"";return l.includes("phenocam")||l.includes("camera")?"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z":l.includes("multispectral")?"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253":"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"}return(u,l)=>{const V=te("router-link");return _(),x("aside",qe,[r("div",Ue,[r("div",Ze,[l[0]||(l[0]=r("h2",{class:"text-sm font-semibold text-base-content/70 uppercase tracking-wide"},"Navigation",-1)),r("span",We,B(h.value.length),1)]),z(n).loading?(_(),x("div",Ge,[...l[1]||(l[1]=[r("span",{class:"loading loading-spinner loading-sm"},null,-1)])])):z(n).error?(_(),x("div",Je,[r("span",null,B(z(n).error),1)])):(_(),x("ul",Ke,[(_(!0),x(O,null,q(h.value,M=>(_(),x("li",{key:M.acronym},[r("div",Ye,[r("button",{class:"btn btn-ghost btn-xs btn-square",onClick:se($=>s(M),["stop"])},[(_(),x("svg",{xmlns:"http://www.w3.org/2000/svg",class:T(["h-3 w-3 transition-transform",{"rotate-90":m.value.has(M.acronym)}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...l[2]||(l[2]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))],8,Qe),C(V,{to:`/stations/${M.acronym}`,class:T(["flex-1 flex items-center gap-2 py-1.5 px-1 rounded hover:bg-base-200 text-sm",{"bg-primary/10 text-primary font-medium":Y(M.acronym)}])},{default:E(()=>[l[3]||(l[3]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),r("span",Xe,B(M.acronym),1),r("span",et,B(M.display_name),1)]),_:2},1032,["to","class"])]),m.value.has(M.acronym)?(_(),x("ul",tt,[v.value.has(M.id)?(_(),x("li",nt,[...l[4]||(l[4]=[r("span",{class:"loading loading-spinner loading-xs"},null,-1)])])):L("",!0),(_(!0),x(O,null,q(j(M.id),$=>(_(),x("li",{key:$.id,class:"mt-0.5"},[r("div",st,[r("button",{class:"btn btn-ghost btn-xs btn-square",onClick:se(D=>o($.id),["stop"])},[(_(),x("svg",{xmlns:"http://www.w3.org/2000/svg",class:T(["h-3 w-3 transition-transform",{"rotate-90":f.value.has($.id)}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...l[5]||(l[5]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))],8,at),C(V,{to:`/platforms/${$.id}`,class:T(["flex-1 flex items-center gap-2 py-1 px-1 rounded hover:bg-base-200 text-xs",{"bg-primary/10 text-primary font-medium":ue($.id)}])},{default:E(()=>[(_(),x("svg",rt,[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:de($.platform_type)},null,8,ot)])),r("span",lt,B($.normalized_name||$.display_name),1)]),_:2},1032,["to","class"])]),f.value.has($.id)?(_(),x("ul",it,[d.value.has($.id)?(_(),x("li",ut,[...l[6]||(l[6]=[r("span",{class:"loading loading-spinner loading-xs"},null,-1)])])):L("",!0),(_(!0),x(O,null,q(R($.id),D=>(_(),x("li",{key:D.id,class:"mt-0.5"},[C(V,{to:`/instruments/${D.id}`,class:T(["flex items-center gap-2 py-1 px-2 rounded hover:bg-base-200 text-xs",{"bg-primary/10 text-primary font-medium":ce(D.id)}])},{default:E(()=>[(_(),x("svg",ct,[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:me(D.instrument_type)},null,8,dt)])),r("span",mt,B(D.normalized_name||D.display_name),1)]),_:2},1032,["to","class"])]))),128)),!d.value.has($.id)&&R($.id).length===0?(_(),x("li",ft," No instruments ")):L("",!0)])):L("",!0)]))),128)),!v.value.has(M.id)&&j(M.id).length===0?(_(),x("li",vt," No platforms ")):L("",!0)])):L("",!0)]))),128))])),z(i).isAdmin?(_(),x("div",pt,[l[9]||(l[9]=r("h3",{class:"text-xs font-medium text-base-content/50 uppercase tracking-wide mb-2 px-1"},"Admin",-1)),r("ul",ht,[r("li",null,[C(V,{to:"/admin",class:"text-base-content/70 py-1.5"},{default:E(()=>[...l[7]||(l[7]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),H(" Dashboard ",-1)])]),_:1})]),r("li",null,[C(V,{to:"/admin/settings",class:"text-base-content/70 py-1.5"},{default:E(()=>[...l[8]||(l[8]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),H(" Users & Settings ",-1)])]),_:1})])])])):L("",!0)])])}}},F=A([]);let wt=0;const ae={success:"alert-success",error:"alert-error",warning:"alert-warning",info:"alert-info"};function _t(){function e(f,p="info",y=5e3){const v=++wt;return F.value.push({id:v,message:f,type:p,style:ae[p]||ae.info}),y>0&&setTimeout(()=>{i(v)},y),v}function a(f,p=5e3){return e(f,"success",p)}function n(f,p=8e3){return e(f,"error",p)}function t(f,p=6e3){return e(f,"warning",p)}function c(f,p=5e3){return e(f,"info",p)}function i(f){const p=F.value.findIndex(y=>y.id===f);p!==-1&&F.value.splice(p,1)}function m(){F.value=[]}return{notifications:F,notify:e,success:a,error:n,warning:t,info:c,remove:i,clearAll:m}}const le=(e,a)=>{const n=e.__vccOpts||e;for(const[t,c]of a)n[t]=c;return n},yt={class:"toast toast-top toast-end z-50"},bt={xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},xt=["d"],kt=["onClick"],St={__name:"NotificationToast",setup(e){const{notifications:a,remove:n}=_t();function t(c){const i={success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"};return i[c]||i.info}return(c,i)=>(_(),x("div",yt,[C(he,{name:"notification"},{default:E(()=>[(_(!0),x(O,null,q(z(a),m=>(_(),x("div",{key:m.id,class:T(["alert",m.style,"shadow-lg"])},[(_(),x("svg",bt,[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:t(m.type)},null,8,xt)])),r("span",null,B(m.message),1),r("button",{class:"btn btn-ghost btn-sm btn-circle",onClick:f=>z(n)(m.id),"aria-label":"Dismiss notification"},[...i[0]||(i[0]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,kt)],2))),128))]),_:1})]))}},At=le(St,[["__scopeId","data-v-a42a999f"]]),$t={class:"min-h-screen bg-base-200"},Pt={class:"flex"},It={class:"max-w-6xl mx-auto"},Mt={__name:"App",setup(e){const a=ee(),n=J(),t=S(()=>n.isAuthenticated&&a.name!=="login"),c=S(()=>a.name!=="login");return(i,m)=>{const f=te("router-view");return _(),x("div",$t,[C(At),c.value?(_(),Q(Re,{key:0})):L("",!0),r("div",Pt,[t.value?(_(),Q(gt,{key:0})):L("",!0),r("main",{class:T(["flex-1 p-4 lg:p-6",{"ml-64":t.value}])},[r("div",It,[C(f,null,{default:E(({Component:p})=>[C(ge,{name:"fade",mode:"out-in"},{default:E(()=>[(_(),Q(we(p)))]),_:2},1024)]),_:1})])],2)])])}}},Ct=le(Mt,[["__scopeId","data-v-f4f3d395"]]),Et="modulepreload",zt=function(e){return"/"+e},re={},N=function(a,n,t){let c=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),f=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));c=Promise.allSettled(n.map(p=>{if(p=zt(p),p in re)return;re[p]=!0;const y=p.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const d=document.createElement("link");if(d.rel=y?"stylesheet":Et,y||(d.as="script"),d.crossOrigin="",d.href=p,f&&d.setAttribute("nonce",f),document.head.appendChild(d),y)return new Promise((g,k)=>{d.addEventListener("load",g),d.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${p}`)))})}))}function i(m){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=m,window.dispatchEvent(f),!f.defaultPrevented)throw m}return c.then(m=>{for(const f of m||[])f.status==="rejected"&&i(f.reason);return a().catch(i)})},Vt=()=>N(()=>import("./LoginView-BYGaLZ6Z.js"),__vite__mapDeps([0,1])),Lt=()=>N(()=>import("./DashboardView-BYo5H3dc.js"),__vite__mapDeps([2,1,3,4,5])),Bt=()=>N(()=>import("./AdminDashboardView-BNkn9Yny.js"),__vite__mapDeps([6,1])),Tt=()=>N(()=>import("./AdminView-Hjqh_-kc.js"),__vite__mapDeps([7,1])),jt=()=>N(()=>import("./StationView-HLl63A5C.js"),__vite__mapDeps([8,3,1,9,10,4])),Ht=()=>N(()=>import("./PlatformView-BWYmUbRr.js"),__vite__mapDeps([11,1,9,3,10,12])),Nt=()=>N(()=>import("./InstrumentView-BULM1hKe.js"),__vite__mapDeps([13,1,9,3,12,14])),Dt=()=>N(()=>import("./NotFoundView-atMAHYoN.js"),__vite__mapDeps([15,1])),Rt=[{path:"/login",name:"login",component:Vt,meta:{requiresAuth:!1,title:"Login"}},{path:"/",name:"dashboard",component:Lt,meta:{requiresAuth:!0,title:"Dashboard"}},{path:"/admin",name:"admin",component:Bt,meta:{requiresAuth:!0,requiresAdmin:!0,title:"Admin Dashboard"}},{path:"/admin/settings",name:"admin-settings",component:Tt,meta:{requiresAuth:!0,requiresAdmin:!0,title:"Admin Settings"}},{path:"/stations/:acronym",name:"station",component:jt,props:!0,meta:{requiresAuth:!0,title:"Station"}},{path:"/platforms/:id",name:"platform",component:Ht,props:e=>({id:Number(e.params.id)}),meta:{requiresAuth:!0,title:"Platform"}},{path:"/instruments/:id",name:"instrument",component:Nt,props:e=>({id:Number(e.params.id)}),meta:{requiresAuth:!0,title:"Instrument"}},{path:"/:pathMatch(.*)*",name:"not-found",component:Dt,meta:{requiresAuth:!1,title:"Not Found"}}],ie=_e({history:ye(),routes:Rt,scrollBehavior(e,a,n){return n||{top:0}}});ie.beforeEach(async(e,a,n)=>{const t=J();if(document.title=e.meta.title?`${e.meta.title} | SITES Spectral`:"SITES Spectral",e.meta.requiresAuth&&!t.isAuthenticated){t.setRedirectPath(e.fullPath),n({name:"login"});return}if(e.meta.requiresAdmin&&!t.isAdmin){n({name:"dashboard"});return}if(e.name==="login"&&t.isAuthenticated){n({name:"dashboard"});return}n()});const K=be(Ct);K.use(xe());K.use(ie);K.config.errorHandler=(e,a,n)=>{console.error("Vue Error:",e),console.error("Component:",a),console.error("Info:",n)};K.mount("#app");export{X as A,le as _,oe as a,_t as b,P as c,Se as d,Fe as e,Oe as f,J as u};
