import{c as u,e as l,o as a,F as A,i as T,f as t,t as i,l as g,b as W,k as b,G,n as x,h as C,g as z,w as F,r as P,m as lt,E as ot,p as j,s as rt,a as it}from"./vendor-oiqY8oHn.js";import{a as Q,b as ut,f as mt,u as ct,g as dt,_ as J}from"./platforms-B4nEbBu-.js";import{u as vt,_ as ft}from"./instruments-DXCV3k3W.js";import{u as pt,b as gt}from"./index-CwZwIHTT.js";import{_ as bt,a as ht,b as yt,c as xt}from"./SatellitePlatformDetails-CT6RBenR.js";import{g as wt,a as kt}from"./BaseModal-C2sPkbo_.js";const _t={key:0,class:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-sm"},Ct={class:"text-xs text-base-content/50 block truncate"},Mt=["title"],$t={key:1,class:"text-xs text-base-content/50 italic"},Vt={__name:"InstrumentTypeDetails",props:{instrument:{type:Object,required:!0},showAllFields:{type:Boolean,default:!1}},setup(n){const v=n,w=u(()=>Q(v.instrument.instrument_type)),c=u(()=>{if(v.instrument.specifications&&typeof v.instrument.specifications=="object")return v.instrument.specifications;if(typeof v.instrument.specifications=="string")try{return JSON.parse(v.instrument.specifications)}catch{return{}}return v.instrument}),o=u(()=>{var k;if(!((k=w.value)!=null&&k.fields))return[];const e=w.value.fields,D=ut(v.instrument.instrument_type);return(v.showAllFields?Object.keys(e):D).map(_=>{const d=e[_];if(!d)return null;const r=c.value[_]??v.instrument[_];return{key:_,label:d.label,value:r,config:d,hasValue:r!=null&&r!==""}}).filter(_=>_!==null)}),S=u(()=>o.value.filter(e=>e.hasValue)),f=u(()=>S.value.length>0);return(e,D)=>f.value?(a(),l("div",_t,[(a(!0),l(A,null,T(S.value,h=>(a(),l("div",{key:h.key,class:"min-w-0"},[t("span",Ct,i(h.label),1),t("span",{class:"font-medium block truncate",title:String(h.value)},i(g(mt)(h.value,h.config)),9,Mt)]))),128))])):(a(),l("div",$t," No specifications recorded "))}},It={class:"flex items-start justify-between gap-2"},St={class:"flex items-center gap-2 min-w-0 flex-1"},Dt=["title"],Pt=["d"],zt={class:"min-w-0 flex-1"},Bt={class:"text-xs text-base-content/50 font-mono truncate block"},jt={class:"flex items-center flex-wrap gap-x-3 gap-y-1 mt-2 text-xs"},At={key:0,class:"text-base-content/50 ml-1"},Tt={key:0,class:"text-accent"},Ft={key:0,class:"mt-3 pt-2 border-t border-base-200"},Et={key:1,class:"mt-2"},Ht={key:2,class:"flex justify-end gap-1 mt-2 pt-2 border-t border-base-200"},Lt={key:3,class:"flex justify-end mt-2 pt-2 border-t border-base-200"},Nt={__name:"InstrumentCard",props:{instrument:{type:Object,required:!0},canEdit:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},showPlatform:{type:Boolean,default:!1},showAllSpecs:{type:Boolean,default:!1}},emits:["edit","delete","view"],setup(n,{emit:v}){const w=n,c=v,o=u(()=>Q(w.instrument.instrument_type)),S=u(()=>wt(w.instrument.status)),f=u(()=>kt(w.instrument.measurement_status)),e=u(()=>{var d;return w.instrument.roi_count||((d=w.instrument.rois)==null?void 0:d.length)||0});u(()=>{var d;return((d=o.value)==null?void 0:d.color)||"#6b7280"});const D=u(()=>o.value&&{phenocam:"bg-blue-500/10",multispectral:"bg-purple-500/10",par_sensor:"bg-amber-500/10",ndvi_sensor:"bg-green-500/10",pri_sensor:"bg-cyan-500/10",hyperspectral:"bg-pink-500/10",thermal:"bg-red-500/10",lidar:"bg-teal-500/10",radar:"bg-indigo-500/10"}[o.value.key]||"bg-gray-500/10"),h=u(()=>o.value&&{phenocam:"text-blue-500",multispectral:"text-purple-500",par_sensor:"text-amber-500",ndvi_sensor:"text-green-500",pri_sensor:"text-cyan-500",hyperspectral:"text-pink-500",thermal:"text-red-500",lidar:"text-teal-500",radar:"text-indigo-500"}[o.value.key]||"text-gray-500"),k={camera:["M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z","M15 13a3 3 0 11-6 0 3 3 0 016 0z"],"layer-group":["M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"],sun:["M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"],leaf:["M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"],microscope:["M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],rainbow:["M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],"temperature-high":["M9 19c-4.3 1.4-6-2.7-6-7 0-4.3 1.7-8.4 6-7m0 14V5m0 14a5 5 0 005-5 5 5 0 00-5-5"],"wave-square":["M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"],"satellite-dish":["M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.14 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"],cube:["M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"]},_=u(()=>{var r;const d=((r=o.value)==null?void 0:r.icon)||"cube";return k[d]||k.cube});return(d,r)=>{var V,I,M;const $=W("router-link");return a(),l("div",{class:x(["card bg-base-100 shadow-sm border border-base-200 hover:border-primary/30 transition-colors",{"card-compact":n.compact}])},[t("div",{class:x(["card-body",n.compact?"p-2":"p-3"])},[t("div",It,[t("div",St,[t("div",{class:x(["flex-shrink-0 rounded flex items-center justify-center",D.value]),style:G({width:n.compact?"28px":"32px",height:n.compact?"28px":"32px"}),title:((V=o.value)==null?void 0:V.name)||n.instrument.instrument_type},[(a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",class:x([h.value]),style:G({width:n.compact?"14px":"16px",height:n.compact?"14px":"16px"}),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(a(!0),l(A,null,T(_.value,(p,B)=>(a(),l("path",{key:B,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:p},null,8,Pt))),128))],6))],14,Dt),t("div",zt,[t("h5",{class:x(["font-medium truncate",n.compact?"text-xs":"text-sm"])},i(n.instrument.display_name),3),t("code",Bt,i(n.instrument.normalized_name),1)])]),t("span",{class:x(["badge",n.compact?"badge-xs":"badge-sm",S.value.badgeClass])},i(n.instrument.status),3)]),t("div",jt,[t("span",{class:x(["font-medium",h.value])},[C(i(((I=o.value)==null?void 0:I.name)||n.instrument.instrument_type)+" ",1),(M=o.value)!=null&&M.code?(a(),l("span",At," ("+i(o.value.code)+") ",1)):b("",!0)],2),t("span",{class:x([f.value.textClass,"flex items-center gap-1"])},[t("span",{class:x(["w-1.5 h-1.5 rounded-full",f.value.dotClass])},null,2),C(" "+i(n.instrument.measurement_status||"Unknown"),1)],2),e.value>0?(a(),l("span",Tt,i(e.value)+" ROI"+i(e.value!==1?"s":""),1)):b("",!0)]),n.compact?b("",!0):(a(),l("div",Ft,[z(Vt,{instrument:n.instrument,"show-all-fields":n.showAllSpecs},null,8,["instrument","show-all-fields"])])),n.showPlatform&&n.instrument.platform_name?(a(),l("div",Et,[z($,{to:`/platforms/${n.instrument.platform_id}`,class:"text-xs text-primary hover:underline"},{default:F(()=>[C(i(n.instrument.platform_name),1)]),_:1},8,["to"])])):b("",!0),n.canEdit?(a(),l("div",Ht,[t("button",{onClick:r[0]||(r[0]=p=>c("view",n.instrument)),class:"btn btn-ghost btn-xs"}," View "),t("button",{onClick:r[1]||(r[1]=p=>c("edit",n.instrument)),class:"btn btn-ghost btn-xs text-primary"}," Edit "),t("button",{onClick:r[2]||(r[2]=p=>c("delete",n.instrument)),class:"btn btn-ghost btn-xs text-error"}," Delete ")])):n.compact?b("",!0):(a(),l("div",Lt,[t("button",{onClick:r[3]||(r[3]=p=>c("view",n.instrument)),class:"btn btn-ghost btn-xs text-primary"},[...r[4]||(r[4]=[C(" View Details ",-1),t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])]))],2)],2)}}},Ot={key:0,class:"flex justify-center py-12"},Ut={key:1,class:"alert alert-error"},qt={key:2},Rt={class:"text-sm breadcrumbs mb-4"},Gt={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},Jt={class:"flex items-start justify-between"},Wt={class:"flex items-center gap-3"},Qt={class:"text-2xl font-bold"},Xt={class:"text-sm text-base-content/60 font-mono mt-1 block"},Yt={key:0,class:"text-base-content/60 mt-2"},Zt={key:0,class:"flex gap-2"},Kt={class:"mt-6 pt-4 border-t border-base-200"},te={class:"bg-base-100 rounded-lg shadow-lg p-6"},ee={class:"flex items-center justify-between mb-4"},se={class:"text-xl font-semibold"},ne={class:"badge badge-lg ml-2"},ae={key:0,class:"space-y-6"},le={class:"text-lg font-medium mb-3 flex items-center gap-2"},oe={class:"badge badge-secondary"},re={class:"text-base-content/60 text-sm font-normal"},ie={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ue={key:1,class:"text-center py-8"},ge={__name:"PlatformView",props:{id:{type:[Number,String],required:!0}},setup(n){const v=n,w=it(),c=ct(),o=vt(),S=pt(),f=gt(),e=u(()=>c.currentPlatform),D=u(()=>e.value?dt(e.value.platform_type):null),h=u(()=>{var m;switch((m=e.value)==null?void 0:m.platform_type){case"uav":return yt;case"satellite":return ht;case"fixed":default:return bt}}),k=u(()=>e.value?S.canEditStation(e.value.station_id):!1),_=u(()=>o.instrumentsByType),d=u(()=>c.loading||o.loading),r=P(!1),$=P(!1),V=P(!1),I=P(!1),M=P(null),p=P(null);async function B(){const m=parseInt(v.id);await c.fetchPlatform(m)&&await o.fetchInstrumentsByPlatform(m)}lt(B),ot(()=>v.id,B);function X(){r.value=!0}function Y(){V.value=!0}async function Z(m){await c.updatePlatform(e.value.id,m)?(f.success("Platform updated successfully"),r.value=!1):f.error(c.error||"Failed to update platform")}async function K(){const m=e.value.station_acronym;await c.deletePlatform(e.value.id)?(f.success("Platform deleted successfully"),V.value=!1,w.push({name:"station",params:{acronym:m}})):f.error(c.error||"Failed to delete platform")}function E(){M.value=null,$.value=!0}function tt(m){M.value=m,$.value=!0}function et(m){p.value=m,I.value=!0}async function st(m){let s;M.value?(s=await o.updateInstrument(M.value.id,m),s&&f.success("Instrument updated successfully")):(s=await o.createInstrument(m),s&&f.success("Instrument created successfully")),s?($.value=!1,M.value=null):f.error(o.error||"Failed to save instrument")}async function nt(){if(!p.value)return;await o.deleteInstrument(p.value.id)?(f.success("Instrument deleted successfully"),I.value=!1,p.value=null):f.error(o.error||"Failed to delete instrument")}const at=u(()=>{var s;return{fixed:"badge-info",uav:"badge-warning",satellite:"badge-accent"}[(s=e.value)==null?void 0:s.platform_type]||"badge-info"});return(m,s)=>{var L,N,O,U;const H=W("router-link");return a(),l("div",null,[d.value&&!e.value?(a(),l("div",Ot,[...s[4]||(s[4]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):g(c).error?(a(),l("div",Ut,[s[5]||(s[5]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,i(g(c).error),1)])):e.value?(a(),l("div",qt,[t("div",Rt,[t("ul",null,[t("li",null,[z(H,{to:"/dashboard"},{default:F(()=>[...s[6]||(s[6]=[C("Dashboard",-1)])]),_:1})]),t("li",null,[z(H,{to:`/stations/${e.value.station_acronym}`},{default:F(()=>[C(i(e.value.station_acronym),1)]),_:1},8,["to"])]),t("li",null,i(e.value.normalized_name),1)])]),t("div",Gt,[t("div",Jt,[t("div",null,[t("div",Wt,[t("h1",Qt,i(e.value.display_name||e.value.normalized_name),1),t("span",{class:x(["badge badge-lg",at.value])},i(((L=D.value)==null?void 0:L.name)||e.value.platform_type),3),t("span",{class:x([e.value.status==="Active"?"badge-success":"badge-warning","badge"])},i(e.value.status),3)]),t("code",Xt,i(e.value.normalized_name),1),e.value.description?(a(),l("p",Yt,i(e.value.description),1)):b("",!0)]),k.value?(a(),l("div",Zt,[t("button",{class:"btn btn-outline btn-sm",onClick:X},[...s[7]||(s[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),C(" Edit ",-1)])]),t("button",{class:"btn btn-outline btn-error btn-sm",onClick:Y},[...s[8]||(s[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),C(" Delete ",-1)])])])):b("",!0)]),t("div",Kt,[(a(),j(rt(h.value),{platform:e.value},null,8,["platform"]))])]),t("div",te,[t("div",ee,[t("h2",se,[s[9]||(s[9]=C(" Instruments ",-1)),t("span",ne,i(g(o).instrumentCount),1)]),k.value?(a(),l("button",{key:0,class:"btn btn-primary btn-sm",onClick:E},[...s[10]||(s[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),C(" Add Instrument ",-1)])])):b("",!0)]),g(o).instrumentCount>0?(a(),l("div",ae,[(a(!0),l(A,null,T(_.value,(y,q)=>(a(),l("div",{key:q},[t("h3",le,[t("span",oe,i(q),1),t("span",re,i(y.length)+" instrument"+i(y.length!==1?"s":""),1)]),t("div",ie,[(a(!0),l(A,null,T(y,R=>(a(),j(Nt,{key:R.id,instrument:R,"can-edit":k.value,onEdit:tt,onDelete:et},null,8,["instrument","can-edit"]))),128))])]))),128))])):(a(),l("div",ue,[s[11]||(s[11]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-base-content/30",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1)),s[12]||(s[12]=t("p",{class:"mt-4 text-base-content/60"},"No instruments found",-1)),k.value?(a(),l("button",{key:0,class:"btn btn-primary mt-4",onClick:E}," Add First Instrument ")):b("",!0)]))])])):b("",!0),e.value?(a(),j(g(xt),{key:3,modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=y=>r.value=y),platform:e.value,"station-id":e.value.station_id,"station-acronym":e.value.station_acronym,onSubmit:Z},null,8,["modelValue","platform","station-id","station-acronym"])):b("",!0),z(g(J),{modelValue:V.value,"onUpdate:modelValue":s[1]||(s[1]=y=>V.value=y),title:"Delete Platform",message:`Are you sure you want to delete '${(N=e.value)==null?void 0:N.normalized_name}'? This will also delete all ${g(o).instrumentCount} instrument(s). This action cannot be undone.`,"confirm-text":"Delete Platform",variant:"error",loading:g(c).loading,onConfirm:K},null,8,["modelValue","message","loading"]),e.value?(a(),j(g(ft),{key:4,modelValue:$.value,"onUpdate:modelValue":s[2]||(s[2]=y=>$.value=y),instrument:M.value,"platform-id":e.value.id,"platform-name":e.value.normalized_name,"platform-type":e.value.platform_type,onSubmit:st},null,8,["modelValue","instrument","platform-id","platform-name","platform-type"])):b("",!0),z(g(J),{modelValue:I.value,"onUpdate:modelValue":s[3]||(s[3]=y=>I.value=y),title:"Delete Instrument",message:`Are you sure you want to delete '${((O=p.value)==null?void 0:O.normalized_name)||((U=p.value)==null?void 0:U.display_name)}'? This action cannot be undone.`,"confirm-text":"Delete",variant:"error",loading:g(o).loading,onConfirm:nt},null,8,["modelValue","message","loading"])])}}};export{ge as default};
