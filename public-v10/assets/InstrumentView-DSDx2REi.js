import{d as Se,r as M,c as O,m as Ie,M as $e,D as De,E as ie,e as y,o as m,f as e,G as me,k as L,n as K,t as D,h as te,F as ye,i as _e,p as we,N as Me,l as Y,w as he,g as ge,A as Le,B as fe,C as be,b as Ee,H as Ve,a as Pe}from"./vendor-oiqY8oHn.js";import{u as Ae,_ as Be}from"./instruments-BWtGho0E.js";import{u as Te,a as je,e as Ne,_ as Ce,f as ze}from"./platforms-B8RC1nK3.js";import{c as de,_ as Oe,u as Ue,b as Fe}from"./index-BP56eZvN.js";import{_ as Ye,g as Xe,a as He}from"./BaseModal-BSvtwcmN.js";const Ge=Se("rois",()=>{const g=M([]),j=M(null),h=M(!1),i=M(null),w=M(!0),t=O(()=>g.value.length),P=O(()=>g.value.filter(n=>!n.is_legacy)),d=O(()=>g.value.filter(n=>n.is_legacy)),c=O(()=>P.value.length),E=O(()=>d.value.length),f=O(()=>{const n={};return g.value.forEach(v=>{const I=v.instrument_id;n[I]||(n[I]=[]),n[I].push(v)}),n});function k(n){if(!n)return n;if(n.points_json&&typeof n.points_json=="string")try{n.points=JSON.parse(n.points_json)}catch{n.points=[]}else n.points_json&&Array.isArray(n.points_json)?n.points=n.points_json:n.points||(n.points=[]);return n}async function z(n,v=!0){var I,C;h.value=!0,i.value=null;try{const S={instrument:n};v&&(S.include_legacy="true");const A=await de.get("/rois",S);A.rois?g.value=A.rois.map(k):(I=A.data)!=null&&I.rois?g.value=A.data.rois.map(k):A.success?g.value=(((C=A.data)==null?void 0:C.rois)||[]).map(k):i.value=A.error||"Failed to fetch ROIs"}catch(S){i.value=S.message}finally{h.value=!1}}async function F(n){var v,I;h.value=!0,i.value=null;try{const C=await de.get("/rois",{station:n});C.rois?g.value=C.rois.map(k):(v=C.data)!=null&&v.rois?g.value=C.data.rois.map(k):C.success?g.value=(((I=C.data)==null?void 0:I.rois)||[]).map(k):i.value=C.error||"Failed to fetch ROIs"}catch(C){i.value=C.message}finally{h.value=!1}}async function J(n){h.value=!0,i.value=null;try{const v=await de.get(`/rois/${n}`),I=v.id?v:v.data||(v.success?v.data:null);return I?(j.value=k(I),j.value):(i.value=v.error||"ROI not found",null)}catch(v){return i.value=v.message,null}finally{h.value=!1}}async function Q(n){h.value=!0,i.value=null;try{const v={...n};v.points&&Array.isArray(v.points)&&(v.points_json=JSON.stringify(v.points),delete v.points);const I=await de.post("/rois",v),C=I.id?I:I.data||(I.success?I.data:null);return C?(n.instrument_id&&await z(n.instrument_id),C):(i.value=I.error||"Failed to create ROI",null)}catch(v){return i.value=v.message,null}finally{h.value=!1}}async function V(n,v){var I;h.value=!0,i.value=null;try{const C={...v};C.points&&Array.isArray(C.points)&&(C.points_json=JSON.stringify(C.points),delete C.points);const S=await de.put(`/rois/${n}`,C),A=S.id?S:S.data||(S.success?S.data:null);if(A||S.success){const H=g.value.findIndex(le=>le.id===n);return H!==-1&&(g.value[H]=k({...g.value[H],...v})),((I=j.value)==null?void 0:I.id)===n&&(j.value=k({...j.value,...v})),A||S.data}else return i.value=S.error||"Failed to update ROI",null}catch(C){return i.value=C.message,null}finally{h.value=!1}}async function x(n){var v;h.value=!0,i.value=null;try{const I=await de.delete(`/rois/${n}`);return I.deleted||I.success?(g.value=g.value.filter(C=>C.id!==n),((v=j.value)==null?void 0:v.id)===n&&(j.value=null),!0):(i.value=I.error||"Failed to delete ROI",!1)}catch(I){return i.value=I.message,!1}finally{h.value=!1}}function U(){j.value=null}function W(){g.value=[],j.value=null}async function N(n){try{const v=await de.get(`/rois/${n}/edit-mode`),I=v.can_direct_edit!==void 0?v:v.data||(v.success?v.data:null);return I||(i.value=v.error||"Failed to get edit mode",null)}catch(v){return i.value=v.message,null}}async function X(n,v,I="Replaced by new ROI"){var C;h.value=!0,i.value=null;try{const S=await de.post(`/rois/${n}/legacy`,{reason:I,replacement_data:v}),A=S.legacy_roi||S.new_roi?S:S.data||(S.success?S.data:null);if(A){const H=(C=g.value.find(le=>le.id===n))==null?void 0:C.instrument_id;return H&&await z(H),A}return i.value=S.error||"Failed to mark ROI as legacy",null}catch(S){return i.value=S.message,null}finally{h.value=!1}}async function _(n,v){var I;h.value=!0,i.value=null;try{const C={...v};C.points&&Array.isArray(C.points)&&(C.points_json=JSON.stringify(C.points),delete C.points);const S=await de.put(`/rois/${n}/override`,C),A=S.id?S:S.data||(S.success?S.data:null);if(A||S.success){const H=g.value.findIndex(le=>le.id===n);return H!==-1&&(g.value[H]={...g.value[H],...v,timeseries_broken:!0}),((I=j.value)==null?void 0:I.id)===n&&(j.value={...j.value,...v,timeseries_broken:!0}),A||S.data}return i.value=S.error||"Failed to update ROI",null}catch(C){return i.value=C.message,null}finally{h.value=!1}}function p(n){w.value=n}return{rois:g,currentROI:j,loading:h,error:i,includeLegacy:w,roiCount:t,roisByInstrument:f,activeRois:P,legacyRois:d,activeRoiCount:c,legacyRoiCount:E,fetchROIsByInstrument:z,fetchROIsByStation:F,fetchROI:J,createROI:Q,updateROI:V,deleteROI:x,clearCurrentROI:U,clearROIs:W,getROIEditMode:N,markAsLegacyAndReplace:X,adminOverrideUpdate:_,setIncludeLegacy:p}}),We={class:"absolute top-2 right-2 flex gap-1"},qe=["title"],Je={class:"text-xs"},Ke={class:"absolute bottom-2 left-2 flex gap-1"},Qe={class:"badge badge-neutral"},Ze={key:0,class:"badge badge-warning badge-outline"},et={__name:"ROIViewer",props:{imageUrl:{type:String,default:""},rois:{type:Array,default:()=>[]},selectedRoiId:{type:[Number,String],default:null},showLabels:{type:Boolean,default:!0},height:{type:[Number,String],default:400},showLegacyToggle:{type:Boolean,default:!0},initialShowLegacy:{type:Boolean,default:!1}},emits:["roi-click","roi-hover","toggle-legacy"],setup(g,{expose:j,emit:h}){const i=g,w=h,t=M(null),P=M(null),d=M(!1),c=M(!1),E=M(null),f=M(i.initialShowLegacy),k=O(()=>i.rois.some(a=>a.is_legacy)),z=O(()=>f.value?i.rois:i.rois.filter(a=>!a.is_legacy)),F=O(()=>i.rois.filter(a=>a.is_legacy).length),J=O(()=>i.rois.filter(a=>!a.is_legacy).length);function Q(){f.value=!f.value,w("toggle-legacy",f.value),A()}let V=null;const x=M(1),U=M(0),W=M(0);let N=!1,X=0,_=0;const p=O(()=>typeof i.height=="number"?i.height:parseInt(i.height)||400);function n(a,r=1){const R=a.color_r??255,o=a.color_g??0,l=a.color_b??0;return`rgba(${R}, ${o}, ${l}, ${r})`}function v(a,r){return{x:a*x.value+U.value,y:r*x.value+W.value}}function I(a,r){return{x:(a-U.value)/x.value,y:(r-W.value)/x.value}}function C(a,r,R){if(!R||R.length<3)return!1;let o=!1;for(let l=0,u=R.length-1;l<R.length;u=l++){const s=R[l].x,b=R[l].y,$=R[u].x,B=R[u].y;b>r!=B>r&&a<($-s)*(r-b)/(B-b)+s&&(o=!o)}return o}function S(a,r){const R=I(a,r);for(const o of z.value)if(o.points&&C(R.x,R.y,o.points))return o;return null}function A(){const a=P.value;if(!a)return;const r=a.getContext("2d"),R=a.width,o=a.height;r.clearRect(0,0,R,o),r.fillStyle="#1a1a2e",r.fillRect(0,0,R,o),V&&d.value?(r.save(),r.translate(U.value,W.value),r.scale(x.value,x.value),r.drawImage(V,0,0),r.restore()):i.imageUrl?c.value?(r.fillStyle="#ff6b6b",r.font="16px sans-serif",r.textAlign="center",r.fillText("Failed to load image",R/2,o/2)):(r.fillStyle="#888",r.font="16px sans-serif",r.textAlign="center",r.fillText("Loading image...",R/2,o/2)):(r.fillStyle="#4a4a6a",r.font="16px sans-serif",r.textAlign="center",r.fillText("No image available",R/2,o/2)),z.value.forEach(l=>{if(!l.points||l.points.length<3)return;const u=l.id===i.selectedRoiId,s=l.id===E.value,b=l.is_legacy,$=l.alpha??.3,B=b?$*.5:$;r.beginPath();const T=v(l.points[0].x,l.points[0].y);r.moveTo(T.x,T.y);for(let ee=1;ee<l.points.length;ee++){const se=v(l.points[ee].x,l.points[ee].y);r.lineTo(se.x,se.y)}r.closePath();const Z=u?B+.2:s?B+.1:B;r.fillStyle=n(l,Z),r.fill(),r.lineWidth=u?3:s?2:l.thickness??2;const ne=b?.6:1;if(r.strokeStyle=n(l,ne),b&&r.setLineDash([4,4]),r.stroke(),r.setLineDash([]),i.showLabels&&l.roi_name){let ee=0,se=0;l.points.forEach(Re=>{ee+=Re.x,se+=Re.y}),ee/=l.points.length,se/=l.points.length;const oe=v(ee,se);r.font=b?"11px sans-serif":"bold 12px sans-serif";const xe=b?`${l.roi_name} (legacy)`:l.roi_name,G=r.measureText(xe),ke=4;r.fillStyle=b?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.7)",r.fillRect(oe.x-G.width/2-ke,oe.y-8-ke,G.width+ke*2,16+ke),r.fillStyle=b?"rgba(255, 255, 255, 0.7)":"#fff",r.textAlign="center",r.textBaseline="middle",r.fillText(xe,oe.x,oe.y)}})}function H(){if(!V||!P.value)return;const a=P.value,r=a.width/V.width,R=a.height/V.height;x.value=Math.min(r,R)*.95,U.value=(a.width-V.width*x.value)/2,W.value=(a.height-V.height*x.value)/2,A()}function le(a){a.preventDefault();const R=P.value.getBoundingClientRect(),o=a.clientX-R.left,l=a.clientY-R.top,u=a.deltaY>0?.9:1.1,s=Math.max(.1,Math.min(5,x.value*u)),b=I(o,l);x.value=s,U.value=o-b.x*s,W.value=l-b.y*s,A()}function pe(a){N=!0,X=a.clientX,_=a.clientY}function ve(a){const r=P.value,R=r.getBoundingClientRect(),o=a.clientX-R.left,l=a.clientY-R.top;if(N){const u=a.clientX-X,s=a.clientY-_;U.value+=u,W.value+=s,X=a.clientX,_=a.clientY,A()}else{const u=S(o,l),s=(u==null?void 0:u.id)||null;s!==E.value&&(E.value=s,w("roi-hover",u),A()),r.style.cursor=u?"pointer":N?"grabbing":"grab"}}function re(){N=!1}function ue(a){const R=P.value.getBoundingClientRect(),o=a.clientX-R.left,l=a.clientY-R.top,u=S(o,l);u&&w("roi-click",u)}function ae(){const a=P.value,r=t.value;!a||!r||(a.width=r.clientWidth,a.height=p.value,d.value?H():A())}function ce(){if(!i.imageUrl){d.value=!1,c.value=!1,A();return}V=new Image,V.crossOrigin="anonymous",V.onload=()=>{d.value=!0,c.value=!1,H()},V.onerror=()=>{d.value=!1,c.value=!0,A()},V.src=i.imageUrl}return Ie(()=>{$e(()=>{ae(),ce()}),window.addEventListener("resize",ae),window.addEventListener("mouseup",re)}),De(()=>{window.removeEventListener("resize",ae),window.removeEventListener("mouseup",re)}),ie(()=>i.imageUrl,ce),ie(()=>i.rois,A,{deep:!0}),ie(()=>i.selectedRoiId,A),ie(()=>i.showLabels,A),j({fitToCanvas:H,draw:A}),(a,r)=>(m(),y("div",{ref_key:"containerRef",ref:t,class:"roi-viewer-container relative w-full bg-base-300 rounded-lg overflow-hidden"},[e("canvas",{ref_key:"canvasRef",ref:P,style:me({height:`${p.value}px`}),class:"w-full cursor-grab",onWheel:le,onMousedown:pe,onMousemove:ve,onClick:ue},null,36),e("div",We,[g.showLegacyToggle&&k.value?(m(),y("button",{key:0,class:K(["btn btn-sm btn-ghost bg-base-100/80 hover:bg-base-100 gap-1",{"btn-active":f.value}]),title:f.value?"Hide legacy ROIs":"Show legacy ROIs",onClick:Q},[r[0]||(r[0]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Je,D(F.value),1)],10,qe)):L("",!0),e("button",{class:"btn btn-sm btn-square btn-ghost bg-base-100/80 hover:bg-base-100",title:"Fit to view",onClick:H},[...r[1]||(r[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)])])]),e("div",Ke,[e("div",Qe,D(J.value)+" active ",1),f.value&&F.value>0?(m(),y("div",Ze,D(F.value)+" legacy ",1)):L("",!0)])],512))}},tt=Oe(et,[["__scopeId","data-v-e5a4ad9c"]]),lt={class:"flex-1 min-w-0"},nt={class:"flex items-center gap-2"},st={key:0,class:"badge badge-xs badge-warning gap-1"},at={key:1,class:"badge badge-xs badge-error gap-1",title:"Time series data may be inconsistent"},ot={key:0,class:"text-xs text-base-content/60"},it={key:0,class:"badge badge-xs badge-ghost ml-1"},rt={key:1,class:"ml-1"},ut={key:0,class:"flex gap-1 flex-shrink-0"},ct={key:1,class:"flex-shrink-0"},dt={__name:"ROICard",props:{roi:{type:Object,required:!0},selected:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},isLegacy:{type:Boolean,default:!1}},emits:["select","edit","delete"],setup(g,{emit:j}){const h=g,i=j,w=O(()=>{const f=h.roi.color_r??255,k=h.roi.color_g??0,z=h.roi.color_b??0,F=h.isLegacy?.5:1;return{backgroundColor:`rgba(${f}, ${k}, ${z}, ${F})`}}),t=O(()=>{const f="roi-card flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all border";return h.isLegacy?[f,"border-base-300 opacity-60",h.selected?"bg-base-200 border-base-content/30":"bg-base-100/50 hover:bg-base-200/50"]:[f,"border-base-300 hover:border-primary/50",h.selected?"bg-primary/10 border-primary":"bg-base-100 hover:bg-base-200"]}),P=O(()=>{const f=h.roi.points||h.roi.points_json;if(Array.isArray(f))return f.length;if(typeof f=="string")try{return JSON.parse(f).length}catch{return 0}return 0});function d(){i("select",h.roi)}function c(f){f.stopPropagation(),i("edit",h.roi)}function E(f){f.stopPropagation(),i("delete",h.roi)}return(f,k)=>(m(),y("div",{class:K(t.value),onClick:d},[e("div",{class:"w-4 h-4 rounded flex-shrink-0 border border-base-300",style:me(w.value)},null,4),e("div",lt,[e("div",nt,[e("span",{class:K(["font-medium truncate",{"line-through":g.isLegacy}])},D(g.roi.roi_name),3),g.isLegacy?(m(),y("span",st,[...k[0]||(k[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),te(" Legacy ",-1)])])):L("",!0),g.roi.timeseries_broken?(m(),y("span",at,[...k[1]||(k[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)])])):L("",!0)]),g.compact?L("",!0):(m(),y("div",ot,[te(D(P.value)+" points ",1),g.roi.auto_generated?(m(),y("span",it,"auto")):L("",!0),g.isLegacy&&g.roi.legacy_date?(m(),y("span",rt," ("+D(new Date(g.roi.legacy_date).toLocaleDateString())+") ",1)):L("",!0)]))]),g.canEdit&&!g.isLegacy?(m(),y("div",ut,[e("button",{class:"btn btn-ghost btn-xs btn-square",title:"Edit ROI",onClick:c},[...k[2]||(k[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),e("button",{class:"btn btn-ghost btn-xs btn-square text-error",title:"Delete ROI",onClick:E},[...k[3]||(k[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])):L("",!0),g.isLegacy?(m(),y("div",ct,[...k[4]||(k[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-base-content/40",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)])])):L("",!0)],2))}},vt={class:"roi-list"},gt={class:"flex items-center justify-between mb-3"},ft={class:"flex items-center gap-2"},mt={class:"badge badge-sm"},pt={key:0,class:"tabs tabs-boxed mb-3 bg-base-200"},bt={class:"badge badge-sm ml-1"},ht={class:"badge badge-sm badge-ghost ml-1"},yt={key:1,class:"flex justify-center py-8"},xt={key:2,class:"text-center py-8 text-base-content/60"},wt={key:0,class:"text-sm mt-1"},kt={key:4,class:"mt-3"},_t={__name:"ROIList",props:{rois:{type:Array,default:()=>[]},selectedId:{type:[Number,String],default:null},canEdit:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},maxHeight:{type:[Number,String],default:null},showLegacyTabs:{type:Boolean,default:!0}},emits:["select","edit","delete","create"],setup(g,{emit:j}){const h=g,i=j,w=M("active"),t=O(()=>h.rois.filter(V=>!V.is_legacy)),P=O(()=>h.rois.filter(V=>V.is_legacy)),d=O(()=>P.value.length>0),c=O(()=>h.showLegacyTabs&&d.value),E=O(()=>[...c.value?w.value==="legacy"?P.value:t.value:h.rois].sort((x,U)=>(x.roi_name||"").localeCompare(U.roi_name||"",void 0,{numeric:!0}))),f=O(()=>c.value?w.value==="legacy"?P.value.length:t.value.length:h.rois.length),k=O(()=>h.maxHeight?{maxHeight:typeof h.maxHeight=="number"?`${h.maxHeight}px`:h.maxHeight,overflowY:"auto"}:{});function z(V){i("select",V)}function F(V){i("edit",V)}function J(V){i("delete",V)}function Q(){i("create")}return(V,x)=>(m(),y("div",vt,[e("div",gt,[e("div",ft,[x[2]||(x[2]=e("span",{class:"font-medium"},"ROIs",-1)),e("span",mt,D(g.rois.length),1)]),g.canEdit&&w.value==="active"?(m(),y("button",{key:0,class:"btn btn-primary btn-sm",onClick:Q},[...x[3]||(x[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),te(" Add ROI ",-1)])])):L("",!0)]),c.value?(m(),y("div",pt,[e("button",{class:K(["tab",{"tab-active":w.value==="active"}]),onClick:x[0]||(x[0]=U=>w.value="active")},[x[4]||(x[4]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),x[5]||(x[5]=te(" Active ",-1)),e("span",bt,D(t.value.length),1)],2),e("button",{class:K(["tab",{"tab-active":w.value==="legacy"}]),onClick:x[1]||(x[1]=U=>w.value="legacy")},[x[6]||(x[6]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),x[7]||(x[7]=te(" Legacy ",-1)),e("span",ht,D(P.value.length),1)],2)])):L("",!0),g.loading?(m(),y("div",yt,[...x[8]||(x[8]=[e("span",{class:"loading loading-spinner loading-md"},null,-1)])])):f.value===0?(m(),y("div",xt,[x[12]||(x[12]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto mb-3 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),w.value==="legacy"?(m(),y(ye,{key:0},[x[9]||(x[9]=e("p",null,"No legacy ROIs",-1)),x[10]||(x[10]=e("p",{class:"text-sm mt-1"},"Legacy ROIs are preserved for historical data integrity",-1))],64)):(m(),y(ye,{key:1},[x[11]||(x[11]=e("p",null,"No ROIs defined",-1)),g.canEdit?(m(),y("p",wt,'Click "Add ROI" to create one')):L("",!0)],64))])):(m(),y("div",{key:3,class:"space-y-2",style:me(k.value)},[(m(!0),y(ye,null,_e(E.value,U=>(m(),we(dt,{key:U.id,roi:U,selected:U.id===g.selectedId,"can-edit":g.canEdit&&!U.is_legacy,compact:g.compact,"is-legacy":U.is_legacy,onSelect:z,onEdit:F,onDelete:J},null,8,["roi","selected","can-edit","compact","is-legacy"]))),128))],4)),c.value&&w.value==="legacy"&&P.value.length>0?(m(),y("div",kt,[...x[13]||(x[13]=[e("div",{class:"alert alert-info py-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"text-sm"}," Legacy ROIs are preserved for L2/L3 historical product consistency. They cannot be edited or deleted. ")],-1)])])):L("",!0)]))}},q={IDLE:"idle",DRAWING:"drawing",EDITING:"editing"};function It(g={}){const{minPoints:j=3,vertexRadius:h=8,snapDistance:i=10}=g,w=M(q.IDLE),t=M([]),P=M({x:0,y:0}),d=M(-1),c=M(-1),E=M(!1),f=Me({r:255,g:100,b:100}),k=M(2),z=M(.3),F=O(()=>t.value.length>=j),J=O(()=>w.value===q.DRAWING),Q=O(()=>w.value===q.EDITING),V=O(()=>w.value!==q.IDLE);function x(a,r){const R=r.x-a.x,o=r.y-a.y;return Math.sqrt(R*R+o*o)}function U(){w.value=q.DRAWING,t.value=[],d.value=-1,c.value=-1,E.value=!1}function W(a){return!a||a.length<j?(console.warn("Cannot edit polygon with fewer than",j,"points"),!1):(w.value=q.EDITING,t.value=a.map(r=>({x:r.x,y:r.y})),d.value=-1,c.value=-1,!0)}function N(a,r){w.value===q.DRAWING&&t.value.push({x:a,y:r})}function X(){t.value.length>0&&t.value.pop()}function _(){return F.value?(w.value=q.IDLE,!0):!1}function p(){w.value=q.IDLE,t.value=[],d.value=-1,c.value=-1,E.value=!1}function n(){return w.value!==q.EDITING||!F.value?null:(w.value=q.IDLE,[...t.value])}function v(a,r,R){for(let o=0;o<t.value.length;o++){const l=R(t.value[o].x,t.value[o].y);if(x({x:a,y:r},l)<=h)return o}return-1}function I(a,r,R,o,l){if(P.value={x:a,y:r},w.value===q.DRAWING&&t.value.length>0){const u=l(t.value[0].x,t.value[0].y);E.value=x({x:R,y:o},u)<=i}c.value>=0?t.value[c.value]={x:a,y:r}:w.value===q.EDITING&&(d.value=v(R,o,l))}function C(a,r){return w.value!==q.DRAWING?!1:E.value&&F.value?_():(N(a,r),!1)}function S(){return w.value!==q.DRAWING?!1:(t.value.length>j&&X(),_())}function A(a){w.value===q.EDITING&&(a<0||a>=t.value.length||(c.value=a))}function H(){c.value=-1}function le(a,r,R){a<0||a>=t.value.length||(t.value[a]={x:r,y:R})}function pe(a){return t.value.length<=j||a<0||a>=t.value.length?!1:(t.value.splice(a,1),d.value=-1,!0)}function ve(a,r,R){a<0||a>=t.value.length||t.value.splice(a+1,0,{x:r,y:R})}function re(a,r,R){f.r=Math.max(0,Math.min(255,a)),f.g=Math.max(0,Math.min(255,r)),f.b=Math.max(0,Math.min(255,R))}function ue(){return{points:[...t.value],color_r:f.r,color_g:f.g,color_b:f.b,thickness:k.value,alpha:z.value}}function ae(a){a.points&&Array.isArray(a.points)&&W(a.points),a.color_r!==void 0&&(f.r=a.color_r),a.color_g!==void 0&&(f.g=a.color_g),a.color_b!==void 0&&(f.b=a.color_b),a.thickness!==void 0&&(k.value=a.thickness),a.alpha!==void 0&&(z.value=a.alpha)}function ce(){w.value=q.IDLE,t.value=[],P.value={x:0,y:0},d.value=-1,c.value=-1,E.value=!1}return{DRAWING_MODES:q,vertexRadius:h,snapDistance:i,minPoints:j,mode:w,points:t,cursorPosition:P,hoveredVertexIndex:d,draggingVertexIndex:c,isNearFirstVertex:E,color:f,thickness:k,alpha:z,isValidPolygon:F,isDrawing:J,isEditing:Q,isActive:V,startDrawing:U,startEditing:W,addPoint:N,removeLastPoint:X,closePolygon:_,cancel:p,finishEditing:n,findVertexAtPosition:v,handleMouseMove:I,handleClick:C,handleDoubleClick:S,startDragVertex:A,stopDragVertex:H,moveVertex:le,deleteVertex:pe,insertVertex:ve,setColor:re,getPolygonData:ue,loadPolygonData:ae,reset:ce}}const Rt={key:1,class:"absolute bottom-2 left-2 badge badge-neutral"},Ct={key:2,class:"absolute bottom-2 right-2 flex gap-2"},$t=["disabled"],Dt={__name:"ROIDrawingCanvas",props:{imageUrl:{type:String,default:""},existingRois:{type:Array,default:()=>[]},editingRoi:{type:Object,default:null},disabled:{type:Boolean,default:!1},height:{type:[Number,String],default:400},defaultColor:{type:Object,default:()=>({r:255,g:100,b:100})}},emits:["points-change","drawing-complete","drawing-cancel","roi-click"],setup(g,{expose:j,emit:h}){const i=g,w=h,t=It(),P=M(null),d=M(null),c=M(!1),E=M(!1);let f=null;const k=M(1),z=M(0),F=M(0);let J=!1,Q=0,V=0;const x=O(()=>typeof i.height=="number"?i.height:parseInt(i.height)||400),U=O(()=>i.disabled?"not-allowed":t.isDrawing.value?"crosshair":t.draggingVertexIndex.value>=0?"grabbing":t.hoveredVertexIndex.value>=0?"grab":t.isEditing.value?"default":"crosshair");function W(o,l=1){const u=o.color_r??255,s=o.color_g??0,b=o.color_b??0;return`rgba(${u}, ${s}, ${b}, ${l})`}function N(o,l){return{x:o*k.value+z.value,y:l*k.value+F.value}}function X(o,l){return{x:(o-z.value)/k.value,y:(l-F.value)/k.value}}function _(o,l,u){if(!u||u.length<3)return!1;let s=!1;for(let b=0,$=u.length-1;b<u.length;$=b++){const B=u[b].x,T=u[b].y,Z=u[$].x,ne=u[$].y;T>l!=ne>l&&o<(Z-B)*(l-T)/(ne-T)+B&&(s=!s)}return s}function p(o,l){const u=X(o,l);for(const s of i.existingRois)if(s.points&&_(u.x,u.y,s.points))return s;return null}function n(){const o=d.value;if(!o)return;const l=o.getContext("2d"),u=o.width,s=o.height;l.clearRect(0,0,u,s),l.fillStyle="#1a1a2e",l.fillRect(0,0,u,s),f&&c.value?(l.save(),l.translate(z.value,F.value),l.scale(k.value,k.value),l.drawImage(f,0,0),l.restore()):i.imageUrl?E.value?(l.fillStyle="#ff6b6b",l.font="16px sans-serif",l.textAlign="center",l.fillText("Failed to load image",u/2,s/2)):(l.fillStyle="#888",l.font="16px sans-serif",l.textAlign="center",l.fillText("Loading image...",u/2,s/2)):(l.fillStyle="#4a4a6a",l.font="16px sans-serif",l.textAlign="center",l.fillText("No image available",u/2,s/2)),i.existingRois.forEach($=>{if(!$.points||$.points.length<3)return;l.beginPath();const B=N($.points[0].x,$.points[0].y);l.moveTo(B.x,B.y);for(let T=1;T<$.points.length;T++){const Z=N($.points[T].x,$.points[T].y);l.lineTo(Z.x,Z.y)}if(l.closePath(),l.fillStyle=W($,.15),l.fill(),l.lineWidth=$.thickness??2,l.strokeStyle=W($,.5),l.setLineDash([4,4]),l.stroke(),l.setLineDash([]),$.roi_name){const T=$.points;let Z=0,ne=0;T.forEach(se=>{Z+=se.x,ne+=se.y}),Z/=T.length,ne/=T.length;const ee=N(Z,ne);l.font="11px sans-serif",l.fillStyle="rgba(255, 255, 255, 0.6)",l.textAlign="center",l.textBaseline="middle",l.fillText($.roi_name,ee.x,ee.y)}});const b=t.points.value;if(b.length>0){l.beginPath();const $=N(b[0].x,b[0].y);l.moveTo($.x,$.y);for(let B=1;B<b.length;B++){const T=N(b[B].x,b[B].y);l.lineTo(T.x,T.y)}if(t.isEditing.value&&b.length>=3&&(l.closePath(),l.fillStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, ${t.alpha.value})`,l.fill()),l.lineWidth=t.thickness.value,l.strokeStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 1)`,l.stroke(),t.isDrawing.value&&b.length>0){const B=N(b[b.length-1].x,b[b.length-1].y),T=N(t.cursorPosition.value.x,t.cursorPosition.value.y);l.beginPath(),l.moveTo(B.x,B.y),l.lineTo(T.x,T.y),l.setLineDash([5,5]),l.stroke(),l.setLineDash([]),t.isNearFirstVertex.value&&(l.beginPath(),l.moveTo(T.x,T.y),l.lineTo($.x,$.y),l.strokeStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 0.5)`,l.setLineDash([3,3]),l.stroke(),l.setLineDash([]))}b.forEach((B,T)=>{const Z=N(B.x,B.y),ne=T===t.hoveredVertexIndex.value,ee=T===t.draggingVertexIndex.value,oe=T===0&&t.isDrawing.value&&t.isNearFirstVertex.value;l.beginPath(),l.arc(Z.x,Z.y,oe?t.vertexRadius*1.5:t.vertexRadius,0,Math.PI*2),ee||oe?l.fillStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 1)`:ne?l.fillStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 0.8)`:l.fillStyle="white",l.fill(),l.lineWidth=2,l.strokeStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 1)`,l.stroke()})}if(t.isDrawing.value){l.fillStyle="rgba(0, 0, 0, 0.7)",l.fillRect(10,s-30,300,20),l.font="12px sans-serif",l.fillStyle="white",l.textAlign="left";let $="Click to add points";b.length>=3&&(t.isNearFirstVertex.value?$="Click to close polygon":$="Double-click or click first point to close"),l.fillText($+" | Right-click: undo | Esc: cancel",15,s-16)}else t.isEditing.value&&(l.fillStyle="rgba(0, 0, 0, 0.7)",l.fillRect(10,s-30,250,20),l.font="12px sans-serif",l.fillStyle="white",l.textAlign="left",l.fillText("Drag vertices to edit | Esc: cancel",15,s-16))}function v(){if(!f||!d.value)return;const o=d.value,l=o.width/f.width,u=o.height/f.height;k.value=Math.min(l,u)*.95,z.value=(o.width-f.width*k.value)/2,F.value=(o.height-f.height*k.value)/2,n()}function I(o){o.preventDefault();const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top,$=o.deltaY>0?.9:1.1,B=Math.max(.1,Math.min(5,k.value*$)),T=X(s,b);k.value=B,z.value=s-T.x*B,F.value=b-T.y*B,n()}function C(o){if(i.disabled)return;const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top;if(t.isEditing.value&&o.button===0){const $=t.findVertexAtPosition(s,b,N);if($>=0){t.startDragVertex($);return}}(o.button===1||!t.isActive.value&&o.button===0)&&(J=!0,Q=o.clientX,V=o.clientY)}function S(o){const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top,$=X(s,b);if(J){const B=o.clientX-Q,T=o.clientY-V;z.value+=B,F.value+=T,Q=o.clientX,V=o.clientY,n()}else t.isActive.value&&(t.handleMouseMove($.x,$.y,s,b,N),n())}function A(){J=!1,t.draggingVertexIndex.value>=0&&(t.stopDragVertex(),w("points-change",[...t.points.value]))}function H(o){if(i.disabled||o.button!==0)return;const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top,$=X(s,b);if(!t.isActive.value){const B=p(s,b);if(B){w("roi-click",B);return}re()}t.isDrawing.value&&(t.handleClick($.x,$.y)?w("drawing-complete",t.getPolygonData()):w("points-change",[...t.points.value]),n())}function le(o){if(i.disabled||!t.isDrawing.value)return;o.preventDefault(),t.handleDoubleClick()&&w("drawing-complete",t.getPolygonData()),n()}function pe(o){o.preventDefault(),!i.disabled&&t.isDrawing.value&&(t.removeLastPoint(),w("points-change",[...t.points.value]),n())}function ve(o){o.key==="Escape"&&t.isActive.value&&ae()}function re(){t.startDrawing(),t.setColor(i.defaultColor.r,i.defaultColor.g,i.defaultColor.b),n()}function ue(o){t.loadPolygonData(o),n()}function ae(){t.cancel(),w("drawing-cancel"),n()}function ce(){if(!t.isValidPolygon.value)return null;const o=t.getPolygonData();return t.reset(),n(),o}function a(o,l,u){t.setColor(o,l,u),n()}function r(){const o=d.value,l=P.value;!o||!l||(o.width=l.clientWidth,o.height=x.value,c.value?v():n())}function R(){if(!i.imageUrl){c.value=!1,E.value=!1,n();return}f=new Image,f.crossOrigin="anonymous",f.onload=()=>{c.value=!0,E.value=!1,v()},f.onerror=()=>{c.value=!1,E.value=!0,n()},f.src=i.imageUrl}return Ie(()=>{$e(()=>{r(),R(),i.editingRoi&&ue(i.editingRoi)}),window.addEventListener("resize",r),window.addEventListener("mouseup",A),window.addEventListener("keydown",ve)}),De(()=>{window.removeEventListener("resize",r),window.removeEventListener("mouseup",A),window.removeEventListener("keydown",ve)}),ie(()=>i.imageUrl,R),ie(()=>i.existingRois,n,{deep:!0}),ie(()=>i.editingRoi,o=>{o&&ue(o)},{deep:!0}),j({fitToCanvas:v,draw:n,startDrawing:re,startEditing:ue,cancelDrawing:ae,confirmEditing:ce,setColor:a,isDrawing:t.isDrawing,isEditing:t.isEditing,isActive:t.isActive,isValidPolygon:t.isValidPolygon,points:t.points}),(o,l)=>(m(),y("div",{ref_key:"containerRef",ref:P,class:"roi-drawing-container relative w-full bg-base-300 rounded-lg overflow-hidden"},[e("canvas",{ref_key:"canvasRef",ref:d,style:me({height:`${x.value}px`,cursor:U.value}),class:"w-full",onWheel:I,onMousedown:C,onMousemove:S,onClick:H,onDblclick:le,onContextmenu:pe},null,36),e("div",{class:"absolute top-2 right-2 flex gap-1"},[e("button",{class:"btn btn-sm btn-square btn-ghost bg-base-100/80 hover:bg-base-100",title:"Fit to view",onClick:v},[...l[1]||(l[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)])])]),Y(t).isActive.value?(m(),y("div",{key:0,class:K(["absolute top-2 left-2 badge",Y(t).isDrawing.value?"badge-primary":"badge-secondary"])},D(Y(t).isDrawing.value?"Drawing":"Editing"),3)):L("",!0),Y(t).points.value.length>0?(m(),y("div",Rt,D(Y(t).points.value.length)+" point"+D(Y(t).points.value.length!==1?"s":""),1)):L("",!0),Y(t).isActive.value?(m(),y("div",Ct,[e("button",{class:"btn btn-sm btn-ghost bg-base-100/80",onClick:ae}," Cancel "),Y(t).isEditing.value||Y(t).isValidPolygon.value?(m(),y("button",{key:0,class:"btn btn-sm btn-primary",disabled:!Y(t).isValidPolygon.value,onClick:l[0]||(l[0]=()=>{Y(t).isDrawing.value?(Y(t).closePolygon(),w("drawing-complete",Y(t).getPolygonData())):w("drawing-complete",ce())})}," Confirm ",8,$t)):L("",!0)])):L("",!0)],512))}},Ot=Oe(Dt,[["__scopeId","data-v-3d84026e"]]),St={key:0,class:"flex items-center justify-center gap-4 mb-4"},Mt={class:"flex items-center gap-2"},Lt={class:"flex items-center gap-2"},Et={key:1,class:"space-y-4"},Vt={class:"flex flex-wrap gap-2"},Pt=["title","onClick"],At={class:"alert alert-info py-2"},Bt={class:"text-sm"},Tt={key:0,class:"alert py-2"},jt={class:"text-sm"},Nt={class:"form-control"},zt=["disabled"],Ut={key:0,class:"label"},Ft={class:"form-control"},Yt={class:"form-control"},Xt={class:"flex flex-wrap gap-2 mb-3"},Ht=["title","onClick"],Gt={class:"grid grid-cols-3 gap-3"},Wt={class:"flex items-center gap-3 mt-3"},qt={class:"form-control"},Jt={class:"label"},Kt={class:"label-text-alt"},Qt={class:"form-control"},Zt={class:"label"},el={class:"label-text-alt"},tl=["disabled"],ll=["disabled"],nl=["disabled"],sl={key:0,class:"loading loading-spinner loading-sm"},al={__name:"ROIFormModal",props:{modelValue:{type:Boolean,default:!1},roi:{type:Object,default:null},instrumentId:{type:[Number,String],required:!0},instrumentName:{type:String,default:""},loading:{type:Boolean,default:!1},imageUrl:{type:String,default:""},existingRois:{type:Array,default:()=>[]}},emits:["update:modelValue","submit"],setup(g,{emit:j}){const h=g,i=j,w=M(null),t=M("draw"),P=M([]),d=M({roi_name:"",description:"",color_r:255,color_g:0,color_b:0,alpha:.3,thickness:2}),c=O(()=>P.value.length>=3),E=[{name:"Red",r:255,g:0,b:0},{name:"Green",r:0,g:200,b:0},{name:"Blue",r:0,g:100,b:255},{name:"Yellow",r:255,g:220,b:0},{name:"Magenta",r:255,g:0,b:200},{name:"Cyan",r:0,g:200,b:200},{name:"Orange",r:255,g:140,b:0},{name:"Purple",r:128,g:0,b:255}],f=O(()=>{var _;return!!((_=h.roi)!=null&&_.id)}),k=O(()=>f.value?`Edit ${h.roi.roi_name}`:t.value==="draw"?"Draw ROI Polygon":"ROI Details"),z=O(()=>h.imageUrl&&t.value==="draw"),F=O(()=>({backgroundColor:`rgb(${d.value.color_r}, ${d.value.color_g}, ${d.value.color_b})`}));ie(()=>h.roi,_=>{_?d.value={roi_name:_.roi_name||"",description:_.description||"",color_r:_.color_r??255,color_g:_.color_g??0,color_b:_.color_b??0,alpha:_.alpha??.3,thickness:_.thickness??2}:J()},{immediate:!0}),ie(()=>h.modelValue,_=>{_&&!h.roi&&J()});function J(){d.value={roi_name:"",description:"",color_r:255,color_g:0,color_b:0,alpha:.3,thickness:2},P.value=[],t.value=h.imageUrl?"draw":"details"}function Q(_){d.value.color_r=_.r,d.value.color_g=_.g,d.value.color_b=_.b,w.value&&w.value.setColor(_.r,_.g,_.b)}function V(){i("update:modelValue",!1)}function x(_){P.value=_}function U(_){P.value=_.points,d.value.color_r=_.color_r,d.value.color_g=_.color_g,d.value.color_b=_.color_b,d.value.alpha=_.alpha,d.value.thickness=_.thickness,t.value="details"}function W(){P.value=[]}function N(){t.value="draw"}function X(){const _={...d.value,instrument_id:parseInt(h.instrumentId),points:P.value};f.value&&P.value.length===0&&h.roi.points&&(_.points=h.roi.points),i("submit",_)}return(_,p)=>(m(),we(Ye,{"model-value":g.modelValue,title:k.value,size:z.value?"lg":"md","onUpdate:modelValue":p[7]||(p[7]=n=>_.$emit("update:modelValue",n))},{default:he(()=>[g.imageUrl&&!f.value?(m(),y("div",St,[e("div",Mt,[e("div",{class:K(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",t.value==="draw"?"bg-primary text-primary-content":"bg-success text-success-content"])},D(t.value==="draw"?"1":"âœ“"),3),e("span",{class:K(t.value==="draw"?"font-medium":"text-base-content/60")},"Draw",2)]),p[8]||(p[8]=e("div",{class:"w-8 h-0.5 bg-base-300"},null,-1)),e("div",Lt,[e("div",{class:K(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",t.value==="details"?"bg-primary text-primary-content":"bg-base-300 text-base-content/60"])}," 2 ",2),e("span",{class:K(t.value==="details"?"font-medium":"text-base-content/60")},"Details",2)])])):L("",!0),z.value?(m(),y("div",Et,[p[10]||(p[10]=e("div",{class:"alert alert-info py-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"text-sm"},"Click on the image to draw ROI points. Double-click or click the first point to close.")],-1)),e("div",Vt,[p[9]||(p[9]=e("span",{class:"text-sm text-base-content/70"},"Color:",-1)),(m(),y(ye,null,_e(E,n=>e("button",{key:n.name,type:"button",class:"w-6 h-6 rounded border-2 border-base-300 hover:border-primary transition-colors",style:me({backgroundColor:`rgb(${n.r}, ${n.g}, ${n.b})`}),title:n.name,onClick:v=>Q(n)},null,12,Pt)),64))]),ge(Ot,{ref_key:"canvasRef",ref:w,"image-url":g.imageUrl,"existing-rois":g.existingRois,"editing-roi":f.value?g.roi:null,height:400,"default-color":{r:d.value.color_r,g:d.value.color_g,b:d.value.color_b},onPointsChange:x,onDrawingComplete:U,onDrawingCancel:W},null,8,["image-url","existing-rois","editing-roi","default-color"])])):(m(),y("form",{key:2,onSubmit:Le(X,["prevent"]),class:"space-y-4"},[e("div",At,[p[12]||(p[12]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Bt,[p[11]||(p[11]=te("ROI for: ",-1)),e("strong",null,D(g.instrumentName),1)])]),c.value?(m(),y("div",Tt,[p[13]||(p[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",jt,"Polygon drawn with "+D(P.value.length)+" points",1),g.imageUrl?(m(),y("button",{key:0,type:"button",class:"btn btn-ghost btn-xs",onClick:N}," Redraw ")):L("",!0)])):L("",!0),e("div",Nt,[p[15]||(p[15]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"ROI Name"),e("span",{class:"label-text-alt text-base-content/60"},"e.g., ROI_01")],-1)),fe(e("input",{"onUpdate:modelValue":p[0]||(p[0]=n=>d.value.roi_name=n),type:"text",class:"input input-bordered",placeholder:"Leave empty for auto-generated name",disabled:f.value},null,8,zt),[[be,d.value.roi_name]]),f.value?L("",!0):(m(),y("label",Ut,[...p[14]||(p[14]=[e("span",{class:"label-text-alt"},"Auto-generated if left empty",-1)])]))]),e("div",Ft,[p[16]||(p[16]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Description")],-1)),fe(e("textarea",{"onUpdate:modelValue":p[1]||(p[1]=n=>d.value.description=n),class:"textarea textarea-bordered",rows:"2",placeholder:"Optional description of this ROI..."},null,512),[[be,d.value.description]])]),e("div",Yt,[p[21]||(p[21]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Color")],-1)),e("div",Xt,[(m(),y(ye,null,_e(E,n=>e("button",{key:n.name,type:"button",class:"w-8 h-8 rounded-lg border-2 border-base-300 hover:border-primary transition-colors",style:me({backgroundColor:`rgb(${n.r}, ${n.g}, ${n.b})`}),title:n.name,onClick:v=>Q(n)},null,12,Ht)),64))]),e("div",Gt,[e("div",null,[p[17]||(p[17]=e("label",{class:"label py-0"},[e("span",{class:"label-text text-xs"},"Red")],-1)),fe(e("input",{"onUpdate:modelValue":p[2]||(p[2]=n=>d.value.color_r=n),type:"number",min:"0",max:"255",class:"input input-bordered input-sm w-full"},null,512),[[be,d.value.color_r,void 0,{number:!0}]])]),e("div",null,[p[18]||(p[18]=e("label",{class:"label py-0"},[e("span",{class:"label-text text-xs"},"Green")],-1)),fe(e("input",{"onUpdate:modelValue":p[3]||(p[3]=n=>d.value.color_g=n),type:"number",min:"0",max:"255",class:"input input-bordered input-sm w-full"},null,512),[[be,d.value.color_g,void 0,{number:!0}]])]),e("div",null,[p[19]||(p[19]=e("label",{class:"label py-0"},[e("span",{class:"label-text text-xs"},"Blue")],-1)),fe(e("input",{"onUpdate:modelValue":p[4]||(p[4]=n=>d.value.color_b=n),type:"number",min:"0",max:"255",class:"input input-bordered input-sm w-full"},null,512),[[be,d.value.color_b,void 0,{number:!0}]])])]),e("div",Wt,[e("div",{class:"w-12 h-12 rounded-lg border border-base-300",style:me(F.value)},null,4),p[20]||(p[20]=e("span",{class:"text-sm text-base-content/60"},"Color preview",-1))])]),e("div",qt,[e("label",Jt,[p[22]||(p[22]=e("span",{class:"label-text font-medium"},"Opacity",-1)),e("span",Kt,D(Math.round(d.value.alpha*100))+"%",1)]),fe(e("input",{"onUpdate:modelValue":p[5]||(p[5]=n=>d.value.alpha=n),type:"range",min:"0.1",max:"0.8",step:"0.1",class:"range range-primary range-sm"},null,512),[[be,d.value.alpha,void 0,{number:!0}]])]),e("div",Qt,[e("label",Zt,[p[23]||(p[23]=e("span",{class:"label-text font-medium"},"Border Thickness",-1)),e("span",el,D(d.value.thickness)+"px",1)]),fe(e("input",{"onUpdate:modelValue":p[6]||(p[6]=n=>d.value.thickness=n),type:"range",min:"1",max:"10",step:"1",class:"range range-sm"},null,512),[[be,d.value.thickness,void 0,{number:!0}]])])],32))]),actions:he(()=>[e("button",{type:"button",class:"btn btn-ghost",disabled:g.loading,onClick:V}," Cancel ",8,tl),t.value==="details"&&g.imageUrl&&!f.value?(m(),y("button",{key:0,type:"button",class:"btn btn-ghost",disabled:g.loading,onClick:N}," Back ",8,ll)):L("",!0),t.value==="details"?(m(),y("button",{key:1,type:"submit",class:"btn btn-primary",disabled:g.loading||!c.value&&!f.value,onClick:X},[g.loading?(m(),y("span",sl)):L("",!0),te(" "+D(f.value?"Save Changes":"Create ROI"),1)],8,nl)):L("",!0)]),_:1},8,["model-value","title","size"]))}},ol={key:0,class:"flex justify-center py-12"},il={key:1,class:"alert alert-error"},rl={key:2},ul={class:"text-sm breadcrumbs mb-4"},cl={key:0},dl={key:1},vl={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},gl={class:"flex items-start justify-between"},fl={class:"flex items-start gap-4"},ml={class:"flex items-center gap-3"},pl={class:"text-2xl font-bold"},bl={class:"text-sm text-base-content/60 font-mono block mt-1"},hl={class:"flex items-center gap-4 mt-2"},yl={key:0,class:"text-base-content/50 ml-1"},xl={key:0,class:"text-base-content/60 mt-2"},wl={key:0,class:"flex gap-2"},kl={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},_l={class:"text-xl font-semibold mb-4"},Il={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Rl={class:"text-sm text-base-content/60"},Cl={key:1,class:"text-center py-8 text-base-content/60"},$l={key:0,class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},Dl={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ol={key:0},Sl={class:"font-medium"},Ml={key:1},Ll={class:"font-medium"},El={key:2},Vl={class:"font-medium"},Pl={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},Al={class:"flex items-center justify-between mb-4"},Bl={class:"flex items-center gap-3"},Tl={class:"badge badge-lg"},jl={class:"flex items-center gap-2"},Nl={class:"label cursor-pointer gap-2"},zl={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ul={class:"lg:col-span-2"},Fl={class:"lg:col-span-1"},Yl={key:0,class:"mt-4 p-4 bg-base-200 rounded-lg"},Xl={class:"flex items-center justify-between mb-2"},Hl={class:"font-semibold"},Gl={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},Wl={class:"flex items-center gap-2"},ql={key:0,class:"mt-2 text-sm text-base-content/70"},Jl={class:"bg-base-100 rounded-lg shadow-lg p-6"},Kl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm"},Ql={class:"font-mono"},sn={__name:"InstrumentView",props:{id:{type:[Number,String],required:!0}},setup(g){const j=g,h=Pe(),i=Ae(),w=Te(),t=Ge(),P=Ue(),d=Fe(),c=O(()=>i.currentInstrument),E=O(()=>w.currentPlatform),f=O(()=>t.rois),k=O(()=>c.value?je(c.value.instrument_type):null),z=O(()=>c.value?Ne(c.value.instrument_type):{}),F=O(()=>{if(!c.value)return{};const u=c.value.specifications;if(u&&typeof u=="object")return u;if(typeof u=="string")try{return JSON.parse(u)}catch{return{}}return{}}),J=O(()=>z.value?Object.entries(z.value).map(([u,s])=>{var $;const b=F.value[u]??(($=c.value)==null?void 0:$[u]);return{key:u,label:s.label,value:b,config:s,hasValue:b!=null&&b!==""}}):[]),Q=O(()=>c.value?Xe(c.value.status):null),V=O(()=>c.value?He(c.value.measurement_status):null),x=O(()=>E.value?P.canEditStation(E.value.station_id):!1),U=O(()=>i.loading||w.loading),W=O(()=>t.loading),N=M(!1),X=M(!1),_=M(!1),p=M(!1),n=M(null),v=M(null),I=M(null),C=M(!0);async function S(){const u=parseInt(j.id),s=await i.fetchInstrument(u);s&&(await w.fetchPlatform(s.platform_id),await t.fetchROIsByInstrument(u))}Ie(S),ie(()=>j.id,S);function A(){N.value=!0}async function H(u){await i.updateInstrument(c.value.id,u)?(d.success("Instrument updated successfully"),N.value=!1):d.error(i.error||"Failed to update instrument")}function le(){X.value=!0}async function pe(){const u=c.value.platform_id;await i.deleteInstrument(c.value.id)?(d.success("Instrument deleted successfully"),X.value=!1,h.push({name:"platform",params:{id:u}})):d.error(i.error||"Failed to delete instrument")}function ve(u){n.value=u}function re(u){}function ue(u){n.value=u}function ae(){v.value=null,_.value=!0}function ce(u){v.value=u,_.value=!0}function a(u){I.value=u,p.value=!0}async function r(u){var s;(s=v.value)!=null&&s.id?await t.updateROI(v.value.id,u)?(d.success("ROI updated successfully"),_.value=!1,v.value=null):d.error(t.error||"Failed to update ROI"):await t.createROI(u)?(d.success("ROI created successfully"),_.value=!1):d.error(t.error||"Failed to create ROI")}async function R(){var s,b;if(!I.value)return;await t.deleteROI(I.value.id)?(d.success("ROI deleted successfully"),p.value=!1,I.value=null,((s=n.value)==null?void 0:s.id)===((b=I.value)==null?void 0:b.id)&&(n.value=null)):d.error(t.error||"Failed to delete ROI")}const o=O(()=>k.value&&{phenocam:"text-blue-500",multispectral:"text-purple-500",par_sensor:"text-amber-500",ndvi_sensor:"text-green-500",pri_sensor:"text-cyan-500",hyperspectral:"text-pink-500",thermal:"text-red-500",lidar:"text-teal-500",radar:"text-indigo-500"}[k.value.key]||"text-gray-500"),l=O(()=>k.value&&{phenocam:"bg-blue-500/10",multispectral:"bg-purple-500/10",par_sensor:"bg-amber-500/10",ndvi_sensor:"bg-green-500/10",pri_sensor:"bg-cyan-500/10",hyperspectral:"bg-pink-500/10",thermal:"bg-red-500/10",lidar:"bg-teal-500/10",radar:"bg-indigo-500/10"}[k.value.key]||"bg-gray-500/10");return(u,s)=>{var $,B,T,Z,ne,ee,se,oe,xe;const b=Ee("router-link");return m(),y("div",null,[U.value&&!c.value?(m(),y("div",ol,[...s[6]||(s[6]=[e("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):Y(i).error?(m(),y("div",il,[s[7]||(s[7]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,D(Y(i).error),1)])):c.value?(m(),y("div",rl,[e("div",ul,[e("ul",null,[e("li",null,[ge(b,{to:"/dashboard"},{default:he(()=>[...s[8]||(s[8]=[te("Dashboard",-1)])]),_:1})]),E.value?(m(),y("li",cl,[ge(b,{to:`/stations/${E.value.station_acronym}`},{default:he(()=>[te(D(E.value.station_acronym),1)]),_:1},8,["to"])])):L("",!0),E.value?(m(),y("li",dl,[ge(b,{to:`/platforms/${E.value.id}`},{default:he(()=>[te(D(E.value.normalized_name),1)]),_:1},8,["to"])])):L("",!0),e("li",null,D(c.value.normalized_name),1)])]),e("div",vl,[e("div",gl,[e("div",fl,[e("div",{class:K(["p-4 rounded-lg",l.value])},[(m(),y("svg",{xmlns:"http://www.w3.org/2000/svg",class:K(["h-8 w-8",o.value]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...s[9]||(s[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z M15 13a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])],2))],2),e("div",null,[e("div",ml,[e("h1",pl,D(c.value.display_name||c.value.normalized_name),1),e("span",{class:K(["badge",($=Q.value)==null?void 0:$.badgeClass])},D(c.value.status),3)]),e("code",bl,D(c.value.normalized_name),1),e("div",hl,[e("span",{class:K(["font-medium",o.value])},[te(D(((B=k.value)==null?void 0:B.name)||c.value.instrument_type)+" ",1),(T=k.value)!=null&&T.code?(m(),y("span",yl," ("+D(k.value.code)+") ",1)):L("",!0)],2),V.value?(m(),y("span",{key:0,class:K([V.value.textClass,"flex items-center gap-1"])},[e("span",{class:K(["w-2 h-2 rounded-full",V.value.dotClass])},null,2),te(" "+D(c.value.measurement_status),1)],2)):L("",!0)]),c.value.description?(m(),y("p",xl,D(c.value.description),1)):L("",!0)])]),x.value?(m(),y("div",wl,[e("button",{class:"btn btn-outline btn-sm",onClick:A},[...s[10]||(s[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),te(" Edit ",-1)])]),e("button",{class:"btn btn-outline btn-error btn-sm",onClick:le},[...s[11]||(s[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),te(" Delete ",-1)])])])):L("",!0)])]),e("div",kl,[e("h2",_l,D(((Z=k.value)==null?void 0:Z.name)||"Instrument")+" Specifications ",1),J.value.length>0?(m(),y("div",Il,[(m(!0),y(ye,null,_e(J.value,G=>(m(),y("div",{key:G.key,class:"space-y-1"},[e("label",Rl,D(G.label),1),e("div",{class:K(["font-medium",{"text-base-content/40 italic":!G.hasValue}])},D(G.hasValue?Y(ze)(G.value,G.config):"Not specified"),3)]))),128))])):(m(),y("div",Cl,[...s[12]||(s[12]=[e("p",null,"No specifications defined for this instrument type.",-1)])]))]),c.value.deployment_date||c.value.calibration_date?(m(),y("div",$l,[s[16]||(s[16]=e("h2",{class:"text-xl font-semibold mb-4"},"Timeline",-1)),e("div",Dl,[c.value.deployment_date?(m(),y("div",Ol,[s[13]||(s[13]=e("label",{class:"text-sm text-base-content/60"},"Deployment Date",-1)),e("div",Sl,D(new Date(c.value.deployment_date).toLocaleDateString()),1)])):L("",!0),c.value.calibration_date?(m(),y("div",Ml,[s[14]||(s[14]=e("label",{class:"text-sm text-base-content/60"},"Last Calibration",-1)),e("div",Ll,D(new Date(c.value.calibration_date).toLocaleDateString()),1)])):L("",!0),c.value.created_at?(m(),y("div",El,[s[15]||(s[15]=e("label",{class:"text-sm text-base-content/60"},"Added to System",-1)),e("div",Vl,D(new Date(c.value.created_at).toLocaleDateString()),1)])):L("",!0)])])):L("",!0),e("div",Pl,[e("div",Al,[e("div",Bl,[s[17]||(s[17]=e("h2",{class:"text-xl font-semibold"}," Regions of Interest (ROIs) ",-1)),e("span",Tl,D(f.value.length),1)]),e("div",jl,[e("label",Nl,[s[18]||(s[18]=e("span",{class:"label-text text-sm"},"Labels",-1)),fe(e("input",{"onUpdate:modelValue":s[0]||(s[0]=G=>C.value=G),type:"checkbox",class:"toggle toggle-sm toggle-primary"},null,512),[[Ve,C.value]])])])]),e("div",zl,[e("div",Ul,[ge(Y(tt),{rois:f.value,"selected-roi-id":(ne=n.value)==null?void 0:ne.id,"show-labels":C.value,height:400,onRoiClick:ve,onRoiHover:re},null,8,["rois","selected-roi-id","show-labels"]),s[19]||(s[19]=e("p",{class:"text-sm text-base-content/60 mt-2"}," Scroll to zoom, drag to pan. Click ROI to select. ",-1))]),e("div",Fl,[ge(Y(_t),{rois:f.value,"selected-id":(ee=n.value)==null?void 0:ee.id,"can-edit":x.value,loading:W.value,"max-height":350,onSelect:ue,onEdit:ce,onDelete:a,onCreate:ae},null,8,["rois","selected-id","can-edit","loading"])])]),n.value?(m(),y("div",Yl,[e("div",Xl,[e("h3",Hl,D(n.value.roi_name),1),e("button",{class:"btn btn-ghost btn-xs",onClick:s[1]||(s[1]=G=>n.value=null)},[...s[20]||(s[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Gl,[e("div",null,[s[21]||(s[21]=e("label",{class:"text-base-content/60"},"Points",-1)),e("div",null,D(((se=n.value.points)==null?void 0:se.length)||0),1)]),e("div",null,[s[22]||(s[22]=e("label",{class:"text-base-content/60"},"Color",-1)),e("div",Wl,[e("div",{class:"w-4 h-4 rounded border border-base-300",style:me({backgroundColor:`rgb(${n.value.color_r??255}, ${n.value.color_g??0}, ${n.value.color_b??0})`})},null,4),e("span",null,"RGB("+D(n.value.color_r??255)+", "+D(n.value.color_g??0)+", "+D(n.value.color_b??0)+")",1)])]),e("div",null,[s[23]||(s[23]=e("label",{class:"text-base-content/60"},"Auto Generated",-1)),e("div",null,D(n.value.auto_generated?"Yes":"No"),1)]),e("div",null,[s[24]||(s[24]=e("label",{class:"text-base-content/60"},"Created",-1)),e("div",null,D(n.value.created_at?new Date(n.value.created_at).toLocaleDateString():"-"),1)])]),n.value.description?(m(),y("p",ql,D(n.value.description),1)):L("",!0)])):L("",!0)]),e("div",Jl,[s[29]||(s[29]=e("h2",{class:"text-xl font-semibold mb-4"},"Metadata",-1)),e("div",Kl,[e("div",null,[s[25]||(s[25]=e("label",{class:"text-base-content/60"},"ID",-1)),e("div",Ql,D(c.value.id),1)]),e("div",null,[s[26]||(s[26]=e("label",{class:"text-base-content/60"},"Platform",-1)),E.value?(m(),we(b,{key:0,to:`/platforms/${E.value.id}`,class:"link link-primary"},{default:he(()=>[te(D(E.value.normalized_name),1)]),_:1},8,["to"])):L("",!0)]),e("div",null,[s[27]||(s[27]=e("label",{class:"text-base-content/60"},"Created",-1)),e("div",null,D(c.value.created_at?new Date(c.value.created_at).toLocaleString():"-"),1)]),e("div",null,[s[28]||(s[28]=e("label",{class:"text-base-content/60"},"Last Updated",-1)),e("div",null,D(c.value.updated_at?new Date(c.value.updated_at).toLocaleString():"-"),1)])])])])):L("",!0),c.value&&E.value?(m(),we(Y(Be),{key:3,modelValue:N.value,"onUpdate:modelValue":s[2]||(s[2]=G=>N.value=G),instrument:c.value,"platform-id":c.value.platform_id,"platform-name":E.value.normalized_name,"platform-type":E.value.platform_type,onSubmit:H},null,8,["modelValue","instrument","platform-id","platform-name","platform-type"])):L("",!0),ge(Y(Ce),{modelValue:X.value,"onUpdate:modelValue":s[3]||(s[3]=G=>X.value=G),title:"Delete Instrument",message:`Are you sure you want to delete '${(oe=c.value)==null?void 0:oe.normalized_name}'? This will also delete all associated ROIs. This action cannot be undone.`,"confirm-text":"Delete Instrument",variant:"error",loading:Y(i).loading,onConfirm:pe},null,8,["modelValue","message","loading"]),c.value?(m(),we(Y(al),{key:4,modelValue:_.value,"onUpdate:modelValue":s[4]||(s[4]=G=>_.value=G),roi:v.value,"instrument-id":c.value.id,"instrument-name":c.value.normalized_name,loading:Y(t).loading,onSubmit:r},null,8,["modelValue","roi","instrument-id","instrument-name","loading"])):L("",!0),ge(Y(Ce),{modelValue:p.value,"onUpdate:modelValue":s[5]||(s[5]=G=>p.value=G),title:"Delete ROI",message:`Are you sure you want to delete '${(xe=I.value)==null?void 0:xe.roi_name}'? This action cannot be undone.`,"confirm-text":"Delete ROI",variant:"error",loading:Y(t).loading,onConfirm:R},null,8,["modelValue","message","loading"])])}}};export{sn as default};
