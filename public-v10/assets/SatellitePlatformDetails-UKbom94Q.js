import{e as O,h as N}from"./InstrumentIcon.vue_vue_type_style_index_0_scoped_cbf9e092_lang-DF2AECOp.js";import{a as z,h as B,e as E}from"./index-C7OvlrzZ.js";import{r as k,c as y,m as T,L as I,E as R,p as D,e as i,o as d,k as p,f as e,t as u,G as V,g as F,n as L,i as j}from"./vendor-DjAAf7Gn.js";const Z={class:"platform-mini-map-wrapper"},q={key:0,class:"platform-mini-map rounded-lg overflow-hidden border border-base-200 relative"},H={key:0,class:"absolute inset-0 bg-base-200/80 flex items-center justify-center z-10"},J={key:1,class:"absolute inset-0 bg-error/10 flex items-center justify-center z-10 text-xs text-error"},U={key:2,class:"absolute top-16 right-2 bg-white/90 rounded px-2 py-1 text-[10px] z-20 shadow-sm"},G={class:"flex items-center gap-1 mt-0.5"},W={class:"text-gray-500"},X={key:1,class:"text-xs text-base-content/40 italic p-2 bg-base-200 rounded-lg text-center",style:{minHeight:"60px"}},K="#06b6d4",Q={__name:"PlatformMiniMap",props:{platform:{type:Object,required:!0},height:{type:Number,default:200},zoom:{type:Number,default:14},interactive:{type:Boolean,default:!1},showPopup:{type:Boolean,default:!1},showSiblings:{type:Boolean,default:!0}},setup(m){const t=m,a=k(null),b=k(!0),h=k(null),f=k([]);let s=null,l=null;const v=y(()=>{var n,o;return((n=t.platform)==null?void 0:n.latitude)!=null&&((o=t.platform)==null?void 0:o.longitude)!=null}),g={PL:"#fdba74",BL:"#5eead4",GL:"#86efac",UAV:"#fde047",SAT:"#c4b5fd"};function x(n){var r,c;const o=((c=(r=n.mount_type_code)==null?void 0:r.match(/^([A-Z]+)/))==null?void 0:c[1])||"PL";return g[o]||g.PL}function S(n,o=!1){if(!l)return null;const r=o?K:x(n),c=o?{width:10,height:16}:{width:6,height:10},_=o?"filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));":"filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));";return l.divIcon({className:`platform-mini-marker ${o?"selected":"sibling"}`,html:`
      <div style="
        width: 0;
        height: 0;
        border-left: ${c.width}px solid transparent;
        border-right: ${c.width}px solid transparent;
        border-bottom: ${c.height}px solid ${r};
        ${_}
      "></div>
    `,iconSize:[c.width*2,c.height],iconAnchor:[c.width,c.height],popupAnchor:[0,-c.height]})}function $(n,o=!1){const r=n.display_name||n.normalized_name||"Platform",c=n.mount_type_code||n.location_code||"";return`
    <div class="platform-mini-popup text-sm">
      <div class="font-semibold">${r}${o?'<span class="text-[10px] bg-cyan-100 text-cyan-700 px-1 rounded ml-1">Current</span>':""}</div>
      ${c?`<div class="text-xs text-gray-500">${c}</div>`:""}
      <div class="text-xs text-gray-400 mt-1">
        ${Number(n.latitude).toFixed(5)}째N<br>
        ${Number(n.longitude).toFixed(5)}째E
      </div>
    </div>
  `}async function C(){var o;if(!t.showSiblings)return[];const n=(o=t.platform)==null?void 0:o.station_id;if(!n)return[];try{return((await E.get(`/platforms/station/${n}`)).data||[]).filter(_=>_.id!==t.platform.id&&_.latitude!=null&&_.longitude!=null)}catch(r){return console.warn("Failed to fetch sibling platforms:",r),[]}}function M(n){if(!l||n.length===0)return null;const o=n.filter(r=>r.latitude!=null&&r.longitude!=null).map(r=>[r.latitude,r.longitude]);return o.length===0||o.length===1?null:l.latLngBounds(o)}async function A(){if(!(!a.value||!v.value)){b.value=!0,h.value=null;try{if(l=await B(()=>import("./leaflet-src-DUdEndMj.js").then(r=>r.l),[]),!document.querySelector('link[href*="leaflet.css"]')){const r=document.createElement("link");r.rel="stylesheet",r.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(r),await new Promise(c=>setTimeout(c,50))}f.value=await C();const n=[t.platform.latitude,t.platform.longitude];s=l.map(a.value,{center:n,zoom:t.zoom,zoomControl:!0,dragging:t.interactive,scrollWheelZoom:!1,doubleClickZoom:!0,touchZoom:!0,boxZoom:!1,keyboard:!1,attributionControl:!1}),l.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18}).addTo(s),l.control.scale({metric:!0,imperial:!1,maxWidth:100,position:"bottomleft"}).addTo(s),f.value.forEach(r=>{l.marker([r.latitude,r.longitude],{icon:S(r,!1)}).addTo(s).bindPopup($(r,!1))});const o=l.marker(n,{icon:S(t.platform,!0),zIndexOffset:1e3}).addTo(s);if(o.bindPopup($(t.platform,!0)),t.showPopup&&o.openPopup(),f.value.length>0){const r=[t.platform,...f.value],c=M(r);c&&s.fitBounds(c,{padding:[20,20],maxZoom:16})}b.value=!1}catch(n){console.error("Failed to initialize mini map:",n),h.value="Failed to load map",b.value=!1}}}function w(){s&&(s.remove(),s=null)}return T(async()=>{await I(),v.value?await A():b.value=!1}),R(()=>{w()}),D(()=>t.platform,async(n,o)=>{((n==null?void 0:n.id)!==(o==null?void 0:o.id)||(n==null?void 0:n.latitude)!==(o==null?void 0:o.latitude)||(n==null?void 0:n.longitude)!==(o==null?void 0:o.longitude))&&(w(),await I(),v.value&&await A())},{deep:!0}),(n,o)=>(d(),i("div",Z,[v.value?(d(),i("div",q,[b.value?(d(),i("div",H,[...o[0]||(o[0]=[e("span",{class:"loading loading-spinner loading-sm"},null,-1)])])):h.value?(d(),i("div",J,u(h.value),1)):p("",!0),e("div",{ref_key:"mapContainer",ref:a,class:"w-full",style:V({height:`${m.height}px`})},null,4),f.value.length>0?(d(),i("div",U,[o[2]||(o[2]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"inline-block w-0 h-0 border-l-[4px] border-r-[4px] border-b-[7px] border-l-transparent border-r-transparent border-b-cyan-500"}),e("span",{class:"text-gray-600"},"Current")],-1)),e("div",G,[o[1]||(o[1]=e("span",{class:"inline-block w-0 h-0 border-l-[3px] border-r-[3px] border-b-[5px] border-l-transparent border-r-transparent border-b-gray-400"},null,-1)),e("span",W,u(f.value.length)+" other"+u(f.value.length!==1?"s":""),1)])])):p("",!0),o[3]||(o[3]=e("div",{class:"absolute bottom-0.5 right-1 text-[8px] text-base-content/30 z-20"}," OSM ",-1))])):(d(),i("div",X," No coordinates available "))]))}},Y=z(Q,[["__scopeId","data-v-5a12d70d"]]),P={class:"space-y-4"},ee={key:0,class:"w-full"},te={class:"grid grid-cols-2 sm:grid-cols-3 gap-3 text-sm"},oe={key:0},se={class:"flex items-center gap-1.5 mt-0.5"},ne={class:"font-semibold"},ae={key:0,class:"text-xs text-base-content/60"},le={key:1},re=["data-tip"],ie={class:"flex items-center gap-1.5 mt-0.5 cursor-help"},de={class:"badge badge-sm badge-outline font-mono"},ce={class:"text-xs text-base-content/60"},ue={key:2},pe={class:"font-medium mt-0.5 block"},me={key:3,class:"col-span-2 sm:col-span-3"},fe={class:"text-sm mt-0.5 block"},xe={key:4,class:"col-span-2 sm:col-span-3"},ge={class:"font-mono text-xs mt-0.5 block"},Ve={__name:"FixedPlatformDetails",props:{platform:{type:Object,required:!0}},setup(m){const t=m,a=y(()=>{const s=t.platform.mount_type_code||t.platform.location_code;return O(s)}),b=y(()=>N(t.platform.ecosystem_code)),h=y(()=>{const s=t.platform.platform_height_m;return s==null?null:`${s}m`}),f=y(()=>{var s,l;return((s=t.platform)==null?void 0:s.latitude)!=null&&((l=t.platform)==null?void 0:l.longitude)!=null});return(s,l)=>(d(),i("div",P,[f.value?(d(),i("div",ee,[F(Y,{platform:m.platform,height:180,zoom:14,interactive:!1,"show-popup":!1},null,8,["platform"])])):p("",!0),e("div",te,[m.platform.ecosystem_code?(d(),i("div",oe,[l[0]||(l[0]=e("span",{class:"text-xs text-base-content/50 block"},"Ecosystem",-1)),e("div",se,[e("span",ne,u(m.platform.ecosystem_code),1),b.value?(d(),i("span",ae,u(b.value.name),1)):p("",!0)])])):p("",!0),a.value?(d(),i("div",le,[l[1]||(l[1]=e("span",{class:"text-xs text-base-content/50 block"},"Mount Type",-1)),e("div",{class:"tooltip tooltip-bottom","data-tip":a.value.description},[e("div",ie,[e("span",de,u(m.platform.mount_type_code||m.platform.location_code),1),e("span",ce,u(a.value.name),1)])],8,re)])):p("",!0),h.value?(d(),i("div",ue,[l[2]||(l[2]=e("span",{class:"text-xs text-base-content/50 block"},"Height",-1)),e("span",pe,u(h.value),1)])):p("",!0),m.platform.mounting_structure?(d(),i("div",me,[l[3]||(l[3]=e("span",{class:"text-xs text-base-content/50 block"},"Mounting Structure",-1)),e("span",fe,u(m.platform.mounting_structure),1)])):p("",!0),f.value?(d(),i("div",xe,[l[4]||(l[4]=e("span",{class:"text-xs text-base-content/50 block"},"Coordinates",-1)),e("span",ge,u(Number(m.platform.latitude).toFixed(6))+"째N, "+u(Number(m.platform.longitude).toFixed(6))+"째E ",1)])):p("",!0)])]))}},be={class:"grid grid-cols-3 gap-3 text-sm"},he={key:0},ve={key:1},ye={class:"font-semibold mt-0.5 block"},_e={key:2},ke={class:"badge badge-sm badge-warning badge-outline font-mono mt-0.5"},Fe={__name:"UAVPlatformDetails",props:{platform:{type:Object,required:!0}},setup(m){const t=m,a=y(()=>{const s=(t.platform.normalized_name||"").split("_");return t.platform.vendor&&t.platform.model?{vendor:t.platform.vendor,model:t.platform.model,positionId:t.platform.mount_type_code||t.platform.location_code}:s.length>=4?{vendor:s[1],model:s[2],positionId:s[3]}:{vendor:t.platform.vendor||null,model:t.platform.model||null,positionId:t.platform.mount_type_code||t.platform.location_code}}),b={DJI:{name:"DJI",color:"text-orange-500"},MicaSense:{name:"MicaSense",color:"text-green-500"},Parrot:{name:"Parrot",color:"text-blue-500"},Headwall:{name:"Headwall",color:"text-purple-500"},senseFly:{name:"senseFly",color:"text-red-500"}},h=f=>b[f]||{name:f,color:"text-base-content"};return(f,s)=>(d(),i("div",be,[a.value.vendor?(d(),i("div",he,[s[0]||(s[0]=e("span",{class:"text-xs text-base-content/50 block"},"Vendor",-1)),e("span",{class:L(["font-semibold mt-0.5 block",h(a.value.vendor).color])},u(h(a.value.vendor).name),3)])):p("",!0),a.value.model?(d(),i("div",ve,[s[1]||(s[1]=e("span",{class:"text-xs text-base-content/50 block"},"Model",-1)),e("span",ye,u(a.value.model),1)])):p("",!0),a.value.positionId?(d(),i("div",_e,[s[2]||(s[2]=e("span",{class:"text-xs text-base-content/50 block"},"Position",-1)),e("span",ke,u(a.value.positionId),1)])):p("",!0),s[3]||(s[3]=e("div",{class:"col-span-3"},[e("div",{class:"flex items-center gap-2 text-xs text-base-content/60 mt-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 text-warning",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})]),e("span",null,"Instruments auto-created based on UAV model")])],-1))]))}},Se={class:"grid grid-cols-3 gap-3 text-sm"},$e={key:0},Ae=["data-tip"],we={key:1},Ie={class:"mt-0.5"},Le={class:"font-semibold"},Ce={key:0,class:"text-xs text-base-content/60 ml-1"},Me={key:2},Oe=["data-tip"],Ne={class:"badge badge-sm badge-accent badge-outline font-mono mt-0.5 cursor-help"},ze={key:3,class:"col-span-3"},Be={class:"flex items-center gap-2 text-xs text-base-content/60 mt-1"},Ee={key:0},je={__name:"SatellitePlatformDetails",props:{platform:{type:Object,required:!0}},setup(m){const t=m,a=y(()=>{const x=(t.platform.normalized_name||"").split("_");return t.platform.agency&&t.platform.satellite?{agency:t.platform.agency,satellite:t.platform.satellite,sensor:t.platform.sensor}:x.length>=4?{agency:x[1],satellite:x[2],sensor:x[3]}:{agency:null,satellite:null,sensor:null}}),b={ESA:{name:"European Space Agency",shortName:"ESA",color:"text-blue-500",missions:["Sentinel-1","Sentinel-2","Sentinel-3"]},NASA:{name:"National Aeronautics and Space Administration",shortName:"NASA",color:"text-red-500",missions:["Landsat","MODIS"]},JAXA:{name:"Japan Aerospace Exploration Agency",shortName:"JAXA",color:"text-purple-500",missions:["ALOS"]},ISRO:{name:"Indian Space Research Organisation",shortName:"ISRO",color:"text-orange-500",missions:["ResourceSat"]},CSA:{name:"Canadian Space Agency",shortName:"CSA",color:"text-red-400",missions:["RADARSAT"]}},h={S2A:{name:"Sentinel-2A",type:"Optical",resolution:"10m"},S2B:{name:"Sentinel-2B",type:"Optical",resolution:"10m"},S3A:{name:"Sentinel-3A",type:"Ocean/Land",resolution:"300m"},S3B:{name:"Sentinel-3B",type:"Ocean/Land",resolution:"300m"},S1A:{name:"Sentinel-1A",type:"SAR",resolution:"5m"},S1B:{name:"Sentinel-1B",type:"SAR",resolution:"5m"},L8:{name:"Landsat 8",type:"Optical",resolution:"30m"},L9:{name:"Landsat 9",type:"Optical",resolution:"30m"}},f={MSI:{name:"MultiSpectral Instrument",bands:13},OLCI:{name:"Ocean and Land Colour Instrument",bands:21},SLSTR:{name:"Sea and Land Surface Temperature Radiometer",bands:11},SAR:{name:"Synthetic Aperture Radar",bands:1},OLI:{name:"Operational Land Imager",bands:9},TIRS:{name:"Thermal Infrared Sensor",bands:2}},s=g=>b[g]||{name:g,shortName:g,color:"text-base-content"},l=g=>h[g]||{name:g},v=g=>f[g]||{name:g};return(g,x)=>(d(),i("div",Se,[a.value.agency?(d(),i("div",$e,[x[0]||(x[0]=e("span",{class:"text-xs text-base-content/50 block"},"Agency",-1)),e("div",{class:"tooltip tooltip-bottom","data-tip":s(a.value.agency).name},[e("span",{class:L(["font-bold mt-0.5 block cursor-help",s(a.value.agency).color])},u(s(a.value.agency).shortName),3)],8,Ae)])):p("",!0),a.value.satellite?(d(),i("div",we,[x[1]||(x[1]=e("span",{class:"text-xs text-base-content/50 block"},"Satellite",-1)),e("div",Ie,[e("span",Le,u(a.value.satellite),1),l(a.value.satellite).resolution?(d(),i("span",Ce," ("+u(l(a.value.satellite).resolution)+") ",1)):p("",!0)])])):p("",!0),a.value.sensor?(d(),i("div",Me,[x[2]||(x[2]=e("span",{class:"text-xs text-base-content/50 block"},"Sensor",-1)),e("div",{class:"tooltip tooltip-bottom","data-tip":v(a.value.sensor).name},[e("span",Ne,u(a.value.sensor),1)],8,Oe)])):p("",!0),l(a.value.satellite).type?(d(),i("div",ze,[e("div",Be,[x[3]||(x[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 text-accent",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),e("span",null,[j(u(l(a.value.satellite).type)+" sensor ",1),v(a.value.sensor).bands?(d(),i("span",Ee," with "+u(v(a.value.sensor).bands)+" bands ",1)):p("",!0)])])])):p("",!0)]))}};export{Ve as _,je as a,Fe as b};
