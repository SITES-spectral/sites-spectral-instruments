import{_ as j}from"./InstrumentIcon.vue_vue_type_style_index_0_scoped_cbf9e092_lang-D-dukWxj.js";import{c as x,e as a,o as n,f as e,i as V,F as I,h as M,t as b,k as w,L as N,r as C,p as B,s as F,n as R,C as L,K as q,x as U,D as E,q as G,w as H,g as P,m as Z,M as z,E as Y,G as J}from"./vendor-2iZwFq-s.js";import{E as X,M as D,P as T,c as W,d as K}from"./useTypeRegistry-CiWZAadw.js";import{a as Q,h as ee,d as te}from"./index-C1WtuwDD.js";const le={class:"space-y-4"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"form-control"},ne=["value"],ae=["value"],re={class:"form-control"},ie=["value"],de=["value"],ue={key:0,class:"label"},ce={class:"label-text-alt text-base-content/60"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"form-control"},ve=["value"],be={class:"form-control"},fe=["value"],ge={class:"form-control"},ye={class:"bg-base-200 px-4 py-3 rounded-lg font-mono text-lg"},xe={__name:"FixedPlatformFields",props:{modelValue:{type:Object,required:!0},stationAcronym:{type:String,required:!0}},emits:["update:modelValue"],setup(m,{emit:u}){const s=m,k=u,_=x(()=>Object.values(X).map(d=>({value:d.code,label:`${d.code} - ${d.name}`,description:d.description}))),S=x(()=>Object.values(D).filter(d=>d.platformTypes.includes("fixed")).map(d=>({value:d.code,label:`${d.code} - ${d.name}`,description:d.description}))),c=x(()=>{const d=s.modelValue.mount_type_prefix;return D[d]||null}),p=x(()=>{const d=s.stationAcronym,o=s.modelValue.ecosystem_code||"???",v=s.modelValue.mount_type_prefix||"PL";return`${d}_${o}_${v}##`});function $(d,o){k("update:modelValue",{...s.modelValue,[d]:o})}return(d,o)=>(n(),a("div",le,[e("div",se,[e("div",oe,[o[5]||(o[5]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},[V("Ecosystem "),e("span",{class:"text-error"},"*")])],-1)),e("select",{value:m.modelValue.ecosystem_code,onChange:o[0]||(o[0]=v=>$("ecosystem_code",v.target.value)),class:"select select-bordered w-full",required:""},[o[4]||(o[4]=e("option",{value:""},"Select ecosystem...",-1)),(n(!0),a(I,null,M(_.value,v=>(n(),a("option",{key:v.value,value:v.value},b(v.label),9,ae))),128))],40,ne),o[6]||(o[6]=e("label",{class:"label"},[e("span",{class:"label-text-alt text-base-content/60"}," The ecosystem type being monitored at this platform ")],-1))]),e("div",re,[o[7]||(o[7]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},[V("Mount Type "),e("span",{class:"text-error"},"*")])],-1)),e("select",{value:m.modelValue.mount_type_prefix,onChange:o[1]||(o[1]=v=>$("mount_type_prefix",v.target.value)),class:"select select-bordered w-full",required:""},[(n(!0),a(I,null,M(S.value,v=>(n(),a("option",{key:v.value,value:v.value},b(v.label),9,de))),128))],40,ie),c.value?(n(),a("label",ue,[e("span",ce,b(c.value.description),1)])):w("",!0)])]),e("div",me,[e("div",pe,[o[8]||(o[8]=e("label",{class:"label"},[e("span",{class:"label-text"},"Platform Height (m)")],-1)),e("input",{type:"number",value:m.modelValue.platform_height_m,onInput:o[2]||(o[2]=v=>$("platform_height_m",v.target.value?Number(v.target.value):null)),class:"input input-bordered w-full",placeholder:"e.g., 30",min:"0",max:"500",step:"0.1"},null,40,ve),o[9]||(o[9]=e("label",{class:"label"},[e("span",{class:"label-text-alt text-base-content/60"}," Height above ground in meters ")],-1))]),e("div",be,[o[10]||(o[10]=e("label",{class:"label"},[e("span",{class:"label-text"},"Mounting Structure")],-1)),e("input",{type:"text",value:m.modelValue.mounting_structure,onInput:o[3]||(o[3]=v=>$("mounting_structure",v.target.value)),class:"input input-bordered w-full",placeholder:"e.g., Steel lattice tower"},null,40,fe),o[11]||(o[11]=e("label",{class:"label"},[e("span",{class:"label-text-alt text-base-content/60"}," Description of the physical mounting structure ")],-1))])]),e("div",ge,[o[12]||(o[12]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Platform Name Preview")],-1)),e("div",ye,b(p.value),1),o[13]||(o[13]=e("label",{class:"label"},[e("span",{class:"label-text-alt"}," Format: {STATION}_{ECOSYSTEM}_{MOUNT_TYPE}## ")],-1))])]))}},he={class:"space-y-4"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Se={class:"form-control"},$e=["value"],ke=["value"],we={class:"form-control"},Ae=["value","disabled"],Ve=["value"],Ie={key:0,class:"alert alert-info"},Me={class:"font-medium"},Oe={class:"list-disc list-inside mt-1 text-sm"},Ce={key:1,class:"alert alert-warning"},Te={class:"form-control"},Le={class:"bg-base-200 px-4 py-3 rounded-lg font-mono text-lg"},Ee={__name:"UAVPlatformFields",props:{modelValue:{type:Object,required:!0},stationAcronym:{type:String,required:!0}},emits:["update:modelValue"],setup(m,{emit:u}){const s=m,k=u,_=x(()=>T.uav),S=x(()=>_.value.fields.vendor.options.map(v=>({value:v,label:v}))),c=x(()=>{const v=s.modelValue.vendor;return v?(_.value.fields.model.optionsByParent[v]||[]).map(y=>({value:y,label:y})):[]}),p=x(()=>{const v=s.stationAcronym,f=s.modelValue.vendor||"???",y=s.modelValue.model||"???";return`${v}_${f}_${y}_UAV##`});function $(v,f){const y={...s.modelValue,[v]:f};v==="vendor"&&(y.model=""),k("update:modelValue",y)}const d={M3M:["Multispectral (4 bands + RGB)","RGB Camera"],P4M:["Multispectral (5 bands)","RGB Camera"],M30T:["RGB Camera","Thermal Camera","Laser Rangefinder"],M300:["Payload Mount (customizable)"],M350:["Payload Mount (customizable)"],"RedEdge-MX":["Multispectral (5 bands)"],"Altum-PT":["Multispectral (5 bands)","Thermal Camera","Panchromatic"],"Sequoia+":["Multispectral (4 bands)","RGB Camera"],"Nano-Hyperspec":["Hyperspectral (270 bands)"]},o=x(()=>d[s.modelValue.model]||[]);return(v,f)=>(n(),a("div",he,[e("div",_e,[e("div",Se,[f[3]||(f[3]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},[V("Vendor "),e("span",{class:"text-error"},"*")])],-1)),e("select",{value:m.modelValue.vendor,onChange:f[0]||(f[0]=y=>$("vendor",y.target.value)),class:"select select-bordered w-full",required:""},[f[2]||(f[2]=e("option",{value:""},"Select vendor...",-1)),(n(!0),a(I,null,M(S.value,y=>(n(),a("option",{key:y.value,value:y.value},b(y.label),9,ke))),128))],40,$e),f[4]||(f[4]=e("label",{class:"label"},[e("span",{class:"label-text-alt text-base-content/60"}," UAV or sensor manufacturer ")],-1))]),e("div",we,[f[6]||(f[6]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},[V("Model "),e("span",{class:"text-error"},"*")])],-1)),e("select",{value:m.modelValue.model,onChange:f[1]||(f[1]=y=>$("model",y.target.value)),class:"select select-bordered w-full",required:"",disabled:!m.modelValue.vendor},[f[5]||(f[5]=e("option",{value:""},"Select model...",-1)),(n(!0),a(I,null,M(c.value,y=>(n(),a("option",{key:y.value,value:y.value},b(y.label),9,Ve))),128))],40,Ae),f[7]||(f[7]=e("label",{class:"label"},[e("span",{class:"label-text-alt text-base-content/60"}," UAV or sensor model ")],-1))])]),o.value.length>0?(n(),a("div",Ie,[f[8]||(f[8]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",null,[e("div",Me,"Auto-created instruments for "+b(m.modelValue.model)+":",1),e("ul",Oe,[(n(!0),a(I,null,M(o.value,y=>(n(),a("li",{key:y},b(y),1))),128))])])])):(n(),a("div",Ce,[...f[9]||(f[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),e("span",null,"UAV instruments will be auto-created based on the selected model.",-1)])])),e("div",Te,[f[10]||(f[10]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Platform Name Preview")],-1)),e("div",Le,b(p.value),1),f[11]||(f[11]=e("label",{class:"label"},[e("span",{class:"label-text-alt"}," Format: {STATION}_{VENDOR}_{MODEL}_UAV## ")],-1))])]))}},Ne={class:"space-y-4"},Be={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Re={class:"form-control"},ze=["value"],De=["value"],Fe={class:"form-control"},Pe=["value","disabled"],je=["value"],qe={class:"form-control"},Ue=["value","disabled"],Ge=["value"],He={key:0,class:"bg-base-200 p-4 rounded-lg"},Ze={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Ye={key:0},Je={class:"font-medium text-accent mb-1"},Xe={class:"text-base-content/60"},We={key:1},Ke={class:"font-medium text-secondary mb-1"},Qe={class:"text-base-content/60"},et={class:"form-control"},tt={class:"bg-base-200 px-4 py-3 rounded-lg font-mono text-lg"},lt={__name:"SatellitePlatformFields",props:{modelValue:{type:Object,required:!0},stationAcronym:{type:String,required:!0}},emits:["update:modelValue"],setup(m,{emit:u}){const s=m,k=u,_=x(()=>T.satellite),S=x(()=>_.value.fields.agency.options.map(A=>({value:A,label:A}))),c=x(()=>{const A=s.modelValue.agency;return A?(_.value.fields.satellite.optionsByParent[A]||[]).map(l=>({value:l,label:l})):[]}),p=x(()=>{const A=s.modelValue.satellite;return A?(_.value.fields.sensor.optionsByParent[A]||[]).map(l=>({value:l,label:l})):[]}),$=x(()=>{const A=s.stationAcronym,g=s.modelValue.agency||"???",l=s.modelValue.satellite||"???",t=s.modelValue.sensor||"???";return`${A}_${g}_${l}_${t}`});function d(A,g){const l={...s.modelValue,[A]:g};A==="agency"&&(l.satellite="",l.sensor=""),A==="satellite"&&(l.sensor=""),k("update:modelValue",l)}const o={S2A:{name:"Sentinel-2A",launch:"2015",orbit:"Sun-synchronous"},S2B:{name:"Sentinel-2B",launch:"2017",orbit:"Sun-synchronous"},S3A:{name:"Sentinel-3A",launch:"2016",orbit:"Sun-synchronous"},S3B:{name:"Sentinel-3B",launch:"2018",orbit:"Sun-synchronous"},S1A:{name:"Sentinel-1A",launch:"2014",orbit:"Sun-synchronous"},S1B:{name:"Sentinel-1B",launch:"2016",orbit:"Sun-synchronous"},L8:{name:"Landsat 8",launch:"2013",orbit:"Sun-synchronous"},L9:{name:"Landsat 9",launch:"2021",orbit:"Sun-synchronous"}},v=x(()=>o[s.modelValue.satellite]||null),f={MSI:{name:"MultiSpectral Instrument",bands:13,resolution:"10-60m"},OLCI:{name:"Ocean and Land Colour Instrument",bands:21,resolution:"300m"},SLSTR:{name:"Sea and Land Surface Temperature Radiometer",bands:11,resolution:"500m-1km"},SAR:{name:"Synthetic Aperture Radar",bands:"C-band",resolution:"5-40m"},OLI:{name:"Operational Land Imager",bands:9,resolution:"15-30m"},TIRS:{name:"Thermal Infrared Sensor",bands:2,resolution:"100m"}},y=x(()=>f[s.modelValue.sensor]||null);return(A,g)=>(n(),a("div",Ne,[e("div",Be,[e("div",Re,[g[4]||(g[4]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},[V("Space Agency "),e("span",{class:"text-error"},"*")])],-1)),e("select",{value:m.modelValue.agency,onChange:g[0]||(g[0]=l=>d("agency",l.target.value)),class:"select select-bordered w-full",required:""},[g[3]||(g[3]=e("option",{value:""},"Select agency...",-1)),(n(!0),a(I,null,M(S.value,l=>(n(),a("option",{key:l.value,value:l.value},b(l.label),9,De))),128))],40,ze)]),e("div",Fe,[g[6]||(g[6]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},[V("Satellite "),e("span",{class:"text-error"},"*")])],-1)),e("select",{value:m.modelValue.satellite,onChange:g[1]||(g[1]=l=>d("satellite",l.target.value)),class:"select select-bordered w-full",required:"",disabled:!m.modelValue.agency},[g[5]||(g[5]=e("option",{value:""},"Select satellite...",-1)),(n(!0),a(I,null,M(c.value,l=>(n(),a("option",{key:l.value,value:l.value},b(l.label),9,je))),128))],40,Pe)]),e("div",qe,[g[8]||(g[8]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},[V("Sensor "),e("span",{class:"text-error"},"*")])],-1)),e("select",{value:m.modelValue.sensor,onChange:g[2]||(g[2]=l=>d("sensor",l.target.value)),class:"select select-bordered w-full",required:"",disabled:!m.modelValue.satellite},[g[7]||(g[7]=e("option",{value:""},"Select sensor...",-1)),(n(!0),a(I,null,M(p.value,l=>(n(),a("option",{key:l.value,value:l.value},b(l.label),9,Ge))),128))],40,Ue)])]),v.value||y.value?(n(),a("div",He,[e("div",Ze,[v.value?(n(),a("div",Ye,[e("div",Je,b(v.value.name),1),e("div",Xe," Launch: "+b(v.value.launch)+" | "+b(v.value.orbit),1)])):w("",!0),y.value?(n(),a("div",We,[e("div",Ke,b(y.value.name),1),e("div",Qe,b(y.value.bands)+" bands | "+b(y.value.resolution),1)])):w("",!0)])])):w("",!0),e("div",et,[g[9]||(g[9]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Platform Name Preview")],-1)),e("div",tt,b($.value),1),g[10]||(g[10]=e("label",{class:"label"},[e("span",{class:"label-text-alt"}," Format: {STATION}_{AGENCY}_{SATELLITE}_{SENSOR} ")],-1))]),g[11]||(g[11]=e("div",{class:"alert"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",null,"Satellite platforms are virtual - they represent satellite data coverage over the station area.")],-1))]))}},st={key:0,class:"form-control"},ot={class:"flex flex-wrap gap-2"},nt=["value"],at={class:"text-xl"},rt={key:0,class:"label"},it={class:"label-text-alt text-base-content/60"},dt={class:"collapse collapse-arrow bg-base-200"},ut={class:"collapse-content space-y-4"},ct={class:"form-control"},mt={class:"form-control"},pt={key:0,class:"grid grid-cols-2 gap-4"},vt={class:"form-control"},bt={class:"form-control"},ft={class:"flex justify-end gap-2 pt-4"},gt=["disabled"],yt=["disabled"],xt={key:0,class:"loading loading-spinner loading-sm"},ht={__name:"PlatformForm",props:{platform:{type:Object,default:null},stationId:{type:Number,required:!0},stationAcronym:{type:String,required:!0},loading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(m,{emit:u}){const s=m,k=u,_={fixed:N(xe),uav:N(Ee),satellite:N(lt)},S=x(()=>Object.entries(T).map(([l,t])=>({value:l,label:t.name,icon:t.icon,description:t.description}))),c=x(()=>!!s.platform),p=C("fixed"),$=C({}),d=C({display_name:"",description:"",latitude:null,longitude:null}),o=x(()=>_[p.value]||_.fixed),v=x(()=>T[p.value]);B(()=>s.platform,l=>{l&&(p.value=l.platform_type||"fixed",d.value={display_name:l.display_name||"",description:l.description||"",latitude:l.latitude,longitude:l.longitude},f(l))},{immediate:!0});function f(l){const t=(l==null?void 0:l.platform_type)||p.value,r=T[t];if(!r)return;const i={};Object.keys(r.fields).forEach(h=>{l&&l[h]!==void 0&&(i[h]=l[h])}),t==="fixed"&&(l!=null&&l.mount_type_code)&&(i.mount_type_prefix=l.mount_type_code.substring(0,2)),$.value=i}B(p,(l,t)=>{if(l!==t&&!c.value){const r=T[l],i={};Object.entries(r.fields).forEach(([h,O])=>{i[h]=O.defaultValue??""}),$.value=i}});const y=x(()=>{const l=v.value;if(!l)return!1;for(const[t,r]of Object.entries(l.fields))if(r.required){const i=$.value[t];if(i==null||i==="")return!1}return!0});function A(){if(!y.value)return;const l={station_id:s.stationId,platform_type:p.value,...d.value};Object.entries($.value).forEach(([t,r])=>{r!=null&&r!==""&&(l[t]=r)}),Object.keys(l).forEach(t=>{(l[t]===void 0||l[t]==="")&&delete l[t]}),k("submit",l)}function g(){k("cancel")}return(l,t)=>{var r;return n(),a("form",{onSubmit:G(A,["prevent"]),class:"space-y-6"},[c.value?w("",!0):(n(),a("div",st,[t[6]||(t[6]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Platform Type")],-1)),e("div",ot,[(n(!0),a(I,null,M(S.value,i=>(n(),a("label",{key:i.value,class:R(["flex items-center gap-2 px-4 py-2 rounded-lg border cursor-pointer transition-colors",p.value===i.value?"border-primary bg-primary/10":"border-base-300 hover:border-primary/50"])},[L(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=h=>p.value=h),value:i.value,class:"radio radio-primary radio-sm"},null,8,nt),[[q,p.value]]),e("span",at,b(i.icon),1),e("span",null,b(i.label),1)],2))),128))]),(r=v.value)!=null&&r.description?(n(),a("label",rt,[e("span",it,b(v.value.description),1)])):w("",!0)])),(n(),F(U(o.value),{modelValue:$.value,"onUpdate:modelValue":t[1]||(t[1]=i=>$.value=i),"station-acronym":m.stationAcronym},null,8,["modelValue","station-acronym"])),e("div",dt,[t[11]||(t[11]=e("input",{type:"checkbox"},null,-1)),t[12]||(t[12]=e("div",{class:"collapse-title font-medium"}," Optional Fields ",-1)),e("div",ut,[e("div",ct,[t[7]||(t[7]=e("label",{class:"label"},[e("span",{class:"label-text"},"Display Name")],-1)),L(e("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>d.value.display_name=i),type:"text",class:"input input-bordered w-full",placeholder:"Human-readable name"},null,512),[[E,d.value.display_name]])]),e("div",mt,[t[8]||(t[8]=e("label",{class:"label"},[e("span",{class:"label-text"},"Description")],-1)),L(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=i=>d.value.description=i),class:"textarea textarea-bordered w-full",rows:"2",placeholder:"Platform description..."},null,512),[[E,d.value.description]])]),p.value!=="satellite"?(n(),a("div",pt,[e("div",vt,[t[9]||(t[9]=e("label",{class:"label"},[e("span",{class:"label-text"},"Latitude")],-1)),L(e("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>d.value.latitude=i),type:"number",step:"0.000001",class:"input input-bordered w-full",placeholder:"e.g., 64.256"},null,512),[[E,d.value.latitude,void 0,{number:!0}]])]),e("div",bt,[t[10]||(t[10]=e("label",{class:"label"},[e("span",{class:"label-text"},"Longitude")],-1)),L(e("input",{"onUpdate:modelValue":t[5]||(t[5]=i=>d.value.longitude=i),type:"number",step:"0.000001",class:"input input-bordered w-full",placeholder:"e.g., 19.775"},null,512),[[E,d.value.longitude,void 0,{number:!0}]])])])):w("",!0)])]),e("div",ft,[e("button",{type:"button",class:"btn btn-ghost",onClick:g,disabled:m.loading}," Cancel ",8,gt),e("button",{type:"submit",class:"btn btn-primary",disabled:!y.value||m.loading},[m.loading?(n(),a("span",xt)):w("",!0),V(" "+b(c.value?"Update Platform":"Create Platform"),1)],8,yt)])],32)}}},xl={__name:"PlatformFormModal",props:{modelValue:{type:Boolean,default:!1},platform:{type:Object,default:null},stationId:{type:Number,required:!0},stationAcronym:{type:String,required:!0}},emits:["update:modelValue","submit","cancel"],setup(m,{emit:u}){const s=m,k=u,_=C(!1),S=x(()=>!!s.platform),c=x(()=>S.value?"Edit Platform":"Create Platform");async function p(o){_.value=!0;try{k("submit",o)}finally{_.value=!1}}function $(){k("update:modelValue",!1),k("cancel")}function d(){k("update:modelValue",!1)}return(o,v)=>(n(),F(j,{"model-value":m.modelValue,title:c.value,size:"lg","onUpdate:modelValue":v[0]||(v[0]=f=>o.$emit("update:modelValue",f)),onClose:d},{default:H(()=>[P(ht,{platform:m.platform,"station-id":m.stationId,"station-acronym":m.stationAcronym,loading:_.value,onSubmit:p,onCancel:$},null,8,["platform","station-id","station-acronym","loading"])]),_:1},8,["model-value","title"]))}},_t={class:"platform-mini-map-wrapper"},St={key:0,class:"platform-mini-map rounded-lg overflow-hidden border border-base-200 relative"},$t={key:0,class:"absolute inset-0 bg-base-200/80 flex items-center justify-center z-10"},kt={key:1,class:"absolute inset-0 bg-error/10 flex items-center justify-center z-10 text-xs text-error"},wt={key:2,class:"absolute top-16 right-2 bg-white/90 rounded px-2 py-1 text-[10px] z-20 shadow-sm"},At={class:"flex items-center gap-1 mt-0.5"},Vt={class:"text-gray-500"},It={key:1,class:"text-xs text-base-content/40 italic p-2 bg-base-200 rounded-lg text-center",style:{minHeight:"60px"}},Mt="#06b6d4",Ot={__name:"PlatformMiniMap",props:{platform:{type:Object,required:!0},height:{type:Number,default:200},zoom:{type:Number,default:14},interactive:{type:Boolean,default:!1},showPopup:{type:Boolean,default:!1},showSiblings:{type:Boolean,default:!0}},setup(m){const u=m,s=C(null),k=C(!0),_=C(null),S=C([]);let c=null,p=null;const $=x(()=>{var t,r;return((t=u.platform)==null?void 0:t.latitude)!=null&&((r=u.platform)==null?void 0:r.longitude)!=null}),d={PL:"#fdba74",BL:"#5eead4",GL:"#86efac",UAV:"#fde047",SAT:"#c4b5fd"};function o(t){var i,h;const r=((h=(i=t.mount_type_code)==null?void 0:i.match(/^([A-Z]+)/))==null?void 0:h[1])||"PL";return d[r]||d.PL}function v(t,r=!1){if(!p)return null;const i=r?Mt:o(t),h=r?{width:10,height:16}:{width:6,height:10},O=r?"filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));":"filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));";return p.divIcon({className:`platform-mini-marker ${r?"selected":"sibling"}`,html:`
      <div style="
        width: 0;
        height: 0;
        border-left: ${h.width}px solid transparent;
        border-right: ${h.width}px solid transparent;
        border-bottom: ${h.height}px solid ${i};
        ${O}
      "></div>
    `,iconSize:[h.width*2,h.height],iconAnchor:[h.width,h.height],popupAnchor:[0,-h.height]})}function f(t,r=!1){const i=t.display_name||t.normalized_name||"Platform",h=t.mount_type_code||t.location_code||"";return`
    <div class="platform-mini-popup text-sm">
      <div class="font-semibold">${i}${r?'<span class="text-[10px] bg-cyan-100 text-cyan-700 px-1 rounded ml-1">Current</span>':""}</div>
      ${h?`<div class="text-xs text-gray-500">${h}</div>`:""}
      <div class="text-xs text-gray-400 mt-1">
        ${Number(t.latitude).toFixed(5)}째N<br>
        ${Number(t.longitude).toFixed(5)}째E
      </div>
    </div>
  `}async function y(){var r;if(!u.showSiblings)return[];const t=(r=u.platform)==null?void 0:r.station_id;if(!t)return[];try{return((await te.get(`/platforms/station/${t}`)).data||[]).filter(O=>O.id!==u.platform.id&&O.latitude!=null&&O.longitude!=null)}catch(i){return console.warn("Failed to fetch sibling platforms:",i),[]}}function A(t){if(!p||t.length===0)return null;const r=t.filter(i=>i.latitude!=null&&i.longitude!=null).map(i=>[i.latitude,i.longitude]);return r.length===0||r.length===1?null:p.latLngBounds(r)}async function g(){if(!(!s.value||!$.value)){k.value=!0,_.value=null;try{if(p=await ee(()=>import("./leaflet-src-DUdEndMj.js").then(i=>i.l),[]),!document.querySelector('link[href*="leaflet.css"]')){const i=document.createElement("link");i.rel="stylesheet",i.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(i),await new Promise(h=>setTimeout(h,50))}S.value=await y();const t=[u.platform.latitude,u.platform.longitude];c=p.map(s.value,{center:t,zoom:u.zoom,zoomControl:!0,dragging:u.interactive,scrollWheelZoom:!1,doubleClickZoom:!0,touchZoom:!0,boxZoom:!1,keyboard:!1,attributionControl:!1}),p.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18}).addTo(c),p.control.scale({metric:!0,imperial:!1,maxWidth:100,position:"bottomleft"}).addTo(c),S.value.forEach(i=>{p.marker([i.latitude,i.longitude],{icon:v(i,!1)}).addTo(c).bindPopup(f(i,!1))});const r=p.marker(t,{icon:v(u.platform,!0),zIndexOffset:1e3}).addTo(c);if(r.bindPopup(f(u.platform,!0)),u.showPopup&&r.openPopup(),S.value.length>0){const i=[u.platform,...S.value],h=A(i);h&&c.fitBounds(h,{padding:[20,20],maxZoom:16})}k.value=!1}catch(t){console.error("Failed to initialize mini map:",t),_.value="Failed to load map",k.value=!1}}}function l(){c&&(c.remove(),c=null)}return Z(async()=>{await z(),$.value?await g():k.value=!1}),Y(()=>{l()}),B(()=>u.platform,async(t,r)=>{((t==null?void 0:t.id)!==(r==null?void 0:r.id)||(t==null?void 0:t.latitude)!==(r==null?void 0:r.latitude)||(t==null?void 0:t.longitude)!==(r==null?void 0:r.longitude))&&(l(),await z(),$.value&&await g())},{deep:!0}),(t,r)=>(n(),a("div",_t,[$.value?(n(),a("div",St,[k.value?(n(),a("div",$t,[...r[0]||(r[0]=[e("span",{class:"loading loading-spinner loading-sm"},null,-1)])])):_.value?(n(),a("div",kt,b(_.value),1)):w("",!0),e("div",{ref_key:"mapContainer",ref:s,class:"w-full",style:J({height:`${m.height}px`})},null,4),S.value.length>0?(n(),a("div",wt,[r[2]||(r[2]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"inline-block w-0 h-0 border-l-[4px] border-r-[4px] border-b-[7px] border-l-transparent border-r-transparent border-b-cyan-500"}),e("span",{class:"text-gray-600"},"Current")],-1)),e("div",At,[r[1]||(r[1]=e("span",{class:"inline-block w-0 h-0 border-l-[3px] border-r-[3px] border-b-[5px] border-l-transparent border-r-transparent border-b-gray-400"},null,-1)),e("span",Vt,b(S.value.length)+" other"+b(S.value.length!==1?"s":""),1)])])):w("",!0),r[3]||(r[3]=e("div",{class:"absolute bottom-0.5 right-1 text-[8px] text-base-content/30 z-20"}," OSM ",-1))])):(n(),a("div",It," No coordinates available "))]))}},Ct=Q(Ot,[["__scopeId","data-v-5a12d70d"]]),Tt={class:"space-y-4"},Lt={key:0,class:"w-full"},Et={class:"grid grid-cols-2 sm:grid-cols-3 gap-3 text-sm"},Nt={key:0},Bt={class:"flex items-center gap-1.5 mt-0.5"},Rt={class:"font-semibold"},zt={key:0,class:"text-xs text-base-content/60"},Dt={key:1},Ft=["data-tip"],Pt={class:"flex items-center gap-1.5 mt-0.5 cursor-help"},jt={class:"badge badge-sm badge-outline font-mono"},qt={class:"text-xs text-base-content/60"},Ut={key:2},Gt={class:"font-medium mt-0.5 block"},Ht={key:3,class:"col-span-2 sm:col-span-3"},Zt={class:"text-sm mt-0.5 block"},Yt={key:4,class:"col-span-2 sm:col-span-3"},Jt={class:"font-mono text-xs mt-0.5 block"},hl={__name:"FixedPlatformDetails",props:{platform:{type:Object,required:!0}},setup(m){const u=m,s=x(()=>{const c=u.platform.mount_type_code||u.platform.location_code;return W(c)}),k=x(()=>K(u.platform.ecosystem_code)),_=x(()=>{const c=u.platform.platform_height_m;return c==null?null:`${c}m`}),S=x(()=>{var c,p;return((c=u.platform)==null?void 0:c.latitude)!=null&&((p=u.platform)==null?void 0:p.longitude)!=null});return(c,p)=>(n(),a("div",Tt,[S.value?(n(),a("div",Lt,[P(Ct,{platform:m.platform,height:180,zoom:14,interactive:!1,"show-popup":!1},null,8,["platform"])])):w("",!0),e("div",Et,[m.platform.ecosystem_code?(n(),a("div",Nt,[p[0]||(p[0]=e("span",{class:"text-xs text-base-content/50 block"},"Ecosystem",-1)),e("div",Bt,[e("span",Rt,b(m.platform.ecosystem_code),1),k.value?(n(),a("span",zt,b(k.value.name),1)):w("",!0)])])):w("",!0),s.value?(n(),a("div",Dt,[p[1]||(p[1]=e("span",{class:"text-xs text-base-content/50 block"},"Mount Type",-1)),e("div",{class:"tooltip tooltip-bottom","data-tip":s.value.description},[e("div",Pt,[e("span",jt,b(m.platform.mount_type_code||m.platform.location_code),1),e("span",qt,b(s.value.name),1)])],8,Ft)])):w("",!0),_.value?(n(),a("div",Ut,[p[2]||(p[2]=e("span",{class:"text-xs text-base-content/50 block"},"Height",-1)),e("span",Gt,b(_.value),1)])):w("",!0),m.platform.mounting_structure?(n(),a("div",Ht,[p[3]||(p[3]=e("span",{class:"text-xs text-base-content/50 block"},"Mounting Structure",-1)),e("span",Zt,b(m.platform.mounting_structure),1)])):w("",!0),S.value?(n(),a("div",Yt,[p[4]||(p[4]=e("span",{class:"text-xs text-base-content/50 block"},"Coordinates",-1)),e("span",Jt,b(Number(m.platform.latitude).toFixed(6))+"째N, "+b(Number(m.platform.longitude).toFixed(6))+"째E ",1)])):w("",!0)])]))}},Xt={class:"grid grid-cols-3 gap-3 text-sm"},Wt={key:0},Kt={key:1},Qt={class:"font-semibold mt-0.5 block"},el={key:2},tl={class:"badge badge-sm badge-warning badge-outline font-mono mt-0.5"},_l={__name:"UAVPlatformDetails",props:{platform:{type:Object,required:!0}},setup(m){const u=m,s=x(()=>{const c=(u.platform.normalized_name||"").split("_");return u.platform.vendor&&u.platform.model?{vendor:u.platform.vendor,model:u.platform.model,positionId:u.platform.mount_type_code||u.platform.location_code}:c.length>=4?{vendor:c[1],model:c[2],positionId:c[3]}:{vendor:u.platform.vendor||null,model:u.platform.model||null,positionId:u.platform.mount_type_code||u.platform.location_code}}),k={DJI:{name:"DJI",color:"text-orange-500"},MicaSense:{name:"MicaSense",color:"text-green-500"},Parrot:{name:"Parrot",color:"text-blue-500"},Headwall:{name:"Headwall",color:"text-purple-500"},senseFly:{name:"senseFly",color:"text-red-500"}},_=S=>k[S]||{name:S,color:"text-base-content"};return(S,c)=>(n(),a("div",Xt,[s.value.vendor?(n(),a("div",Wt,[c[0]||(c[0]=e("span",{class:"text-xs text-base-content/50 block"},"Vendor",-1)),e("span",{class:R(["font-semibold mt-0.5 block",_(s.value.vendor).color])},b(_(s.value.vendor).name),3)])):w("",!0),s.value.model?(n(),a("div",Kt,[c[1]||(c[1]=e("span",{class:"text-xs text-base-content/50 block"},"Model",-1)),e("span",Qt,b(s.value.model),1)])):w("",!0),s.value.positionId?(n(),a("div",el,[c[2]||(c[2]=e("span",{class:"text-xs text-base-content/50 block"},"Position",-1)),e("span",tl,b(s.value.positionId),1)])):w("",!0),c[3]||(c[3]=e("div",{class:"col-span-3"},[e("div",{class:"flex items-center gap-2 text-xs text-base-content/60 mt-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 text-warning",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})]),e("span",null,"Instruments auto-created based on UAV model")])],-1))]))}},ll={class:"grid grid-cols-3 gap-3 text-sm"},sl={key:0},ol=["data-tip"],nl={key:1},al={class:"mt-0.5"},rl={class:"font-semibold"},il={key:0,class:"text-xs text-base-content/60 ml-1"},dl={key:2},ul=["data-tip"],cl={class:"badge badge-sm badge-accent badge-outline font-mono mt-0.5 cursor-help"},ml={key:3,class:"col-span-3"},pl={class:"flex items-center gap-2 text-xs text-base-content/60 mt-1"},vl={key:0},Sl={__name:"SatellitePlatformDetails",props:{platform:{type:Object,required:!0}},setup(m){const u=m,s=x(()=>{const o=(u.platform.normalized_name||"").split("_");return u.platform.agency&&u.platform.satellite?{agency:u.platform.agency,satellite:u.platform.satellite,sensor:u.platform.sensor}:o.length>=4?{agency:o[1],satellite:o[2],sensor:o[3]}:{agency:null,satellite:null,sensor:null}}),k={ESA:{name:"European Space Agency",shortName:"ESA",color:"text-blue-500",missions:["Sentinel-1","Sentinel-2","Sentinel-3"]},NASA:{name:"National Aeronautics and Space Administration",shortName:"NASA",color:"text-red-500",missions:["Landsat","MODIS"]},JAXA:{name:"Japan Aerospace Exploration Agency",shortName:"JAXA",color:"text-purple-500",missions:["ALOS"]},ISRO:{name:"Indian Space Research Organisation",shortName:"ISRO",color:"text-orange-500",missions:["ResourceSat"]},CSA:{name:"Canadian Space Agency",shortName:"CSA",color:"text-red-400",missions:["RADARSAT"]}},_={S2A:{name:"Sentinel-2A",type:"Optical",resolution:"10m"},S2B:{name:"Sentinel-2B",type:"Optical",resolution:"10m"},S3A:{name:"Sentinel-3A",type:"Ocean/Land",resolution:"300m"},S3B:{name:"Sentinel-3B",type:"Ocean/Land",resolution:"300m"},S1A:{name:"Sentinel-1A",type:"SAR",resolution:"5m"},S1B:{name:"Sentinel-1B",type:"SAR",resolution:"5m"},L8:{name:"Landsat 8",type:"Optical",resolution:"30m"},L9:{name:"Landsat 9",type:"Optical",resolution:"30m"}},S={MSI:{name:"MultiSpectral Instrument",bands:13},OLCI:{name:"Ocean and Land Colour Instrument",bands:21},SLSTR:{name:"Sea and Land Surface Temperature Radiometer",bands:11},SAR:{name:"Synthetic Aperture Radar",bands:1},OLI:{name:"Operational Land Imager",bands:9},TIRS:{name:"Thermal Infrared Sensor",bands:2}},c=d=>k[d]||{name:d,shortName:d,color:"text-base-content"},p=d=>_[d]||{name:d},$=d=>S[d]||{name:d};return(d,o)=>(n(),a("div",ll,[s.value.agency?(n(),a("div",sl,[o[0]||(o[0]=e("span",{class:"text-xs text-base-content/50 block"},"Agency",-1)),e("div",{class:"tooltip tooltip-bottom","data-tip":c(s.value.agency).name},[e("span",{class:R(["font-bold mt-0.5 block cursor-help",c(s.value.agency).color])},b(c(s.value.agency).shortName),3)],8,ol)])):w("",!0),s.value.satellite?(n(),a("div",nl,[o[1]||(o[1]=e("span",{class:"text-xs text-base-content/50 block"},"Satellite",-1)),e("div",al,[e("span",rl,b(s.value.satellite),1),p(s.value.satellite).resolution?(n(),a("span",il," ("+b(p(s.value.satellite).resolution)+") ",1)):w("",!0)])])):w("",!0),s.value.sensor?(n(),a("div",dl,[o[2]||(o[2]=e("span",{class:"text-xs text-base-content/50 block"},"Sensor",-1)),e("div",{class:"tooltip tooltip-bottom","data-tip":$(s.value.sensor).name},[e("span",cl,b(s.value.sensor),1)],8,ul)])):w("",!0),p(s.value.satellite).type?(n(),a("div",ml,[e("div",pl,[o[3]||(o[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 text-accent",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),e("span",null,[V(b(p(s.value.satellite).type)+" sensor ",1),$(s.value.sensor).bands?(n(),a("span",vl," with "+b($(s.value.sensor).bands)+" bands ",1)):w("",!0)])])])):w("",!0)]))}};export{hl as _,Sl as a,_l as b,xl as c};
