import{c as u,e as l,o as a,F as T,i as F,f as t,t as r,l as p,b as Q,k as g,G as J,n as h,h as y,g as V,w as j,r as B,m as lt,E as ot,p as A,s as rt,a as it}from"./vendor-oiqY8oHn.js";import{a as X,b as ut,f as mt,u as ct,g as dt,_ as W}from"./platforms-B8RC1nK3.js";import{u as ft,_ as vt}from"./instruments-BWtGho0E.js";import{u as pt,b as gt}from"./index-BP56eZvN.js";import{_ as bt,a as ht,b as yt,c as xt}from"./SatellitePlatformDetails-jDlpCXNp.js";import{g as wt,a as kt}from"./BaseModal-BSvtwcmN.js";const _t={key:0,class:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-sm"},Mt={class:"text-xs text-base-content/50 block truncate"},Ct=["title"],$t={key:1,class:"text-xs text-base-content/50 italic"},Vt={__name:"InstrumentTypeDetails",props:{instrument:{type:Object,required:!0},showAllFields:{type:Boolean,default:!1}},setup(n){const d=n,x=u(()=>X(d.instrument.instrument_type)),f=u(()=>{if(d.instrument.specifications&&typeof d.instrument.specifications=="object")return d.instrument.specifications;if(typeof d.instrument.specifications=="string")try{return JSON.parse(d.instrument.specifications)}catch{return{}}return d.instrument}),o=u(()=>{var k;if(!((k=x.value)!=null&&k.fields))return[];const e=x.value.fields,P=ut(d.instrument.instrument_type);return(d.showAllFields?Object.keys(e):P).map(_=>{const c=e[_];if(!c)return null;const i=f.value[_]??d.instrument[_];return{key:_,label:c.label,value:i,config:c,hasValue:i!=null&&i!==""}}).filter(_=>_!==null)}),D=u(()=>o.value.filter(e=>e.hasValue)),v=u(()=>D.value.length>0);return(e,P)=>v.value?(a(),l("div",_t,[(a(!0),l(T,null,F(D.value,w=>(a(),l("div",{key:w.key,class:"min-w-0"},[t("span",Mt,r(w.label),1),t("span",{class:"font-medium block truncate",title:String(w.value)},r(p(mt)(w.value,w.config)),9,Ct)]))),128))])):(a(),l("div",$t," No specifications recorded "))}},It={class:"flex items-start justify-between gap-2"},St={class:"flex items-center gap-2 min-w-0 flex-1"},Dt=["title"],Pt=["d"],zt={class:"min-w-0 flex-1"},Bt={class:"text-xs text-base-content/50 font-mono truncate block"},jt={class:"flex items-center flex-wrap gap-x-3 gap-y-1 mt-2 text-xs"},At={key:0,class:"opacity-70 ml-1"},Tt={key:0,class:"text-accent"},Ft={key:0,class:"mt-3 pt-2 border-t border-base-200"},Et={key:1,class:"mt-2"},Ht={key:2,class:"flex justify-end gap-1 mt-2 pt-2 border-t border-base-200"},Lt={key:3,class:"flex justify-end mt-2 pt-2 border-t border-base-200"},Nt={__name:"InstrumentCard",props:{instrument:{type:Object,required:!0},canEdit:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},showPlatform:{type:Boolean,default:!1},showAllSpecs:{type:Boolean,default:!1}},emits:["edit","delete","view"],setup(n,{emit:d}){const x=n,f=d,o=u(()=>X(x.instrument.instrument_type)),D=u(()=>wt(x.instrument.status)),v=u(()=>kt(x.instrument.measurement_status)),e=u(()=>{var c;return x.instrument.roi_count||((c=x.instrument.rois)==null?void 0:c.length)||0});u(()=>{var c;return((c=o.value)==null?void 0:c.color)||"#6b7280"});const P=u(()=>o.value&&{phenocam:"bg-blue-500/10",multispectral:"bg-purple-500/10",par_sensor:"bg-amber-500/10",ndvi_sensor:"bg-green-500/10",pri_sensor:"bg-cyan-500/10",hyperspectral:"bg-pink-500/10",thermal:"bg-red-500/10",lidar:"bg-teal-500/10",radar:"bg-indigo-500/10"}[o.value.key]||"bg-gray-500/10"),w=u(()=>o.value&&{phenocam:"text-blue-500",multispectral:"text-purple-500",par_sensor:"text-amber-500",ndvi_sensor:"text-green-500",pri_sensor:"text-cyan-500",hyperspectral:"text-pink-500",thermal:"text-red-500",lidar:"text-teal-500",radar:"text-indigo-500"}[o.value.key]||"text-gray-500"),k={camera:["M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z","M15 13a3 3 0 11-6 0 3 3 0 016 0z"],"layer-group":["M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"],sun:["M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"],leaf:["M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"],microscope:["M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],rainbow:["M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],"temperature-high":["M9 19c-4.3 1.4-6-2.7-6-7 0-4.3 1.7-8.4 6-7m0 14V5m0 14a5 5 0 005-5 5 5 0 00-5-5"],"wave-square":["M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"],"satellite-dish":["M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.14 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"],cube:["M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"]},_=u(()=>{var i;const c=((i=o.value)==null?void 0:i.icon)||"cube";return k[c]||k.cube});return(c,i)=>{var I,S,C,$;const M=Q("router-link");return a(),l("div",{class:h(["card bg-base-100 shadow-sm border border-base-200 hover:border-primary/30 transition-colors",{"card-compact":n.compact}])},[t("div",{class:h(["card-body",n.compact?"p-2":"p-3"])},[t("div",It,[t("div",St,[t("div",{class:h(["flex-shrink-0 rounded flex items-center justify-center",P.value]),style:J({width:n.compact?"28px":"32px",height:n.compact?"28px":"32px"}),title:((I=o.value)==null?void 0:I.name)||n.instrument.instrument_type},[(a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",class:h([w.value]),style:J({width:n.compact?"14px":"16px",height:n.compact?"14px":"16px"}),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(a(!0),l(T,null,F(_.value,(z,E)=>(a(),l("path",{key:E,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:z},null,8,Pt))),128))],6))],14,Dt),t("div",zt,[t("h5",{class:h(["font-medium truncate",n.compact?"text-xs":"text-sm"])},r(n.instrument.display_name),3),t("code",Bt,r(n.instrument.normalized_name),1)])]),t("span",{class:h(["badge",n.compact?"badge-xs":"badge-sm",D.value.badgeClass])},r(n.instrument.status),3)]),t("div",jt,[t("span",{class:h(["badge badge-sm",((S=o.value)==null?void 0:S.badgeClass)||"badge-ghost"])},[y(r(((C=o.value)==null?void 0:C.name)||n.instrument.instrument_type)+" ",1),($=o.value)!=null&&$.code?(a(),l("span",At," ("+r(o.value.code)+") ",1)):g("",!0)],2),t("span",{class:h([v.value.textClass,"flex items-center gap-1"])},[t("span",{class:h(["w-1.5 h-1.5 rounded-full",v.value.dotClass])},null,2),y(" "+r(n.instrument.measurement_status||"Unknown"),1)],2),e.value>0?(a(),l("span",Tt,r(e.value)+" ROI"+r(e.value!==1?"s":""),1)):g("",!0)]),n.compact?g("",!0):(a(),l("div",Ft,[V(Vt,{instrument:n.instrument,"show-all-fields":n.showAllSpecs},null,8,["instrument","show-all-fields"])])),n.showPlatform&&n.instrument.platform_name?(a(),l("div",Et,[V(M,{to:`/platforms/${n.instrument.platform_id}`,class:"text-xs text-primary hover:underline"},{default:j(()=>[y(r(n.instrument.platform_name),1)]),_:1},8,["to"])])):g("",!0),n.canEdit?(a(),l("div",Ht,[V(M,{to:`/instruments/${n.instrument.id}`,class:"btn btn-ghost btn-xs"},{default:j(()=>[...i[2]||(i[2]=[y(" View ",-1)])]),_:1},8,["to"]),t("button",{onClick:i[0]||(i[0]=z=>f("edit",n.instrument)),class:"btn btn-ghost btn-xs text-primary"}," Edit "),t("button",{onClick:i[1]||(i[1]=z=>f("delete",n.instrument)),class:"btn btn-ghost btn-xs text-error"}," Delete ")])):n.compact?g("",!0):(a(),l("div",Lt,[V(M,{to:`/instruments/${n.instrument.id}`,class:"btn btn-ghost btn-xs text-primary"},{default:j(()=>[...i[3]||(i[3]=[y(" View Details ",-1),t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),_:1},8,["to"])]))],2)],2)}}},Ot={key:0,class:"flex justify-center py-12"},Ut={key:1,class:"alert alert-error"},qt={key:2},Rt={class:"text-sm breadcrumbs mb-4"},Gt={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},Jt={class:"flex items-start justify-between"},Wt={class:"flex items-center gap-3"},Qt={class:"text-2xl font-bold"},Xt={class:"text-sm text-base-content/60 font-mono mt-1 block"},Yt={key:0,class:"text-base-content/60 mt-2"},Zt={key:0,class:"flex gap-2"},Kt={class:"mt-6 pt-4 border-t border-base-200"},te={class:"bg-base-100 rounded-lg shadow-lg p-6"},ee={class:"flex items-center justify-between mb-4"},se={class:"text-xl font-semibold"},ne={class:"badge badge-lg ml-2"},ae={key:0,class:"space-y-6"},le={class:"text-lg font-medium mb-3 flex items-center gap-2"},oe={class:"badge badge-secondary"},re={class:"text-base-content/60 text-sm font-normal"},ie={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ue={key:1,class:"text-center py-8"},ge={__name:"PlatformView",props:{id:{type:[Number,String],required:!0}},setup(n){const d=n,x=it(),f=ct(),o=ft(),D=pt(),v=gt(),e=u(()=>f.currentPlatform),P=u(()=>e.value?dt(e.value.platform_type):null),w=u(()=>{var m;switch((m=e.value)==null?void 0:m.platform_type){case"uav":return yt;case"satellite":return ht;case"fixed":default:return bt}}),k=u(()=>e.value?D.canEditStation(e.value.station_id):!1),_=u(()=>o.instrumentsByType),c=u(()=>f.loading||o.loading),i=B(!1),M=B(!1),I=B(!1),S=B(!1),C=B(null),$=B(null);async function z(){const m=parseInt(d.id);await f.fetchPlatform(m)&&await o.fetchInstrumentsByPlatform(m)}lt(z),ot(()=>d.id,z);function E(){i.value=!0}function Y(){I.value=!0}async function Z(m){await f.updatePlatform(e.value.id,m)?(v.success("Platform updated successfully"),i.value=!1):v.error(f.error||"Failed to update platform")}async function K(){const m=e.value.station_acronym;await f.deletePlatform(e.value.id)?(v.success("Platform deleted successfully"),I.value=!1,x.push({name:"station",params:{acronym:m}})):v.error(f.error||"Failed to delete platform")}function H(){C.value=null,M.value=!0}function tt(m){C.value=m,M.value=!0}function et(m){$.value=m,S.value=!0}async function st(m){let s;C.value?(s=await o.updateInstrument(C.value.id,m),s&&v.success("Instrument updated successfully")):(s=await o.createInstrument(m),s&&v.success("Instrument created successfully")),s?(M.value=!1,C.value=null):v.error(o.error||"Failed to save instrument")}async function nt(){if(!$.value)return;await o.deleteInstrument($.value.id)?(v.success("Instrument deleted successfully"),S.value=!1,$.value=null):v.error(o.error||"Failed to delete instrument")}const at=u(()=>{var s;return{fixed:"badge-info",uav:"badge-warning",satellite:"badge-accent"}[(s=e.value)==null?void 0:s.platform_type]||"badge-info"});return(m,s)=>{var N,O,U,q;const L=Q("router-link");return a(),l("div",null,[c.value&&!e.value?(a(),l("div",Ot,[...s[4]||(s[4]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):p(f).error?(a(),l("div",Ut,[s[5]||(s[5]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,r(p(f).error),1)])):e.value?(a(),l("div",qt,[t("div",Rt,[t("ul",null,[t("li",null,[V(L,{to:"/dashboard"},{default:j(()=>[...s[6]||(s[6]=[y("Dashboard",-1)])]),_:1})]),t("li",null,[V(L,{to:`/stations/${e.value.station_acronym}`},{default:j(()=>[y(r(e.value.station_acronym),1)]),_:1},8,["to"])]),t("li",null,r(e.value.normalized_name),1)])]),t("div",Gt,[t("div",Jt,[t("div",null,[t("div",Wt,[t("h1",Qt,r(e.value.display_name||e.value.normalized_name),1),t("span",{class:h(["badge badge-lg",at.value])},r(((N=P.value)==null?void 0:N.name)||e.value.platform_type),3),t("span",{class:h([e.value.status==="Active"?"badge-success":"badge-warning","badge"])},r(e.value.status),3)]),t("code",Xt,r(e.value.normalized_name),1),e.value.description?(a(),l("p",Yt,r(e.value.description),1)):g("",!0)]),k.value?(a(),l("div",Zt,[t("button",{class:"btn btn-outline btn-sm",onClick:E},[...s[7]||(s[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),y(" Edit ",-1)])]),t("button",{class:"btn btn-outline btn-error btn-sm",onClick:Y},[...s[8]||(s[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),y(" Delete ",-1)])])])):g("",!0)]),t("div",Kt,[(a(),A(rt(w.value),{platform:e.value},null,8,["platform"]))])]),t("div",te,[t("div",ee,[t("h2",se,[s[9]||(s[9]=y(" Instruments ",-1)),t("span",ne,r(p(o).instrumentCount),1)]),k.value?(a(),l("button",{key:0,class:"btn btn-primary btn-sm",onClick:H},[...s[10]||(s[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),y(" Add Instrument ",-1)])])):g("",!0)]),p(o).instrumentCount>0?(a(),l("div",ae,[(a(!0),l(T,null,F(_.value,(b,R)=>(a(),l("div",{key:R},[t("h3",le,[t("span",oe,r(R),1),t("span",re,r(b.length)+" instrument"+r(b.length!==1?"s":""),1)]),t("div",ie,[(a(!0),l(T,null,F(b,G=>(a(),A(Nt,{key:G.id,instrument:G,"can-edit":k.value,onEdit:tt,onDelete:et},null,8,["instrument","can-edit"]))),128))])]))),128))])):(a(),l("div",ue,[s[11]||(s[11]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-base-content/30",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1)),s[12]||(s[12]=t("p",{class:"mt-4 text-base-content/60"},"No instruments found",-1)),k.value?(a(),l("button",{key:0,class:"btn btn-primary mt-4",onClick:H}," Add First Instrument ")):g("",!0)]))])])):g("",!0),e.value?(a(),A(p(xt),{key:3,modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=b=>i.value=b),platform:e.value,"station-id":e.value.station_id,"station-acronym":e.value.station_acronym,onSubmit:Z},null,8,["modelValue","platform","station-id","station-acronym"])):g("",!0),V(p(W),{modelValue:I.value,"onUpdate:modelValue":s[1]||(s[1]=b=>I.value=b),title:"Delete Platform",message:`Are you sure you want to delete '${(O=e.value)==null?void 0:O.normalized_name}'? This will also delete all ${p(o).instrumentCount} instrument(s). This action cannot be undone.`,"confirm-text":"Delete Platform",variant:"error",loading:p(f).loading,onConfirm:K},null,8,["modelValue","message","loading"]),e.value?(a(),A(p(vt),{key:4,modelValue:M.value,"onUpdate:modelValue":s[2]||(s[2]=b=>M.value=b),instrument:C.value,"platform-id":e.value.id,"platform-name":e.value.normalized_name,"platform-type":e.value.platform_type,onSubmit:st},null,8,["modelValue","instrument","platform-id","platform-name","platform-type"])):g("",!0),V(p(W),{modelValue:S.value,"onUpdate:modelValue":s[3]||(s[3]=b=>S.value=b),title:"Delete Instrument",message:`Are you sure you want to delete '${((U=$.value)==null?void 0:U.normalized_name)||((q=$.value)==null?void 0:q.display_name)}'? This action cannot be undone.`,"confirm-text":"Delete",variant:"error",loading:p(o).loading,onConfirm:nt},null,8,["modelValue","message","loading"])])}}};export{ge as default};
