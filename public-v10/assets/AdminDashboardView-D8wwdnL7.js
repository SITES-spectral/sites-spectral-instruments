import{d as Y,r as S,c as p,m as G,e as c,f as t,k as f,n as x,l as v,t as l,F as D,C as R,I as z,h as N,j as J,i as L,o as u,G as C}from"./vendor-DIThaKhE.js";import{c as O,u as K}from"./index-DZmuRoCO.js";const Q=Y("admin",()=>{const k=S([]),r=S([]),g=S([]),y=S(null),_=S(!1),h=S(null),M=S("week"),m=p(()=>{const a={create:[],update:[],delete:[],login:[],logout:[]};return k.value.forEach(n=>{var i;const o=((i=n.action)==null?void 0:i.toLowerCase())||"unknown";a[o]&&a[o].push(n)}),a}),V=p(()=>{const a={};return k.value.forEach(n=>{var s;const o=n.station_id||"system";a[o]||(a[o]={station_id:o,station_acronym:n.station_acronym||"System",activities:[],create_count:0,update_count:0,delete_count:0}),a[o].activities.push(n);const i=(s=n.action)==null?void 0:s.toLowerCase();i==="create"&&a[o].create_count++,i==="update"&&a[o].update_count++,i==="delete"&&a[o].delete_count++}),Object.values(a)}),w=p(()=>{const a=new Date,n=new Date(a.getTime()-7*24*60*60*1e3),i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(s=>({day:s,logins:0,creates:0,updates:0,deletes:0,total:0}));return k.value.filter(s=>new Date(s.created_at)>=n).forEach(s=>{var P;const b=new Date(s.created_at).getDay(),A=(P=s.action)==null?void 0:P.toLowerCase();A==="login"&&i[b].logins++,A==="create"&&i[b].creates++,A==="update"&&i[b].updates++,A==="delete"&&i[b].deletes++,i[b].total++}),i}),E=p(()=>{const a={};return k.value.forEach(n=>{var b;const o=new Date(n.created_at),i=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;a[i]||(a[i]={month:i,logins:0,creates:0,updates:0,deletes:0,total:0,unique_users:new Set,unique_stations:new Set});const s=(b=n.action)==null?void 0:b.toLowerCase();s==="login"&&a[i].logins++,s==="create"&&a[i].creates++,s==="update"&&a[i].updates++,s==="delete"&&a[i].deletes++,a[i].total++,n.user_id&&a[i].unique_users.add(n.user_id),n.station_id&&a[i].unique_stations.add(n.station_id)}),Object.values(a).map(n=>({...n,unique_users:n.unique_users.size,unique_stations:n.unique_stations.size})).sort((n,o)=>n.month.localeCompare(o.month))}),H=p(()=>r.value.filter(a=>!a.last_login)),j=p(()=>[...g.value].sort((a,n)=>n.total_activity-a.total_activity).slice(0,10)),F=p(()=>[...g.value].filter(a=>a.total_activity===0||!a.last_activity).sort((a,n)=>a.last_activity?n.last_activity?new Date(a.last_activity)-new Date(n.last_activity):1:-1)),W=p(()=>{const a=Array.from({length:24},(n,o)=>({hour:o,label:`${String(o).padStart(2,"0")}:00`,count:0}));return k.value.forEach(n=>{const o=new Date(n.created_at).getHours();a[o].count++}),a});async function T(a={}){_.value=!0,h.value=null;try{const n=new URLSearchParams;a.station_id&&n.append("station_id",a.station_id),a.user_id&&n.append("user_id",a.user_id),a.action&&n.append("action",a.action),a.start_date&&n.append("start_date",a.start_date),a.end_date&&n.append("end_date",a.end_date),a.limit&&n.append("limit",a.limit);const o=n.toString(),i=`/admin/activity-logs${o?"?"+o:""}`,s=await O.get(i);s.success?k.value=s.data||[]:h.value=s.error||"Failed to fetch activity logs"}catch(n){h.value=n.message}finally{_.value=!1}}async function I(){_.value=!0,h.value=null;try{const a=await O.get("/admin/user-sessions");a.success?r.value=a.data||[]:h.value=a.error||"Failed to fetch user sessions"}catch(a){h.value=a.message}finally{_.value=!1}}async function q(){_.value=!0,h.value=null;try{const a=await O.get("/admin/station-stats");a.success?g.value=a.data||[]:h.value=a.error||"Failed to fetch station stats"}catch(a){h.value=a.message}finally{_.value=!1}}async function B(){try{const a=await O.get("/admin/health");a.success&&(y.value=a.data)}catch(a){console.error("Failed to fetch system health:",a)}}async function $(){_.value=!0,h.value=null;try{await Promise.all([T({limit:1e3}),I(),q(),B()])}catch(a){h.value=a.message}finally{_.value=!1}}function U(a){M.value=a;const n=new Date;let o;switch(a){case"day":o=new Date(n.getTime()-24*60*60*1e3);break;case"week":o=new Date(n.getTime()-7*24*60*60*1e3);break;case"month":o=new Date(n.getTime()-30*24*60*60*1e3);break;case"year":o=new Date(n.getTime()-365*24*60*60*1e3);break;default:o=new Date(n.getTime()-7*24*60*60*1e3)}T({start_date:o.toISOString(),end_date:n.toISOString(),limit:1e4})}function d(a){const n=k.value.filter(o=>o.station_id===a);return{total:n.length,creates:n.filter(o=>{var i;return((i=o.action)==null?void 0:i.toLowerCase())==="create"}).length,updates:n.filter(o=>{var i;return((i=o.action)==null?void 0:i.toLowerCase())==="update"}).length,deletes:n.filter(o=>{var i;return((i=o.action)==null?void 0:i.toLowerCase())==="delete"}).length,lastActivity:n.length>0?n.sort((o,i)=>new Date(i.created_at)-new Date(o.created_at))[0]:null}}function e(){k.value=[],r.value=[],g.value=[],y.value=null,h.value=null}return{activityLogs:k,userSessions:r,stationStats:g,systemHealth:y,loading:_,error:h,timeRange:M,activityByAction:m,activityByStation:V,weeklyActivity:w,monthlyTrend:E,neverLoggedInUsers:H,mostActiveStations:j,leastActiveStations:F,peakUsageHours:W,fetchActivityLogs:T,fetchUserSessions:I,fetchStationStats:q,fetchSystemHealth:B,fetchAllAdminData:$,setTimeRange:U,getStationActivitySummary:d,clearAdminData:e}}),X={class:"space-y-6"},Z={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},tt={class:"flex items-center gap-2"},et={class:"tabs tabs-boxed"},st=["disabled"],at={key:0,class:"loading loading-spinner loading-sm"},nt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ot={key:0,class:"alert alert-error"},lt={class:"tabs tabs-bordered"},it={key:1,class:"flex justify-center py-12"},dt={class:"space-y-6"},rt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ct={class:"stat bg-base-100 rounded-lg shadow"},ut={class:"stat-value text-primary"},vt={class:"stat-desc"},gt={class:"stat bg-base-100 rounded-lg shadow"},ht={class:"stat-value text-secondary"},mt={class:"stat-desc"},pt={class:"stat bg-base-100 rounded-lg shadow"},_t={class:"stat-value text-accent"},bt={class:"stat-desc"},xt={class:"text-success"},ft={class:"text-info"},yt={class:"text-error"},wt={class:"stat bg-base-100 rounded-lg shadow"},kt={class:"stat-desc"},St={class:"card bg-base-100 shadow"},Dt={class:"card-body"},At={class:"h-48 flex items-end gap-1 px-4"},Lt={class:"flex-1 w-full flex flex-col justify-end gap-0.5"},Ct=["title"],Mt=["title"],Tt=["title"],Ut=["title"],Ht={class:"text-xs text-base-content/60 mt-2"},jt={class:"card bg-base-100 shadow"},It={class:"card-body"},qt={class:"space-y-2"},Bt={key:0,class:"alert alert-warning"},$t={class:"font-bold"},Rt={class:"text-sm"},zt={key:1,class:"alert alert-error"},Nt={class:"font-bold"},Ot={class:"text-sm"},Vt={key:2,class:"alert alert-success"},Et={class:"space-y-6"},Ft={class:"card bg-base-100 shadow"},Wt={class:"card-body"},Pt={class:"overflow-x-auto"},Yt={class:"table table-sm"},Gt={class:"font-bold"},Jt={class:"badge badge-success badge-sm"},Kt={class:"badge badge-info badge-sm"},Qt={class:"badge badge-error badge-sm"},Xt={class:"font-semibold"},Zt=["d"],te=["onClick"],ee={key:0},se={class:"space-y-6"},ae={class:"card bg-base-100 shadow"},ne={class:"card-body"},oe={class:"overflow-x-auto"},le={class:"table table-sm"},ie={class:"font-bold"},de={class:"badge badge-ghost badge-sm"},re={class:"text-sm"},ce={key:0},ue={class:"space-y-6"},ve={class:"card bg-base-100 shadow"},ge={class:"card-body"},he={class:"overflow-x-auto"},me={class:"h-64 flex items-end gap-2 min-w-max px-4"},pe={class:"flex-1 w-full flex flex-col justify-end gap-0.5"},_e={class:"text-xs text-base-content/60 mt-2 text-center"},be={class:"text-xs font-semibold"},xe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"},fe={class:"text-center p-3 bg-base-200 rounded-lg"},ye={class:"text-lg font-bold text-primary"},we={class:"text-center p-3 bg-base-200 rounded-lg"},ke={class:"text-lg font-bold text-secondary"},Se={class:"text-center p-3 bg-base-200 rounded-lg"},De={class:"text-lg font-bold text-accent"},Ae={class:"text-center p-3 bg-base-200 rounded-lg"},Le={class:"text-lg font-bold"},Ce={class:"card bg-base-100 shadow"},Me={class:"card-body"},Te={class:"flex items-end gap-0.5 h-32"},Ue=["title"],He={class:"card bg-base-100 shadow"},je={class:"card-body"},Ie={class:"space-y-3"},qe={class:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center font-bold text-primary"},Be={class:"flex-1"},$e={class:"font-semibold"},Re={class:"text-sm text-base-content/60"},ze={class:"w-32 bg-base-200 rounded-full h-2"},Ne={class:"modal-box max-w-2xl"},Oe={class:"font-bold text-lg"},Ve={key:0,class:"py-4 space-y-4"},Ee={class:"grid grid-cols-3 gap-4"},Fe={class:"stat bg-base-200 rounded-lg"},We={class:"stat-value text-success text-2xl"},Pe={class:"stat bg-base-200 rounded-lg"},Ye={class:"stat-value text-info text-2xl"},Ge={class:"stat bg-base-200 rounded-lg"},Je={class:"stat-value text-error text-2xl"},Ke={class:"max-h-64 overflow-y-auto"},Qe={class:"table table-xs"},Xe={class:"text-xs"},Ze={class:"modal-action"},ts={method:"dialog",class:"modal-backdrop"},es={key:3,class:"collapse collapse-arrow bg-base-100 shadow"},ss={class:"collapse-title font-medium"},as={class:"flex items-center gap-2"},ns={class:"collapse-content"},os={class:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4"},ls={class:"text-center p-4 bg-base-200 rounded-lg"},is={class:"text-xl font-bold"},ds={class:"text-center p-4 bg-base-200 rounded-lg"},rs={class:"text-xl font-bold text-success"},cs={class:"text-center p-4 bg-base-200 rounded-lg"},us={class:"text-xl font-bold"},hs={__name:"AdminDashboardView",setup(k){K();const r=Q(),g=S("overview"),y=S(null),_=S(!1),h=p(()=>r.loading),M=p(()=>r.error),m=p(()=>{const d=r.activityLogs,e=r.userSessions,a=r.stationStats;return{totalStations:a.length,activeStations:a.filter(n=>n.total_activity>0).length,inactiveStations:a.filter(n=>n.total_activity===0).length,totalUsers:e.length,activeUsers:e.filter(n=>n.last_login).length,neverLoggedIn:e.filter(n=>!n.last_login).length,totalOperations:d.length,creates:d.filter(n=>{var o;return((o=n.action)==null?void 0:o.toLowerCase())==="create"}).length,updates:d.filter(n=>{var o;return((o=n.action)==null?void 0:o.toLowerCase())==="update"}).length,deletes:d.filter(n=>{var o;return((o=n.action)==null?void 0:o.toLowerCase())==="delete"}).length}}),V=p(()=>r.weeklyActivity),w=p(()=>r.monthlyTrend.slice(-12)),E=p(()=>{const d=r.peakUsageHours,e=Math.max(...d.map(a=>a.count),1);return d.map(a=>({...a,percentage:a.count/e*100}))}),H=p(()=>r.activityByStation.map(d=>{const e=d.activities.length,a=d.activities.filter(n=>{const o=new Date(n.created_at),i=new Date(Date.now()-7*24*60*60*1e3);return o>=i}).length;return{...d,total:e,lastWeek:a,trend:a>e/4?"up":a<e/8?"down":"stable"}}).sort((d,e)=>e.total-d.total)),j=p(()=>r.userSessions.map(d=>{const e=d.last_login?Math.floor((Date.now()-new Date(d.last_login))/864e5):1/0;return{...d,daysSinceLogin:e,status:d.last_login?e>30?"inactive":e>7?"occasional":"active":"never"}}));function F(d){return d?new Date(d).toLocaleDateString("sv-SE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}function W(d){return d?new Date(d).toLocaleDateString("sv-SE",{month:"short",day:"numeric"}):"-"}function T(d){switch(d){case"active":return"text-success";case"occasional":return"text-info";case"inactive":return"text-warning";case"never":return"text-error";default:return"text-base-content"}}function I(d){switch(d){case"up":return"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6";case"down":return"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6";default:return"M4 12h16"}}function q(d){switch(d){case"up":return"text-success";case"down":return"text-error";default:return"text-base-content/50"}}function B(d){y.value=d,_.value=!0}async function $(){await r.fetchAllAdminData()}function U(d){r.setTimeRange(d)}return G(()=>{$()}),(d,e)=>{var a,n,o,i;return u(),c("div",X,[t("div",Z,[e[10]||(e[10]=t("div",null,[t("h1",{class:"text-2xl font-bold"},"Admin Dashboard"),t("p",{class:"text-base-content/60"},"Station activity, user analytics, and usage trends")],-1)),t("div",tt,[t("div",et,[t("button",{class:x(["tab",{"tab-active":v(r).timeRange==="week"}]),onClick:e[0]||(e[0]=s=>U("week"))}," Week ",2),t("button",{class:x(["tab",{"tab-active":v(r).timeRange==="month"}]),onClick:e[1]||(e[1]=s=>U("month"))}," Month ",2),t("button",{class:x(["tab",{"tab-active":v(r).timeRange==="year"}]),onClick:e[2]||(e[2]=s=>U("year"))}," Year ",2)]),t("button",{class:"btn btn-primary btn-sm",onClick:$,disabled:h.value},[h.value?(u(),c("span",at)):(u(),c("svg",nt,[...e[9]||(e[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])]))],8,st)])]),M.value?(u(),c("div",ot,[e[11]||(e[11]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,l(M.value),1)])):f("",!0),t("div",lt,[t("button",{class:x(["tab",{"tab-active":g.value==="overview"}]),onClick:e[3]||(e[3]=s=>g.value="overview")}," Overview ",2),t("button",{class:x(["tab",{"tab-active":g.value==="activity"}]),onClick:e[4]||(e[4]=s=>g.value="activity")}," Station Activity ",2),t("button",{class:x(["tab",{"tab-active":g.value==="users"}]),onClick:e[5]||(e[5]=s=>g.value="users")}," User Logins ",2),t("button",{class:x(["tab",{"tab-active":g.value==="trends"}]),onClick:e[6]||(e[6]=s=>g.value="trends")}," Trends & Analytics ",2)]),h.value?(u(),c("div",it,[...e[12]||(e[12]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):(u(),c(D,{key:2},[R(t("div",dt,[t("div",rt,[t("div",ct,[e[13]||(e[13]=t("div",{class:"stat-title"},"Total Stations",-1)),t("div",ut,l(m.value.totalStations),1),t("div",vt,l(m.value.activeStations)+" active",1)]),t("div",gt,[e[14]||(e[14]=t("div",{class:"stat-title"},"Total Users",-1)),t("div",ht,l(m.value.totalUsers),1),t("div",mt,l(m.value.activeUsers)+" logged in",1)]),t("div",pt,[e[17]||(e[17]=t("div",{class:"stat-title"},"Total Operations",-1)),t("div",_t,l(m.value.totalOperations),1),t("div",bt,[t("span",xt,"+"+l(m.value.creates),1),e[15]||(e[15]=N(" / ",-1)),t("span",ft,"~"+l(m.value.updates),1),e[16]||(e[16]=N(" / ",-1)),t("span",yt,"-"+l(m.value.deletes),1)])]),t("div",wt,[e[18]||(e[18]=t("div",{class:"stat-title"},"Attention Needed",-1)),t("div",{class:x(["stat-value",m.value.inactiveStations+m.value.neverLoggedIn>0?"text-warning":"text-success"])},l(m.value.inactiveStations+m.value.neverLoggedIn),3),t("div",kt,l(m.value.inactiveStations)+" stations, "+l(m.value.neverLoggedIn)+" users",1)])]),t("div",St,[t("div",Dt,[e[19]||(e[19]=t("h2",{class:"card-title"},"Weekly Activity",-1)),t("div",At,[(u(!0),c(D,null,L(V.value,s=>(u(),c("div",{key:s.day,class:"flex-1 flex flex-col items-center"},[t("div",Lt,[s.creates>0?(u(),c("div",{key:0,class:"bg-success rounded-t",style:C({height:Math.max(s.creates*4,2)+"px"}),title:s.creates+" creates"},null,12,Ct)):f("",!0),s.updates>0?(u(),c("div",{key:1,class:"bg-info",style:C({height:Math.max(s.updates*4,2)+"px"}),title:s.updates+" updates"},null,12,Mt)):f("",!0),s.deletes>0?(u(),c("div",{key:2,class:"bg-error",style:C({height:Math.max(s.deletes*4,2)+"px"}),title:s.deletes+" deletes"},null,12,Tt)):f("",!0),s.logins>0?(u(),c("div",{key:3,class:"bg-primary rounded-b",style:C({height:Math.max(s.logins*4,2)+"px"}),title:s.logins+" logins"},null,12,Ut)):f("",!0)]),t("div",Ht,l(s.day),1)]))),128))]),e[20]||(e[20]=J('<div class="flex justify-center gap-4 mt-4"><span class="flex items-center gap-1 text-xs"><span class="w-3 h-3 bg-success rounded"></span> Creates </span><span class="flex items-center gap-1 text-xs"><span class="w-3 h-3 bg-info rounded"></span> Updates </span><span class="flex items-center gap-1 text-xs"><span class="w-3 h-3 bg-error rounded"></span> Deletes </span><span class="flex items-center gap-1 text-xs"><span class="w-3 h-3 bg-primary rounded"></span> Logins </span></div>',1))])]),t("div",jt,[t("div",It,[e[24]||(e[24]=t("h2",{class:"card-title"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),N(" Attention Required ")],-1)),t("div",qt,[v(r).neverLoggedInUsers.length>0?(u(),c("div",Bt,[e[21]||(e[21]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),t("div",null,[t("h3",$t,l(v(r).neverLoggedInUsers.length)+" user(s) have never logged in",1),t("div",Rt,l(v(r).neverLoggedInUsers.map(s=>s.username).join(", ")),1)])])):f("",!0),v(r).leastActiveStations.length>0?(u(),c("div",zt,[e[22]||(e[22]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("div",null,[t("h3",Nt,l(v(r).leastActiveStations.length)+" station(s) with no recent activity",1),t("div",Ot,l(v(r).leastActiveStations.map(s=>s.station_acronym||s.acronym).join(", ")),1)])])):f("",!0),v(r).neverLoggedInUsers.length===0&&v(r).leastActiveStations.length===0?(u(),c("div",Vt,[...e[23]||(e[23]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("span",null,"All systems operational. No issues detected.",-1)])])):f("",!0)])])])],512),[[z,g.value==="overview"]]),R(t("div",Et,[t("div",Ft,[t("div",Wt,[e[27]||(e[27]=t("h2",{class:"card-title"},"Station Activity & Connection History",-1)),e[28]||(e[28]=t("p",{class:"text-sm text-base-content/60"},"Track when stations connect and perform CRUD operations",-1)),t("div",Pt,[t("table",Yt,[e[26]||(e[26]=t("thead",null,[t("tr",null,[t("th",null,"Station"),t("th",null,"Creates"),t("th",null,"Updates"),t("th",null,"Deletes"),t("th",null,"Last Week"),t("th",null,"Total"),t("th",null,"Trend"),t("th")])],-1)),t("tbody",null,[(u(!0),c(D,null,L(H.value,s=>(u(),c("tr",{key:s.station_id},[t("td",null,[t("div",Gt,l(s.station_acronym),1)]),t("td",null,[t("span",Jt,l(s.create_count),1)]),t("td",null,[t("span",Kt,l(s.update_count),1)]),t("td",null,[t("span",Qt,l(s.delete_count),1)]),t("td",null,l(s.lastWeek),1),t("td",null,[t("span",Xt,l(s.total),1)]),t("td",null,[(u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",class:x(["h-5 w-5",q(s.trend)]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:I(s.trend)},null,8,Zt)],2))]),t("td",null,[t("button",{class:"btn btn-ghost btn-xs",onClick:b=>B(s)}," Details ",8,te)])]))),128)),H.value.length===0?(u(),c("tr",ee,[...e[25]||(e[25]=[t("td",{colspan:"8",class:"text-center text-base-content/60"},"No activity data available",-1)])])):f("",!0)])])])])])],512),[[z,g.value==="activity"]]),R(t("div",se,[t("div",ae,[t("div",ne,[e[31]||(e[31]=t("h2",{class:"card-title"},"User Login Activity",-1)),e[32]||(e[32]=t("p",{class:"text-sm text-base-content/60"},"Track user connections and identify inactive accounts",-1)),t("div",oe,[t("table",le,[e[30]||(e[30]=t("thead",null,[t("tr",null,[t("th",null,"User"),t("th",null,"Role"),t("th",null,"Station"),t("th",null,"Last Login"),t("th",null,"Days Since"),t("th",null,"Login Count"),t("th",null,"Status")])],-1)),t("tbody",null,[(u(!0),c(D,null,L(j.value,s=>(u(),c("tr",{key:s.id,class:x({"bg-warning/10":s.status==="never"})},[t("td",null,[t("div",ie,l(s.username),1)]),t("td",null,[t("span",de,l(s.role),1)]),t("td",null,l(s.station_acronym||"-"),1),t("td",re,l(F(s.last_login)),1),t("td",{class:x(T(s.status))},l(s.status==="never"?"Never":s.daysSinceLogin+" days"),3),t("td",null,l(s.login_count||0),1),t("td",null,[t("span",{class:x(["badge badge-sm",{"badge-success":s.status==="active","badge-info":s.status==="occasional","badge-warning":s.status==="inactive","badge-error":s.status==="never"}])},l(s.status==="never"?"Never logged in":s.status),3)])],2))),128)),j.value.length===0?(u(),c("tr",ce,[...e[29]||(e[29]=[t("td",{colspan:"7",class:"text-center text-base-content/60"},"No user data available",-1)])])):f("",!0)])])])])])],512),[[z,g.value==="users"]]),R(t("div",ue,[t("div",ve,[t("div",ge,[e[37]||(e[37]=t("h2",{class:"card-title"},"Monthly Usage Trend",-1)),e[38]||(e[38]=t("p",{class:"text-sm text-base-content/60"},"Long-term activity patterns over the past year",-1)),t("div",he,[t("div",me,[(u(!0),c(D,null,L(w.value,s=>(u(),c("div",{key:s.month,class:"flex flex-col items-center",style:{width:"60px"}},[t("div",pe,[t("div",{class:"bg-primary/80 rounded-t w-full",style:C({height:Math.max(s.total*2,4)+"px"})},null,4)]),t("div",_e,l(s.month),1),t("div",be,l(s.total),1)]))),128))])]),t("div",xe,[w.value.length>0?(u(),c(D,{key:0},[t("div",fe,[t("div",ye,l(((a=w.value[w.value.length-1])==null?void 0:a.unique_users)||0),1),e[33]||(e[33]=t("div",{class:"text-xs text-base-content/60"},"Unique Users (Last Month)",-1))]),t("div",we,[t("div",ke,l(((n=w.value[w.value.length-1])==null?void 0:n.unique_stations)||0),1),e[34]||(e[34]=t("div",{class:"text-xs text-base-content/60"},"Active Stations (Last Month)",-1))]),t("div",Se,[t("div",De,l(Math.round(w.value.reduce((s,b)=>s+b.total,0)/w.value.length)),1),e[35]||(e[35]=t("div",{class:"text-xs text-base-content/60"},"Avg. Monthly Operations",-1))]),t("div",Ae,[t("div",Le,l(w.value.reduce((s,b)=>s+b.total,0)),1),e[36]||(e[36]=t("div",{class:"text-xs text-base-content/60"},"Total Operations (Year)",-1))])],64)):f("",!0)])])]),t("div",Ce,[t("div",Me,[e[39]||(e[39]=t("h2",{class:"card-title"},"Peak Usage Hours",-1)),e[40]||(e[40]=t("p",{class:"text-sm text-base-content/60"},"Identify when the platform is most frequently used",-1)),t("div",Te,[(u(!0),c(D,null,L(E.value,s=>(u(),c("div",{key:s.hour,class:"flex-1 flex flex-col items-center"},[t("div",{class:"w-full bg-primary/70 hover:bg-primary transition-colors rounded-t cursor-pointer",style:C({height:s.percentage+"%",minHeight:s.count>0?"4px":"0"}),title:s.label+": "+s.count+" operations"},null,12,Ue)]))),128))]),e[41]||(e[41]=t("div",{class:"flex justify-between text-xs text-base-content/60 px-1"},[t("span",null,"00:00"),t("span",null,"06:00"),t("span",null,"12:00"),t("span",null,"18:00"),t("span",null,"24:00")],-1))])]),t("div",He,[t("div",je,[e[42]||(e[42]=t("h2",{class:"card-title"},"Most Active Stations",-1)),t("div",Ie,[(u(!0),c(D,null,L(v(r).mostActiveStations.slice(0,5),(s,b)=>{var A;return u(),c("div",{key:s.station_id,class:"flex items-center gap-4"},[t("div",qe,l(b+1),1),t("div",Be,[t("div",$e,l(s.station_acronym||s.acronym),1),t("div",Re,l(s.total_activity||s.total||0)+" operations",1)]),t("div",ze,[t("div",{class:"bg-primary h-2 rounded-full",style:C({width:Math.min((s.total_activity||s.total||0)/(((A=v(r).mostActiveStations[0])==null?void 0:A.total_activity)||1)*100,100)+"%"})},null,4)])])}),128))])])])],512),[[z,g.value==="trends"]])],64)),t("dialog",{class:x({"modal modal-open":_.value,modal:!_.value})},[t("div",Ne,[t("h3",Oe,l((o=y.value)==null?void 0:o.station_acronym)+" Activity Details ",1),y.value?(u(),c("div",Ve,[t("div",Ee,[t("div",Fe,[e[43]||(e[43]=t("div",{class:"stat-title"},"Creates",-1)),t("div",We,l(y.value.create_count),1)]),t("div",Pe,[e[44]||(e[44]=t("div",{class:"stat-title"},"Updates",-1)),t("div",Ye,l(y.value.update_count),1)]),t("div",Ge,[e[45]||(e[45]=t("div",{class:"stat-title"},"Deletes",-1)),t("div",Je,l(y.value.delete_count),1)])]),e[47]||(e[47]=t("div",{class:"divider"},"Recent Activity",-1)),t("div",Ke,[t("table",Qe,[e[46]||(e[46]=t("thead",null,[t("tr",null,[t("th",null,"Action"),t("th",null,"Entity"),t("th",null,"Date"),t("th",null,"User")])],-1)),t("tbody",null,[(u(!0),c(D,null,L((i=y.value.activities)==null?void 0:i.slice(0,20),s=>(u(),c("tr",{key:s.id},[t("td",null,[t("span",{class:x(["badge badge-xs",{"badge-success":s.action==="create","badge-info":s.action==="update","badge-error":s.action==="delete"}])},l(s.action),3)]),t("td",null,l(s.entity_type),1),t("td",Xe,l(W(s.created_at)),1),t("td",null,l(s.username||"-"),1)]))),128))])])])])):f("",!0),t("div",Ze,[t("button",{class:"btn",onClick:e[7]||(e[7]=s=>_.value=!1)},"Close")])]),t("form",ts,[t("button",{onClick:e[8]||(e[8]=s=>_.value=!1)},"close")])],2),v(r).systemHealth?(u(),c("div",es,[e[54]||(e[54]=t("input",{type:"checkbox"},null,-1)),t("div",ss,[t("div",as,[e[48]||(e[48]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1)),e[49]||(e[49]=N(" System Health ",-1)),t("span",{class:x(["badge badge-sm",v(r).systemHealth.status==="healthy"?"badge-success":"badge-error"])},l(v(r).systemHealth.status),3)])]),t("div",ns,[t("div",os,[t("div",ls,[t("div",is,l(v(r).systemHealth.version),1),e[50]||(e[50]=t("div",{class:"text-sm text-base-content/60"},"Version",-1))]),t("div",ds,[t("div",rs,l(v(r).systemHealth.database),1),e[51]||(e[51]=t("div",{class:"text-sm text-base-content/60"},"Database",-1))]),t("div",cs,[t("div",us,l(v(r).systemHealth.architecture),1),e[52]||(e[52]=t("div",{class:"text-sm text-base-content/60"},"Architecture",-1))]),e[53]||(e[53]=t("div",{class:"text-center p-4 bg-base-200 rounded-lg"},[t("div",{class:"text-xl font-bold"},"v10"),t("div",{class:"text-sm text-base-content/60"},"API Version")],-1))])])])):f("",!0)])}}};export{hs as default};
