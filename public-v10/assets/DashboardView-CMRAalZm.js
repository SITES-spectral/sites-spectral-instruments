import{c as M,b as nt,s as Z,o as l,w as st,f as t,n as N,e as d,k as L,t as p,F as D,h as X,i as j,a as at,r as P,m as lt,E as pt,p as U,G as ft,j as rt,g as vt,C as et,H as ot,I as ht,l as z}from"./vendor-DjAAf7Gn.js";import{a as gt,b as xt,c as yt,u as bt,d as wt}from"./index-B1FJXpl_.js";import{g as kt}from"./InstrumentIcon.vue_vue_type_style_index_0_scoped_cbf9e092_lang-DF2AECOp.js";import{L as C}from"./leaflet-src-DUdEndMj.js";import{_ as _t}from"./PlatformFormModal-CsX2_aA1.js";import{_ as Mt}from"./ExportModal-DAT02HFn.js";const $t={class:"flex items-start justify-between gap-3"},Pt={class:"flex-1 min-w-0"},St={class:"flex items-center gap-2"},zt={class:"card-title text-lg truncate"},Ct={class:"flex items-center gap-2 mt-1"},Lt={class:"badge badge-outline badge-sm font-mono"},Bt={key:0,class:"text-xs text-base-content/50 hidden sm:inline"},Vt={class:"flex-shrink-0"},At={key:0,class:"text-sm text-base-content/60 line-clamp-2 mt-2"},jt={class:"text-center"},Nt={class:"text-2xl font-bold text-primary"},Et={key:0,class:"flex justify-center gap-1 mt-1"},Ft=["title"],Ht={class:"text-center"},Ut={class:"text-2xl font-bold text-secondary"},It={key:0,class:"text-center"},Tt={class:"text-2xl font-bold text-accent"},Gt={class:"flex items-center justify-between mt-3 pt-2 text-xs text-base-content/50"},Dt={key:0,class:"truncate"},Ot={key:1},Zt={__name:"StationCard",props:{station:{type:Object,required:!0},compact:{type:Boolean,default:!1}},setup(f){const _=f,E=M(()=>kt(_.station.status)),i=M(()=>{const{latitude:w,longitude:h}=_.station;if(w&&h){const r=Number(w).toFixed(4),y=Number(h).toFixed(4);return`${r}°N, ${y}°E`}return null}),$=M(()=>{const w=[];return _.station.fixed_count&&w.push({type:"Fixed",count:_.station.fixed_count,color:"text-info"}),_.station.uav_count&&w.push({type:"UAV",count:_.station.uav_count,color:"text-warning"}),_.station.satellite_count&&w.push({type:"Satellite",count:_.station.satellite_count,color:"text-accent"}),w});return(w,h)=>{const r=nt("router-link");return l(),Z(r,{to:`/stations/${f.station.acronym}`,class:"card bg-base-100 shadow-md hover:shadow-xl transition-all duration-200 cursor-pointer border border-base-200 hover:border-primary/30"},{default:st(()=>[t("div",{class:N(["card-body",f.compact?"p-4":"p-5"])},[t("div",$t,[t("div",Pt,[t("div",St,[t("h3",zt,p(f.station.display_name),1)]),t("div",Ct,[t("span",Lt,p(f.station.acronym),1),i.value?(l(),d("span",Bt,p(i.value),1)):L("",!0)])]),t("div",Vt,[t("span",{class:N(["badge badge-sm",E.value.badgeClass])},p(f.station.status),3)])]),f.station.description&&!f.compact?(l(),d("p",At,p(f.station.description),1)):L("",!0),t("div",{class:N(["grid gap-2 mt-4 pt-4 border-t border-base-200",f.compact?"grid-cols-2":"grid-cols-3"])},[t("div",jt,[t("div",Nt,p(f.station.platform_count||0),1),h[0]||(h[0]=t("div",{class:"text-xs text-base-content/60"},"Platforms",-1)),$.value.length>0?(l(),d("div",Et,[(l(!0),d(D,null,X($.value,y=>(l(),d("span",{key:y.type,class:N(["text-xs",y.color]),title:y.type},p(y.count),11,Ft))),128))])):L("",!0)]),t("div",Ht,[t("div",Ut,p(f.station.instrument_count||0),1),h[1]||(h[1]=t("div",{class:"text-xs text-base-content/60"},"Instruments",-1))]),f.compact?L("",!0):(l(),d("div",It,[t("div",Tt,p(f.station.roi_count||0),1),h[2]||(h[2]=t("div",{class:"text-xs text-base-content/60"},"ROIs",-1))]))],2),t("div",Gt,[f.station.updated_at?(l(),d("span",Dt," Updated "+p(new Date(f.station.updated_at).toLocaleDateString()),1)):(l(),d("span",Ot)),h[3]||(h[3]=t("span",{class:"flex items-center gap-1 text-primary flex-shrink-0"},[j(" View details "),t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})])],-1))])],2)]),_:1},8,["to"])}}},Rt={class:"station-map-container rounded-lg overflow-hidden border border-base-300"},Kt={class:"absolute bottom-3 left-3 bg-base-100/90 rounded-lg p-2 shadow-md z-[1000]"},qt={class:"flex flex-wrap items-center gap-3 text-xs"},Qt={class:"absolute top-3 right-3 bg-base-100/90 rounded-lg px-3 py-1 shadow-md z-[1000]"},Wt={class:"text-sm font-medium"},Jt={__name:"StationMap",props:{stations:{type:Array,default:()=>[]},platforms:{type:Array,default:()=>[]},otherPlatforms:{type:Array,default:()=>[]},showPlatforms:{type:Boolean,default:!0},height:{type:[Number,String],default:400},clickable:{type:Boolean,default:!0},zoom:{type:Number,default:5},center:{type:Array,default:()=>[62,16]},selectedId:{type:[Number,String],default:null}},emits:["station-click","station-hover","platform-click"],setup(f,{expose:_,emit:E}){const i=f,$=E,w=at(),h=P(null);let r=null,y=[],B=[],I=new Map,g=[];const K=M(()=>({height:typeof i.height=="number"?`${i.height}px`:i.height}));function b(n,o=!1){const v=o?"#7c3aed":"#3b82f6",c=o?14:10;return C.divIcon({className:"station-marker",html:`
      <div style="
        width: ${c}px;
        height: ${c}px;
        background-color: ${v};
        border: 2px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        cursor: pointer;
      "></div>
    `,iconSize:[c,c],iconAnchor:[c/2,c/2]})}function S(n,o=!1){var Q,W;const v=((W=(Q=n.mount_type_code)==null?void 0:Q.match(/^([A-Z]+)/))==null?void 0:W[1])||"PL",V={PL:"#f97316",BL:"#14b8a6",GL:"#22c55e"}[v]||"#f97316",k=o?{left:4,right:4,bottom:8}:{left:6,right:6,bottom:12},G=o?.35:1,x=o?"none":"drop-shadow(0 2px 2px rgba(0,0,0,0.3))";return C.divIcon({className:o?"platform-marker-dimmed":"platform-marker",html:`
      <div style="
        width: 0;
        height: 0;
        border-left: ${k.left}px solid transparent;
        border-right: ${k.right}px solid transparent;
        border-bottom: ${k.bottom}px solid ${V};
        opacity: ${G};
        filter: ${x};
        cursor: ${o?"default":"pointer"};
      "></div>
    `,iconSize:[k.left*2,k.bottom],iconAnchor:[k.left,k.bottom]})}function T(n){var c,V,k,G;const o=((V=(c=n.mount_type_code)==null?void 0:c.match(/^([A-Z]+)/))==null?void 0:V[1])||"?",v={PL:"Tower/Mast",BL:"Building",GL:"Ground Level"};return`
    <div style="min-width: 200px; font-family: system-ui, sans-serif;">
      <div style="font-weight: 600; font-size: 13px; margin-bottom: 4px;">
        <code style="background: #f1f5f9; padding: 1px 4px; border-radius: 2px;">
          ${n.normalized_name||n.display_name}
        </code>
      </div>
      <div style="font-size: 12px; color: #666; margin-bottom: 4px;">
        ${n.display_name||""}
      </div>
      <div style="font-size: 11px; color: #888; margin-bottom: 4px;">
        <strong>Mount:</strong> ${v[o]||o} (${n.mount_type_code||"?"})
      </div>
      <div style="font-size: 11px; color: #888; margin-bottom: 4px;">
        <strong>Ecosystem:</strong> ${n.ecosystem_code||"N/A"}
      </div>
      <div style="font-size: 11px; color: #888;">
        ${((k=n.latitude)==null?void 0:k.toFixed(5))||"?"}, ${((G=n.longitude)==null?void 0:G.toFixed(5))||"?"}
      </div>
    </div>
  `}function F(n){var v,c;const o=n.status==="Active"?"color: #22c55e":"color: #ef4444";return`
    <div style="min-width: 180px; font-family: system-ui, sans-serif;">
      <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">
        ${n.display_name||n.acronym}
      </div>
      <div style="font-size: 12px; color: #666; margin-bottom: 8px;">
        <code style="background: #f1f5f9; padding: 1px 4px; border-radius: 2px;">
          ${n.acronym}
        </code>
      </div>
      <div style="font-size: 12px; margin-bottom: 4px;">
        <span style="${o}">●</span> ${n.status||"Unknown"}
      </div>
      <div style="font-size: 11px; color: #888;">
        ${((v=n.latitude)==null?void 0:v.toFixed(4))||"?"}, ${((c=n.longitude)==null?void 0:c.toFixed(4))||"?"}
      </div>
    </div>
  `}function Y(){!h.value||r||(r=C.map(h.value,{center:i.center,zoom:i.zoom,zoomControl:!0,attributionControl:!0}),C.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:18}).addTo(r),O())}function O(){if(!r)return;y.forEach(o=>r.removeLayer(o)),y=[],i.stations.forEach(o=>{if(o.latitude==null||o.longitude==null)return;const v=o.id===i.selectedId,c=C.marker([o.latitude,o.longitude],{icon:b(o,v)});c.bindPopup(F(o)),c.on("click",()=>{$("station-click",o),i.clickable&&w.push({name:"station",params:{acronym:o.acronym}})}),c.on("mouseover",()=>{$("station-hover",o),c.openPopup()}),c.addTo(r),y.push(c)}),H();const n=[...y,...B];if(n.length>0){const o=C.featureGroup(n);r.fitBounds(o.getBounds().pad(.2))}}function H(){r&&(B.forEach(n=>r.removeLayer(n)),B=[],I.clear(),i.showPlatforms&&i.platforms.forEach(n=>{if(n.latitude==null||n.longitude==null||n.platform_type!=="fixed")return;const o=C.marker([n.latitude,n.longitude],{icon:S(n,!1)});o.bindPopup(T(n)),o.on("click",()=>{$("platform-click",n),i.clickable&&w.push({name:"platform",params:{id:n.id}})}),o.on("mouseover",()=>{o.openPopup()}),o.addTo(r),B.push(o),I.set(n.id,o)}))}function q(){var n;r&&(g.forEach(o=>r.removeLayer(o)),g=[],!(!i.showPlatforms||!((n=i.otherPlatforms)!=null&&n.length))&&i.otherPlatforms.forEach(o=>{if(o.latitude==null||o.longitude==null||o.platform_type!=="fixed")return;const v=C.marker([o.latitude,o.longitude],{icon:S(o,!0)});v.bindPopup(`
      <div style="min-width: 150px; font-family: system-ui, sans-serif; opacity: 0.8;">
        <div style="font-weight: 500; font-size: 12px; color: #888;">
          <code style="background: #f1f5f9; padding: 1px 4px; border-radius: 2px;">
            ${o.normalized_name||o.display_name}
          </code>
        </div>
        <div style="font-size: 11px; color: #aaa; margin-top: 4px;">
          Other station platform
        </div>
      </div>
    `),v.on("mouseover",()=>{v.openPopup()}),v.addTo(r),g.push(v)}))}function tt(){r&&(r.remove(),r=null,y=[],B=[],I.clear(),g=[])}return lt(()=>{Y()}),pt(()=>{tt()}),U(()=>i.stations,O,{deep:!0}),U(()=>i.selectedId,O),U(()=>i.platforms,H,{deep:!0}),U(()=>i.showPlatforms,()=>{H(),q()}),U(()=>i.otherPlatforms,q,{deep:!0}),U(()=>i.center,n=>{r&&r.setView(n,i.zoom)}),_({fitBounds:()=>{const n=[...y,...B,...g];if(r&&n.length>0){const o=C.featureGroup(n);r.fitBounds(o.getBounds().pad(.2))}},setView:(n,o)=>{r&&r.setView(n,o||i.zoom)},highlightPlatform:n=>{if(!r||!n)return;const o=typeof n=="string"?parseInt(n,10):n,v=I.get(n)||I.get(o);if(!v)return;const c=i.platforms.find(V=>V.id===n||V.id===o);!c||c.latitude==null||c.longitude==null||(r.setView([c.latitude,c.longitude],14,{animate:!0}),v.openPopup())},clearHighlight:()=>{if(r){r.closePopup();const n=[...y,...B,...g];if(n.length>0){const o=C.featureGroup(n);r.fitBounds(o.getBounds().pad(.2),{animate:!0})}}}}),(n,o)=>(l(),d("div",Rt,[t("div",{ref_key:"mapContainer",ref:h,class:"w-full",style:ft(K.value)},null,4),t("div",Kt,[t("div",qt,[o[1]||(o[1]=t("div",{class:"flex items-center gap-1"},[t("span",{class:"w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow"}),t("span",null,"Station")],-1)),o[2]||(o[2]=t("div",{class:"flex items-center gap-1"},[t("span",{class:"w-3.5 h-3.5 bg-purple-500 rounded-full border-2 border-white shadow"}),t("span",null,"Selected")],-1)),f.showPlatforms&&f.platforms.length>0?(l(),d(D,{key:0},[o[0]||(o[0]=rt('<span class="text-base-content/40" data-v-745c5481>|</span><div class="flex items-center gap-1" data-v-745c5481><span class="inline-block w-0 h-0 border-l-[5px] border-r-[5px] border-b-[9px] border-l-transparent border-r-transparent border-b-orange-500" data-v-745c5481></span><span data-v-745c5481>Tower</span></div><div class="flex items-center gap-1" data-v-745c5481><span class="inline-block w-0 h-0 border-l-[5px] border-r-[5px] border-b-[9px] border-l-transparent border-r-transparent border-b-teal-500" data-v-745c5481></span><span data-v-745c5481>Building</span></div><div class="flex items-center gap-1" data-v-745c5481><span class="inline-block w-0 h-0 border-l-[5px] border-r-[5px] border-b-[9px] border-l-transparent border-r-transparent border-b-green-500" data-v-745c5481></span><span data-v-745c5481>Ground</span></div>',4))],64)):L("",!0)])]),t("div",Qt,[t("span",Wt,p(f.stations.length)+" station"+p(f.stations.length!==1?"s":""),1)])]))}},Xt=gt(Jt,[["__scopeId","data-v-745c5481"]]),Yt={class:"flex items-start justify-between mb-6"},te={class:"text-base-content/60"},ee={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8"},se={class:"stat bg-base-100 rounded-lg shadow"},oe={class:"stat-value text-primary"},ne={class:"stat-desc"},ae={class:"stat bg-base-100 rounded-lg shadow"},le={class:"stat-value text-secondary"},re={class:"stat bg-base-100 rounded-lg shadow"},ie={class:"stat-value text-accent"},de={class:"bg-base-100 rounded-lg shadow-lg p-4 mb-8"},ue={class:"flex items-center justify-between mb-4"},ce={class:"flex items-center gap-4"},me={class:"label cursor-pointer gap-2"},pe=["disabled"],fe={key:0,class:"loading loading-spinner loading-xs"},ve={class:"label cursor-pointer gap-2"},he={key:1,class:"h-[350px] flex items-center justify-center bg-base-200 rounded-lg"},ge={key:2,class:"h-[350px] flex items-center justify-center bg-base-200 rounded-lg text-base-content/60"},xe={key:0,class:"flex justify-center py-12"},ye={key:1,class:"alert alert-error"},be={key:2},we={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4"},ke={class:"text-lg font-semibold flex items-center gap-2"},_e={class:"flex gap-2"},Me={class:"tabs tabs-boxed bg-base-200 p-1 mb-4 inline-flex"},$e=["onClick"],Pe={xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Se=["d"],ze={key:0,class:"flex justify-center py-8"},Ce={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Le={class:"card-body p-4"},Be={class:"flex items-start gap-3"},Ve=["title"],Ae=["d"],je={class:"flex-1 min-w-0"},Ne={class:"font-semibold text-sm truncate font-mono"},Ee={class:"text-xs text-base-content/60 truncate"},Fe={class:"flex items-center gap-1 mt-2"},He={class:"text-xs font-medium"},Ue={key:0,class:"col-span-full text-center py-8 text-base-content/50"},Ie={key:3},Te={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},qe={__name:"DashboardView",setup(f){const _=P(!0),E=P(!1),i=P([]),$=P(!1),w=P(null),h=P(!1),r=wt();function y(s){r.success(`Exported ${s.type} as ${s.format.toUpperCase()}`)}function B(s){var e;s.platform_type==="fixed"&&s.latitude&&s.longitude&&((e=w.value)==null||e.highlightPlatform(s.id))}function I(){var s;(s=w.value)==null||s.clearHighlight()}at();const g=xt(),K=yt(),b=bt(),S=P([]),T=P(!1),F=P("all"),Y=M(()=>{const s={all:S.value.length,fixed:0,uav:0,satellite:0};return S.value.forEach(e=>{s[e.platform_type]!==void 0&&s[e.platform_type]++}),[{key:"all",label:"All",count:s.all,icon:"M4 6h16M4 12h16M4 18h16"},{key:"fixed",label:"Fixed",count:s.fixed,icon:"M12 2v20M8 22h8M8 6l4 16 4-16M10 12h4"},{key:"uav",label:"UAV",count:s.uav,icon:"M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0-6 0M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"},{key:"satellite",label:"Satellite",count:s.satellite,icon:"M13 7L9 3 5 7l4 4M17 11l4 4-4 4-4-4M8 12l4 4 4-4-4-4-4 4zM16 8l3-3M5 16l3 3"}].filter(e=>e.key==="all"||e.count>0)}),O=M(()=>F.value==="all"?S.value:S.value.filter(s=>s.platform_type===F.value)),H=P(!1),q=M(()=>x.value?b.canEditStation(x.value.id):!1);function tt(){H.value=!0}async function n(s){if(await K.createPlatform(s)){if(r.success("Platform created successfully"),H.value=!1,x.value){T.value=!0;try{const u=await fetch(`/api/v11/platforms/station/${x.value.id}`);if(u.ok){const m=await u.json();S.value=m.data||[]}await v(x.value.id)}finally{T.value=!1}}}else r.error(K.error||"Failed to create platform")}const o=P([]);lt(async()=>{await g.fetchStations()});async function v(s){if(!s){o.value=[];return}try{const e=await fetch(`/api/v11/platforms/station/${s}`);if(e.ok){const u=await e.json();o.value=(u.data||[]).filter(m=>m.platform_type==="fixed"&&m.latitude!=null&&m.longitude!=null)}}catch(e){console.error("Failed to load platforms for station:",e),o.value=[]}}async function c(){if(!$.value){$.value=!0;try{const s=await fetch("/api/v11/platforms?limit=500");if(s.ok){const e=await s.json();i.value=(e.data||[]).filter(u=>u.platform_type==="fixed"&&u.latitude!=null&&u.longitude!=null)}}catch(s){console.error("Failed to load all platforms:",s),i.value=[]}finally{$.value=!1}}}const V=M(()=>E.value?x.value?i.value.filter(s=>s.station_id!==x.value.id):i.value:[]);U(E,async s=>{s&&i.value.length===0&&await c()});const k=M(()=>{var e,u;if(b.isAdmin)return g.stations;let s=null;if((e=b.user)!=null&&e.station_normalized_name?s=b.user.station_normalized_name:b.isStationAdmin&&b.userStationFromUsername?s=b.userStationFromUsername:b.isStationUser&&((u=b.user)!=null&&u.username)&&(s=b.user.username),s){const m=s.toLowerCase();return g.stations.filter(A=>{var R,a;return((R=A.normalized_name)==null?void 0:R.toLowerCase())===m||((a=A.acronym)==null?void 0:a.toLowerCase())===m})}return g.stations}),G=M(()=>!b.isAdmin&&k.value.length===1),x=M(()=>G.value?k.value[0]:null);U(x,async s=>{if(s){T.value=!0;try{const e=await fetch(`/api/v11/platforms/station/${s.id}`);if(e.ok){const u=await e.json();S.value=u.data||[]}await v(s.id)}catch(e){console.error("Failed to load platforms:",e)}finally{T.value=!1}}},{immediate:!0});function Q(s){const e={fixed:"M12 2v20M8 22h8M8 6l4 16 4-16M10 12h4",uav:"M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0-6 0M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83",satellite:"M13 7L9 3 5 7l4 4M17 11l4 4-4 4-4-4M8 12l4 4 4-4-4-4-4 4zM16 8l3-3M5 16l3 3",mobile:"M8 17h.01M14 17h.01M8 17a2 2 0 11-4 0 2 2 0 014 0zm8 0a2 2 0 11-4 0 2 2 0 014 0zM5 17H3v-4a1 1 0 011-1h1V9a1 1 0 011-1h8a1 1 0 011 1v3h2a1 1 0 011 1v4h-2",usv:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",uuv:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"};return e[s]||e.fixed}function W(s){if(s.platform_type==="fixed"&&s.mount_type_code){const e=ut(s.mount_type_code);if(e)return e}return Q(s.platform_type)}function it(s){var u;if(s.platform_type==="fixed"&&s.mount_type_code){const m=(u=s.mount_type_code.match(/^([A-Z]+)/))==null?void 0:u[1];return{PL:"bg-info/10",BL:"bg-secondary/10",GL:"bg-success/10"}[m]||"bg-primary/10"}return{uav:"bg-warning/10",satellite:"bg-accent/10",mobile:"bg-neutral/10"}[s.platform_type]||"bg-primary/10"}function dt(s){var u;if(s.platform_type==="fixed"&&s.mount_type_code){const m=(u=s.mount_type_code.match(/^([A-Z]+)/))==null?void 0:u[1];return{PL:"text-info",BL:"text-secondary",GL:"text-success"}[m]||"text-primary"}return{uav:"text-warning",satellite:"text-accent",mobile:"text-neutral"}[s.platform_type]||"text-primary"}function ut(s){var m;if(!s)return null;const e=(m=s.match(/^([A-Z]+)/))==null?void 0:m[1];return{PL:"M12 2v20M8 22h8M8 6l4 16 4-16M10 12h4",BL:"M3 21h18M5 21V8l7-6 7 6v13M9 12h2v2H9M13 12h2v2h-2M11 21v-4h2v4",GL:"M12 22v-7M12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8M12 7V4M8 9l-2-2M16 9l2-2"}[e]||null}const ct=M(()=>{var e,u;const s=(e=b.user)==null?void 0:e.station_normalized_name;if(s&&!b.isAdmin){const m=g.stations.find(A=>A.normalized_name===s);if(m!=null&&m.display_name)return m.display_name}return((u=b.user)==null?void 0:u.username)||"User"}),J=M(()=>{const s=k.value;let e=0,u=0;return s.forEach(m=>{e+=m.platform_count||0,u+=m.instrument_count||0}),{stations:s.length,platforms:e,instruments:u,active:s.filter(m=>m.status==="Active").length}});return(s,e)=>{var m,A,R;const u=nt("router-link");return l(),d("div",null,[t("div",Yt,[t("div",null,[e[5]||(e[5]=t("h1",{class:"text-2xl font-bold"},"Dashboard",-1)),t("p",te," Welcome back, "+p(ct.value),1)]),t("button",{class:"btn btn-outline btn-sm",onClick:e[0]||(e[0]=a=>h.value=!0)},[...e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),j(" Export Data ",-1)])])]),t("div",ee,[t("div",se,[e[7]||(e[7]=t("div",{class:"stat-figure text-primary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})])],-1)),e[8]||(e[8]=t("div",{class:"stat-title"},"Stations",-1)),t("div",oe,p(J.value.stations),1),t("div",ne,p(J.value.active)+" active",1)]),t("div",ae,[e[9]||(e[9]=t("div",{class:"stat-figure text-secondary"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),e[10]||(e[10]=t("div",{class:"stat-title"},"Platforms",-1)),t("div",le,p(J.value.platforms),1),e[11]||(e[11]=t("div",{class:"stat-desc"},"Fixed, UAV, Satellite",-1))]),t("div",re,[e[12]||(e[12]=t("div",{class:"stat-figure text-accent"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})])],-1)),e[13]||(e[13]=t("div",{class:"stat-title"},"Instruments",-1)),t("div",ie,p(J.value.instruments),1),e[14]||(e[14]=t("div",{class:"stat-desc"},"Across all platforms",-1))]),e[15]||(e[15]=rt('<div class="stat bg-base-100 rounded-lg shadow"><div class="stat-figure text-info"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="stat-title">Status</div><div class="stat-value text-info">OK</div><div class="stat-desc">All systems operational</div></div>',1))]),t("div",de,[t("div",ue,[e[18]||(e[18]=t("h2",{class:"text-lg font-semibold flex items-center gap-2"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})]),j(" Station Locations ")],-1)),t("div",ce,[t("label",me,[e[16]||(e[16]=t("span",{class:"label-text text-xs text-base-content/60"},"Show all platforms",-1)),et(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>E.value=a),type:"checkbox",class:"toggle toggle-xs",disabled:$.value},null,8,pe),[[ot,E.value]]),$.value?(l(),d("span",fe)):L("",!0)]),t("label",ve,[e[17]||(e[17]=t("span",{class:"label-text text-sm"},"Show map",-1)),et(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>_.value=a),type:"checkbox",class:"toggle toggle-primary toggle-sm"},null,512),[[ot,_.value]])])])]),et(t("div",null,[!z(g).loading&&z(g).stations.length>0?(l(),Z(z(Xt),{key:0,ref_key:"stationMapRef",ref:w,stations:z(g).stations,platforms:o.value,"other-platforms":V.value,"show-platforms":!0,height:350,clickable:!0,"selected-id":(m=x.value)==null?void 0:m.id},null,8,["stations","platforms","other-platforms","selected-id"])):z(g).loading?(l(),d("div",he,[...e[19]||(e[19]=[t("span",{class:"loading loading-spinner loading-md"},null,-1)])])):(l(),d("div",ge," No stations to display "))],512),[[ht,_.value]])]),z(g).loading?(l(),d("div",xe,[...e[20]||(e[20]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):z(g).error?(l(),d("div",ye,[e[21]||(e[21]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,p(z(g).error),1)])):G.value?(l(),d("div",be,[t("div",we,[t("h2",ke,[e[22]||(e[22]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),j(" Quick Access - "+p(((A=x.value)==null?void 0:A.display_name)||((R=x.value)==null?void 0:R.acronym)),1)]),t("div",_e,[q.value?(l(),d("button",{key:0,class:"btn btn-primary btn-sm",onClick:tt},[...e[23]||(e[23]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),j(" Create Platform ",-1)])])):L("",!0),x.value?(l(),Z(u,{key:1,to:`/stations/${x.value.acronym}`,class:"btn btn-outline btn-sm"},{default:st(()=>[...e[24]||(e[24]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),j(" Manage Station ",-1)])]),_:1},8,["to"])):L("",!0)])]),t("div",Me,[(l(!0),d(D,null,X(Y.value,a=>(l(),d("button",{key:a.key,class:N(["tab gap-2",{"tab-active":F.value===a.key}]),onClick:mt=>F.value=a.key},[(l(),d("svg",Pe,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:a.icon},null,8,Se)])),j(" "+p(a.label)+" ",1),t("span",{class:N(["badge badge-sm",F.value===a.key?"badge-primary":"badge-ghost"])},p(a.count),3)],10,$e))),128))]),T.value?(l(),d("div",ze,[...e[25]||(e[25]=[t("span",{class:"loading loading-spinner loading-md"},null,-1)])])):(l(),d("div",Ce,[(l(!0),d(D,null,X(O.value,a=>(l(),Z(u,{key:a.id,to:`/platforms/${a.id}`,class:"card bg-base-100 shadow hover:shadow-lg transition-shadow cursor-pointer",onMouseenter:mt=>B(a),onMouseleave:I},{default:st(()=>[t("div",Le,[t("div",Be,[t("div",{class:N(["p-2.5 rounded-lg",it(a)]),title:a.mount_type_code||a.platform_type},[(l(),d("svg",{xmlns:"http://www.w3.org/2000/svg",class:N(["h-6 w-6",dt(a)]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:W(a)},null,8,Ae)],2))],10,Ve),t("div",je,[t("h3",Ne,p(a.normalized_name),1),t("p",Ee,p(a.display_name),1),t("div",Fe,[e[26]||(e[26]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-accent",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1)),t("span",He,p(a.instrument_count||0)+" instruments",1)])]),t("span",{class:N(["badge badge-xs",a.status==="Active"?"badge-success":"badge-ghost"])},p(a.status),3)])])]),_:2},1032,["to","onMouseenter"]))),128)),O.value.length===0?(l(),d("div",Ue,[S.value.length===0?(l(),d(D,{key:0},[j(" No platforms found ")],64)):(l(),d(D,{key:1},[j(" No "+p(F.value)+" platforms found ",1)],64))])):L("",!0)]))])):(l(),d("div",Ie,[e[27]||(e[27]=t("h2",{class:"text-lg font-semibold mb-4"},"Research Stations",-1)),t("div",Te,[(l(!0),d(D,null,X(k.value,a=>(l(),Z(Zt,{key:a.id,station:a},null,8,["station"]))),128))])])),vt(z(Mt),{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=a=>h.value=a),"default-type":"stations",onExported:y},null,8,["modelValue"]),x.value?(l(),Z(z(_t),{key:4,modelValue:H.value,"onUpdate:modelValue":e[4]||(e[4]=a=>H.value=a),"station-id":x.value.id,"station-acronym":x.value.acronym||"",onSubmit:n},null,8,["modelValue","station-id","station-acronym"])):L("",!0)])}}};export{qe as default};
