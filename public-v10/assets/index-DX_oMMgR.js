const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginView-iH8wfxpA.js","assets/vendor-2iZwFq-s.js","assets/DashboardView-BkOr9aJK.js","assets/InstrumentIcon.vue_vue_type_style_index_0_scoped_cbf9e092_lang-D-dukWxj.js","assets/InstrumentIcon-YuUh7puT.css","assets/leaflet-src-DUdEndMj.js","assets/ExportModal-YS0B_YaG.js","assets/DashboardView-CSqqzq0V.css","assets/AdminDashboardView-6Uz0BoWS.js","assets/AdminView-BHF9J84J.js","assets/StationView-CNvPR5eW.js","assets/useTypeRegistry-CiWZAadw.js","assets/SatellitePlatformDetails-Bp5_s6Sy.js","assets/SatellitePlatformDetails-B7S7_cHK.css","assets/PlatformView-C96d_Wmy.js","assets/InstrumentFormModal-CVNzpoTc.js","assets/InstrumentView-jQsWhCBQ.js","assets/InstrumentView-C-nXLWy3.css","assets/NotFoundView-C73XeW2G.js"])))=>i.map(i=>d[i]);
import{d as K,r as S,c as M,u as ne,a as he,b as se,e as x,o as w,f as r,g as L,w as E,F as q,h as U,i as D,t as N,j as re,k as z,l as V,n as T,m as pe,p as ge,q as oe,T as we,s as ee,v as _e,x as ye,y as be,z as xe,A as ke,B as Me}from"./vendor-2iZwFq-s.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))t(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const m of u.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&t(m)}).observe(document,{childList:!0,subtree:!0});function n(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function t(c){if(c.ep)return;c.ep=!0;const u=n(c);fetch(c.href,u)}})();const Se="/images/SITES_spectral_LOGO.png",G="/api/v11";function Ae(){return localStorage.getItem("auth_token")}function W(){const e=new Headers({"Content-Type":"application/json"}),a=Ae();return a&&e.set("Authorization",`Bearer ${a}`),e}async function J(e){const a=await e.json();if(!e.ok)throw e.status===401?(localStorage.removeItem("auth_token"),window.location.href="/login",new Error("Session expired. Please login again.")):new Error(a.error||a.message||`HTTP error ${e.status}`);return a}const I={async get(e,a={}){const n=new URL(`${G}${e}`,window.location.origin);Object.entries(a).forEach(([c,u])=>{u!=null&&n.searchParams.set(c,u)});const t=await fetch(n.toString(),{method:"GET",headers:W()});return J(t)},async post(e,a={}){const n=await fetch(`${G}${e}`,{method:"POST",headers:W(),body:JSON.stringify(a)});return J(n)},async put(e,a={}){const n=await fetch(`${G}${e}`,{method:"PUT",headers:W(),body:JSON.stringify(a)});return J(n)},async delete(e,a={}){const n=new URL(`${G}${e}`,window.location.origin);Object.entries(a).forEach(([c,u])=>{u!=null&&n.searchParams.set(c,u)});const t=await fetch(n.toString(),{method:"DELETE",headers:W()});return J(t)}},Pe=["admin","sites-admin","spectral-admin"],te=["admin","sites-admin","spectral-admin"],Y=K("auth",()=>{const e=S(null),a=S(localStorage.getItem("auth_token")),n=S("/"),t=M(()=>e.value?!!(Pe.includes(e.value.role)||te.includes(e.value.username)):!1),c=M(()=>{if(!e.value)return!1;if(e.value.role==="station-admin")return!0;const s=e.value.username||"";return s.endsWith("-admin")&&!te.includes(s)}),u=M(()=>!e.value||t.value||c.value?!1:e.value.role==="station"||!!e.value.station_id),m=M(()=>!!a.value&&!!e.value),v=M(()=>{var s;return t.value?"admin":c.value?"station-admin":u.value?"station":((s=e.value)==null?void 0:s.role)||"readonly"}),p=M(()=>{var s;return((s=e.value)==null?void 0:s.station_id)||null}),y=M(()=>{var l;if(!((l=e.value)!=null&&l.username))return null;const s=e.value.username;return s.endsWith("-admin")&&!te.includes(s)?s.replace(/-admin$/,""):u.value&&!s.includes("-")?s:null});function f(s){var l,g,$,B;if(t.value)return!0;if(c.value){const H=y.value,j=(l=e.value)==null?void 0:l.station_acronym,X=(g=e.value)==null?void 0:g.station_id;if(typeof s=="string"){const Z=s.toLowerCase();return Z===(H==null?void 0:H.toLowerCase())||Z===(j==null?void 0:j.toLowerCase())}return X===s}if(u.value){const H=($=e.value)==null?void 0:$.station_id,j=(B=e.value)==null?void 0:B.station_acronym;return typeof s=="string"?s.toLowerCase()===(j==null?void 0:j.toLowerCase()):H===s}return!1}async function d(s,l){try{const g=await I.post("/auth/login",{username:s,password:l});return g.success?(a.value=g.token,e.value=g.user,localStorage.setItem("auth_token",g.token),!0):!1}catch(g){return console.error("Login error:",g),!1}}function _(){a.value=null,e.value=null,localStorage.removeItem("auth_token")}async function k(){if(!a.value)return!1;try{const s=await I.get("/auth/me");return s.success?(e.value=s.user,!0):(_(),!1)}catch{return _(),!1}}function b(s){n.value=s}function h(){const s=n.value;return n.value="/",s}return{user:e,token:a,redirectPath:n,isAuthenticated:m,isAdmin:t,isStationAdmin:c,isStationUser:u,userRole:v,userStation:p,userStationFromUsername:y,canEditStation:f,login:d,logout:_,initialize:k,setRedirectPath:b,getRedirectPath:h}}),ue=K("stations",()=>{const e=S([]),a=S(null),n=S(!1),t=S(null),c=M(()=>e.value.length),u=M(()=>e.value.filter(d=>d.status==="Active")),m=M(()=>d=>e.value.find(_=>_.acronym===d));async function v(){n.value=!0,t.value=null;try{const d=await I.get("/stations");d.data?e.value=d.data||[]:d.success?e.value=d.data||[]:t.value=d.error||"Failed to fetch stations"}catch(d){t.value=d.message}finally{n.value=!1}}async function p(d){n.value=!0,t.value=null;try{const _=await I.get(`/stations/${d}`),k=_.data||(_.success?_.data:null);return k?(a.value=k,k):(t.value=_.error||"Station not found",null)}catch(_){return t.value=_.message,null}finally{n.value=!1}}async function y(d,_){n.value=!0,t.value=null;try{const k=await I.put(`/stations/${d}`,_),b=k.data||(k.success?k.data:null);if(b){a.value=b;const h=e.value.findIndex(s=>s.id===d);return h!==-1&&(e.value[h]=b),b}else return t.value=k.error||"Failed to update station",null}catch(k){return t.value=k.message,null}finally{n.value=!1}}function f(){a.value=null}return{stations:e,currentStation:a,loading:n,error:t,stationCount:c,activeStations:u,getStationByAcronym:m,fetchStations:v,fetchStation:p,updateStation:y,clearCurrentStation:f}}),$e={class:"navbar bg-base-100 shadow-lg sticky top-0 z-50"},Ie={class:"navbar-start"},Le={class:"navbar-center hidden lg:flex"},Ce={class:"breadcrumbs text-sm"},Ee={class:"navbar-end"},ze={key:0,class:"dropdown dropdown-end mr-2"},Ve={tabindex:"0",class:"menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow-lg bg-base-100 rounded-box w-52"},Be={class:"dropdown dropdown-end"},Te={tabindex:"0",role:"button",class:"btn btn-ghost gap-2"},He={class:"avatar placeholder"},je={class:"bg-neutral text-neutral-content rounded-full w-8"},Ne={class:"text-xs"},De={class:"hidden sm:inline"},Re={tabindex:"0",class:"menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow-lg bg-base-100 rounded-box w-52"},Fe={key:0},Oe={key:1},qe={__name:"TheNavbar",setup(e){const a=ne(),n=he(),t=Y(),c=ue(),u=M(()=>{const y=[{name:"Home",path:"/"}];return a.params.acronym&&y.push({name:a.params.acronym,path:`/stations/${a.params.acronym}`}),y}),m=M(()=>{var f,d;const y=(f=t.user)==null?void 0:f.station_normalized_name;if(y&&!t.isAdmin){const _=c.stations.find(k=>k.normalized_name===y);if(_!=null&&_.display_name)return _.display_name}return((d=t.user)==null?void 0:d.username)||"User"}),v=M(()=>{const y=t.userRole;return{admin:"badge-primary",station:"badge-secondary",readonly:"badge-ghost"}[y]||"badge-ghost"});async function p(){t.logout(),n.push("/login")}return(y,f)=>{const d=se("router-link");return w(),x("nav",$e,[r("div",Ie,[L(d,{to:"/",class:"btn btn-ghost normal-case text-xl gap-2"},{default:E(()=>[...f[0]||(f[0]=[r("img",{src:Se,alt:"SITES Spectral",class:"h-8 w-auto"},null,-1),r("span",{class:"hidden sm:inline"},"SITES Spectral",-1)])]),_:1})]),r("div",Le,[r("div",Ce,[r("ul",null,[(w(!0),x(q,null,U(u.value,_=>(w(),x("li",{key:_.path},[L(d,{to:_.path,class:"hover:text-primary"},{default:E(()=>[D(N(_.name),1)]),_:2},1032,["to"])]))),128))])])]),r("div",Ee,[f[8]||(f[8]=re('<label class="swap swap-rotate btn btn-ghost btn-circle mr-2"><input type="checkbox" class="theme-controller" value="dark"><svg class="swap-on fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"></path></svg><svg class="swap-off fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"></path></svg></label>',1)),V(t).isAdmin?(w(),x("div",ze,[r("div",{tabindex:"0",role:"button",class:T(["btn btn-ghost btn-sm",{"btn-active":V(a).path.startsWith("/admin")}])},[...f[1]||(f[1]=[re('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg><span class="hidden md:inline">Admin</span><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',3)])],2),r("ul",Ve,[r("li",null,[L(d,{to:"/admin",class:T({active:V(a).path==="/admin"})},{default:E(()=>[...f[2]||(f[2]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),D(" Dashboard ",-1)])]),_:1},8,["class"])]),r("li",null,[L(d,{to:"/admin/settings",class:T({active:V(a).path==="/admin/settings"})},{default:E(()=>[...f[3]||(f[3]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),D(" Users & Settings ",-1)])]),_:1},8,["class"])])])])):z("",!0),r("div",Be,[r("div",Te,[r("div",He,[r("div",je,[r("span",Ne,N(m.value.charAt(0).toUpperCase()),1)])]),r("span",De,N(m.value),1),r("span",{class:T(["badge badge-sm",v.value])},N(V(t).userRole),3)]),r("ul",Re,[V(t).isAdmin?(w(),x("li",Fe,[L(d,{to:"/admin"},{default:E(()=>[...f[4]||(f[4]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),D(" Admin Dashboard ",-1)])]),_:1})])):z("",!0),V(t).isAdmin?(w(),x("li",Oe,[L(d,{to:"/admin/settings"},{default:E(()=>[...f[5]||(f[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),D(" Users & Settings ",-1)])]),_:1})])):z("",!0),f[6]||(f[6]=r("li",null,[r("a",{class:"justify-between"},[D(" Profile "),r("span",{class:"badge badge-sm badge-outline"},"Coming soon")])],-1)),f[7]||(f[7]=r("li",{class:"divider"},null,-1)),r("li",null,[r("button",{onClick:p,class:"text-error"}," Logout ")])])])])])}}},Ue=K("platforms",()=>{const e=S([]),a=S(null),n=S(!1),t=S(null),c=M(()=>e.value.length),u=M(()=>{const b={fixed:[],uav:[],satellite:[]};return e.value.forEach(h=>{const s=h.platform_type||"fixed";b[s]&&b[s].push(h)}),b}),m=M(()=>e.value.filter(b=>b.status==="Active"));async function v(b){n.value=!0,t.value=null;try{const h=await I.get(`/platforms/station/${b}`);h.data?e.value=h.data||[]:h.success?e.value=h.data||[]:t.value=h.error||"Failed to fetch platforms"}catch(h){t.value=h.message}finally{n.value=!1}}async function p(b){n.value=!0,t.value=null;try{const h=await I.get(`/platforms/${b}`),s=h.data||(h.success?h.data:null);return s?(a.value=s,s):(t.value=h.error||"Platform not found",null)}catch(h){return t.value=h.message,null}finally{n.value=!1}}async function y(b){n.value=!0,t.value=null;try{const h=await I.post("/platforms",b),s=h.data||(h.success?h.data:null);return s?(e.value.push(s),s):(t.value=h.error||"Failed to create platform",null)}catch(h){return t.value=h.message,null}finally{n.value=!1}}async function f(b,h){var s;n.value=!0,t.value=null;try{const l=await I.put(`/platforms/${b}`,h),g=l.data||(l.success?l.data:null);if(g){const $=e.value.findIndex(B=>B.id===b);return $!==-1&&(e.value[$]=g),((s=a.value)==null?void 0:s.id)===b&&(a.value=g),g}else return t.value=l.error||"Failed to update platform",null}catch(l){return t.value=l.message,null}finally{n.value=!1}}async function d(b){var h;n.value=!0,t.value=null;try{const s=await I.delete(`/platforms/${b}`);return s.deleted||s.success?(e.value=e.value.filter(l=>l.id!==b),((h=a.value)==null?void 0:h.id)===b&&(a.value=null),!0):(t.value=s.error||"Failed to delete platform",!1)}catch(s){return t.value=s.message,!1}finally{n.value=!1}}function _(){a.value=null}function k(){e.value=[],a.value=null}return{platforms:e,currentPlatform:a,loading:n,error:t,platformCount:c,platformsByType:u,activePlatforms:m,fetchPlatformsByStation:v,fetchPlatform:p,createPlatform:y,updatePlatform:f,deletePlatform:d,clearCurrentPlatform:_,clearPlatforms:k}}),Ze=K("instruments",()=>{const e=S([]),a=S(null),n=S(!1),t=S(null),c=M(()=>e.value.length),u=M(()=>{const s={};return e.value.forEach(l=>{const g=l.instrument_type||"Unknown";s[g]||(s[g]=[]),s[g].push(l)}),s}),m=M(()=>e.value.filter(s=>s.status==="Active")),v=M(()=>e.value.filter(s=>s.measurement_status==="Operational"));async function p(s){n.value=!0,t.value=null;try{const l=await I.get(`/instruments/platform/${s}`);l.data?e.value=l.data||[]:l.success?e.value=l.data||[]:t.value=l.error||"Failed to fetch instruments"}catch(l){t.value=l.message}finally{n.value=!1}}async function y(s){n.value=!0,t.value=null;try{const l=await I.get(`/instruments/station/${s}`);l.data?e.value=l.data||[]:l.success?e.value=l.data||[]:t.value=l.error||"Failed to fetch instruments"}catch(l){t.value=l.message}finally{n.value=!1}}async function f(s){n.value=!0,t.value=null;try{const l=await I.get(`/instruments/${s}`),g=l.data||(l.success?l.data:null);return g?(a.value=g,g):(t.value=l.error||"Instrument not found",null)}catch(l){return t.value=l.message,null}finally{n.value=!1}}async function d(s){n.value=!0,t.value=null;try{const l=await I.post("/instruments",s),g=l.data||(l.success?l.data:null);return g?(e.value.push(g),g):(t.value=l.error||"Failed to create instrument",null)}catch(l){return t.value=l.message,null}finally{n.value=!1}}async function _(s,l){var g;n.value=!0,t.value=null;try{const $=await I.put(`/instruments/${s}`,l),B=$.data||($.success?$.data:null);if(B){const H=e.value.findIndex(j=>j.id===s);return H!==-1&&(e.value[H]=B),((g=a.value)==null?void 0:g.id)===s&&(a.value=B),B}else return t.value=$.error||"Failed to update instrument",null}catch($){return t.value=$.message,null}finally{n.value=!1}}async function k(s){var l;n.value=!0,t.value=null;try{const g=await I.delete(`/instruments/${s}`);return g.deleted||g.success?(e.value=e.value.filter($=>$.id!==s),((l=a.value)==null?void 0:l.id)===s&&(a.value=null),!0):(t.value=g.error||"Failed to delete instrument",!1)}catch(g){return t.value=g.message,!1}finally{n.value=!1}}function b(){a.value=null}function h(){e.value=[],a.value=null}return{instruments:e,currentInstrument:a,loading:n,error:t,instrumentCount:c,instrumentsByType:u,activeInstruments:m,operationalInstruments:v,fetchInstrumentsByPlatform:p,fetchInstrumentsByStation:y,fetchInstrument:f,createInstrument:d,updateInstrument:_,deleteInstrument:k,clearCurrentInstrument:b,clearInstruments:h}}),Ge={class:"w-64 bg-base-100 min-h-screen border-r border-base-200 fixed left-0 top-16 overflow-y-auto pb-20"},We={class:"p-3"},Je={class:"flex items-center justify-between mb-3 px-1"},Ke={class:"badge badge-primary badge-xs"},Ye={key:0,class:"flex justify-center py-8"},Qe={key:1,class:"alert alert-error text-xs p-2"},Xe={key:2,class:"menu menu-xs bg-base-100 rounded-lg p-0 gap-0.5"},et={class:"flex items-center gap-1 p-0"},tt=["onClick"],nt={class:"font-medium"},st={class:"text-xs text-base-content/50 truncate hidden lg:inline"},at={key:0,class:"ml-4 pl-2 border-l border-base-300"},rt={key:0,class:"py-2 pl-2"},ot={class:"flex items-center gap-1 p-0"},lt=["onClick"],it={xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 flex-shrink-0 text-base-content/60",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ut=["d"],ct=["title"],dt=["d"],mt={class:"truncate"},vt={key:0,class:"ml-4 pl-2 border-l border-base-300"},ft={key:0,class:"py-1 pl-2"},ht={xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 flex-shrink-0 text-base-content/50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},pt=["d"],gt={class:"truncate"},wt={key:1,class:"py-1 pl-2 text-xs text-base-content/40 italic"},_t={key:1,class:"py-2 pl-2 text-xs text-base-content/40 italic"},yt={key:3,class:"mt-6 pt-4 border-t border-base-200"},bt={class:"menu menu-xs p-0"},xt={__name:"TheSidebar",setup(e){const a=ne(),n=ue(),t=Ue(),c=Ze(),u=Y(),m=S(new Set),v=S(new Set),p=S({}),y=S({}),f=S(new Set),d=S(new Set);pe(async()=>{n.stations.length===0&&await n.fetchStations()});const _=M(()=>a.params.acronym),k=M(()=>a.params.id?parseInt(a.params.id):null),b=M(()=>a.name==="instrument"&&a.params.id?parseInt(a.params.id):null);ge([_,k,b,h],async()=>{if(_.value&&h.value.length>0){m.value.add(_.value);const i=h.value.find(o=>o.acronym===_.value);i&&!p.value[i.id]&&await g(i)}if(k.value&&t.currentPlatform){const i=t.currentPlatform;m.value.add(i.station_acronym),v.value.add(k.value),y.value[k.value]||await $(k.value)}if(b.value&&c.currentInstrument){const o=c.currentInstrument.platform_id;v.value.add(o),y.value[o]||await $(o)}},{immediate:!0});const h=M(()=>{var C;const i=n.activeStations;if(u.isAdmin)return i;const o=(C=u.user)==null?void 0:C.station_normalized_name;return o?i.filter(A=>{var P;return A.normalized_name===o||((P=A.acronym)==null?void 0:P.toLowerCase())===o.toLowerCase()}):i});async function s(i){const o=i.acronym;m.value.has(o)?m.value.delete(o):(m.value.add(o),p.value[i.id]||await g(i))}async function l(i){v.value.has(i)?v.value.delete(i):(v.value.add(i),y.value[i]||await $(i))}async function g(i){if(!f.value.has(i.id)){f.value.add(i.id);try{const o=await fetch(`/api/v11/platforms/station/${i.id}`);if(o.ok){const C=await o.json();p.value[i.id]=C.data||[]}}catch(o){console.error("Failed to load platforms:",o)}finally{f.value.delete(i.id)}}}async function $(i){if(!d.value.has(i)){d.value.add(i);try{const o=await fetch(`/api/v11/instruments/platform/${i}`);if(o.ok){const C=await o.json();y.value[i]=C.data||[]}}catch(o){console.error("Failed to load instruments:",o)}finally{d.value.delete(i)}}}function B(i){return p.value[i]||[]}function H(i){return y.value[i]||[]}function j(i){return _.value===i&&!k.value}function X(i){return k.value===i&&!b.value}function Z(i){return b.value===i}function me(i){const o={fixed:"M12 2v20M8 22h8M8 6l4 16 4-16M10 12h4",uav:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM12 12m-3 0a3 3 0 106 0 3 3 0 00-6 0",satellite:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",mobile:"M8 17h.01M14 17h.01M8 17a2 2 0 11-4 0 2 2 0 014 0zm8 0a2 2 0 11-4 0 2 2 0 014 0zM5 17H3v-4a1 1 0 011-1h1V9a1 1 0 011-1h8a1 1 0 011 1v3h2a1 1 0 011 1v4h-2",usv:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",uuv:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"};return o[i]||o.fixed}function ae(i){var A;if(!i)return null;const o=(A=i.match(/^([A-Z]+)/))==null?void 0:A[1];return{PL:"M12 2v20M8 22h8M8 6l4 16 4-16M10 12h4",BL:"M3 21h18M5 21V8l7-6 7 6v13M9 12h2v2H9M13 12h2v2h-2M11 21v-4h2v4",GL:"M12 22v-7M12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8M12 7V4M8 9l-2-2M16 9l2-2"}[o]||null}function ve(i){var A;if(!i)return"text-base-content/40";const o=(A=i.match(/^([A-Z]+)/))==null?void 0:A[1];return{PL:"text-info",BL:"text-secondary",GL:"text-success"}[o]||"text-base-content/40"}function fe(i){const o=(i==null?void 0:i.toLowerCase())||"";return o.includes("phenocam")||o.includes("camera")?"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z M15 13a3 3 0 11-6 0 3 3 0 016 0z":o.includes("multispectral")?"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253":o.includes("par")?"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z":o.includes("ndvi")?"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z":o.includes("pri")?"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z":o.includes("hyperspectral")?"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01":o.includes("thermal")?"M9 19c-4.3 1.4-6-2.7-6-7 0-4.3 1.7-8.4 6-7m0 14V5m0 14a5 5 0 005-5 5 5 0 00-5-5":o.includes("lidar")?"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3":o.includes("radar")||o.includes("sar")?"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.14 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0":"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"}return(i,o)=>{const C=se("router-link");return w(),x("aside",Ge,[r("div",We,[r("div",Je,[o[0]||(o[0]=r("h2",{class:"text-sm font-semibold text-base-content/70 uppercase tracking-wide"},"Navigation",-1)),r("span",Ke,N(h.value.length),1)]),V(n).loading?(w(),x("div",Ye,[...o[1]||(o[1]=[r("span",{class:"loading loading-spinner loading-sm"},null,-1)])])):V(n).error?(w(),x("div",Qe,[r("span",null,N(V(n).error),1)])):(w(),x("ul",Xe,[(w(!0),x(q,null,U(h.value,A=>(w(),x("li",{key:A.acronym},[r("div",et,[r("button",{class:"btn btn-ghost btn-xs btn-square",onClick:oe(P=>s(A),["stop"])},[(w(),x("svg",{xmlns:"http://www.w3.org/2000/svg",class:T(["h-3 w-3 transition-transform",{"rotate-90":m.value.has(A.acronym)}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...o[2]||(o[2]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))],8,tt),L(C,{to:`/stations/${A.acronym}`,class:T(["flex-1 flex items-center gap-2 py-1.5 px-1 rounded hover:bg-base-200 text-sm",{"bg-primary/10 text-primary font-medium":j(A.acronym)}])},{default:E(()=>[o[3]||(o[3]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),r("span",nt,N(A.acronym),1),r("span",st,N(A.display_name),1)]),_:2},1032,["to","class"])]),m.value.has(A.acronym)?(w(),x("ul",at,[f.value.has(A.id)?(w(),x("li",rt,[...o[4]||(o[4]=[r("span",{class:"loading loading-spinner loading-xs"},null,-1)])])):z("",!0),(w(!0),x(q,null,U(B(A.id),P=>(w(),x("li",{key:P.id,class:"mt-0.5"},[r("div",ot,[r("button",{class:"btn btn-ghost btn-xs btn-square",onClick:oe(F=>l(P.id),["stop"])},[(w(),x("svg",{xmlns:"http://www.w3.org/2000/svg",class:T(["h-3 w-3 transition-transform",{"rotate-90":v.value.has(P.id)}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...o[5]||(o[5]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))],8,lt),L(C,{to:`/platforms/${P.id}`,class:T(["flex-1 flex items-center gap-1.5 py-1 px-1 rounded hover:bg-base-200 text-xs",{"bg-primary/10 text-primary font-medium":X(P.id)}])},{default:E(()=>[(w(),x("svg",it,[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:me(P.platform_type)},null,8,ut)])),ae(P.mount_type_code)?(w(),x("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",class:T(["h-3 w-3 flex-shrink-0",ve(P.mount_type_code)]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",title:P.mount_type_code},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:ae(P.mount_type_code)},null,8,dt)],10,ct)):z("",!0),r("span",mt,N(P.normalized_name||P.display_name),1)]),_:2},1032,["to","class"])]),v.value.has(P.id)?(w(),x("ul",vt,[d.value.has(P.id)?(w(),x("li",ft,[...o[6]||(o[6]=[r("span",{class:"loading loading-spinner loading-xs"},null,-1)])])):z("",!0),(w(!0),x(q,null,U(H(P.id),F=>(w(),x("li",{key:F.id,class:"mt-0.5"},[L(C,{to:`/instruments/${F.id}`,class:T(["flex items-center gap-2 py-1 px-2 rounded hover:bg-base-200 text-xs",{"bg-primary/10 text-primary font-medium":Z(F.id)}])},{default:E(()=>[(w(),x("svg",ht,[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:fe(F.instrument_type)},null,8,pt)])),r("span",gt,N(F.normalized_name||F.display_name),1)]),_:2},1032,["to","class"])]))),128)),!d.value.has(P.id)&&H(P.id).length===0?(w(),x("li",wt," No instruments ")):z("",!0)])):z("",!0)]))),128)),!f.value.has(A.id)&&B(A.id).length===0?(w(),x("li",_t," No platforms ")):z("",!0)])):z("",!0)]))),128))])),V(u).isAdmin?(w(),x("div",yt,[o[9]||(o[9]=r("h3",{class:"text-xs font-medium text-base-content/50 uppercase tracking-wide mb-2 px-1"},"Admin",-1)),r("ul",bt,[r("li",null,[L(C,{to:"/admin",class:"text-base-content/70 py-1.5"},{default:E(()=>[...o[7]||(o[7]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),D(" Dashboard ",-1)])]),_:1})]),r("li",null,[L(C,{to:"/admin/settings",class:"text-base-content/70 py-1.5"},{default:E(()=>[...o[8]||(o[8]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),D(" Users & Settings ",-1)])]),_:1})])])])):z("",!0)])])}}},O=S([]);let kt=0;const le={success:"alert-success",error:"alert-error",warning:"alert-warning",info:"alert-info"};function Mt(){function e(v,p="info",y=5e3){const f=++kt;return O.value.push({id:f,message:v,type:p,style:le[p]||le.info}),y>0&&setTimeout(()=>{u(f)},y),f}function a(v,p=5e3){return e(v,"success",p)}function n(v,p=8e3){return e(v,"error",p)}function t(v,p=6e3){return e(v,"warning",p)}function c(v,p=5e3){return e(v,"info",p)}function u(v){const p=O.value.findIndex(y=>y.id===v);p!==-1&&O.value.splice(p,1)}function m(){O.value=[]}return{notifications:O,notify:e,success:a,error:n,warning:t,info:c,remove:u,clearAll:m}}const ce=(e,a)=>{const n=e.__vccOpts||e;for(const[t,c]of a)n[t]=c;return n},St={class:"toast toast-top toast-end z-50"},At={xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},Pt=["d"],$t=["onClick"],It={__name:"NotificationToast",setup(e){const{notifications:a,remove:n}=Mt();function t(c){const u={success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"};return u[c]||u.info}return(c,u)=>(w(),x("div",St,[L(we,{name:"notification"},{default:E(()=>[(w(!0),x(q,null,U(V(a),m=>(w(),x("div",{key:m.id,class:T(["alert",m.style,"shadow-lg"])},[(w(),x("svg",At,[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:t(m.type)},null,8,Pt)])),r("span",null,N(m.message),1),r("button",{class:"btn btn-ghost btn-sm btn-circle",onClick:v=>V(n)(m.id),"aria-label":"Dismiss notification"},[...u[0]||(u[0]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,$t)],2))),128))]),_:1})]))}},Lt=ce(It,[["__scopeId","data-v-a42a999f"]]),Ct={class:"min-h-screen bg-base-200"},Et={class:"flex"},zt={class:"max-w-6xl mx-auto"},Vt={__name:"App",setup(e){const a=ne(),n=Y(),t=M(()=>n.isAuthenticated&&a.name!=="login"),c=M(()=>a.name!=="login");return(u,m)=>{const v=se("router-view");return w(),x("div",Ct,[L(Lt),c.value?(w(),ee(qe,{key:0})):z("",!0),r("div",Et,[t.value?(w(),ee(xt,{key:0})):z("",!0),r("main",{class:T(["flex-1 p-4 lg:p-6",{"ml-64":t.value}])},[r("div",zt,[L(v,null,{default:E(({Component:p})=>[L(_e,{name:"fade",mode:"out-in"},{default:E(()=>[(w(),ee(ye(p)))]),_:2},1024)]),_:1})])],2)])])}}},Bt=ce(Vt,[["__scopeId","data-v-f4f3d395"]]),Tt="modulepreload",Ht=function(e){return"/"+e},ie={},R=function(a,n,t){let c=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),v=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));c=Promise.allSettled(n.map(p=>{if(p=Ht(p),p in ie)return;ie[p]=!0;const y=p.endsWith(".css"),f=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${f}`))return;const d=document.createElement("link");if(d.rel=y?"stylesheet":Tt,y||(d.as="script"),d.crossOrigin="",d.href=p,v&&d.setAttribute("nonce",v),document.head.appendChild(d),y)return new Promise((_,k)=>{d.addEventListener("load",_),d.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(m){const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=m,window.dispatchEvent(v),!v.defaultPrevented)throw m}return c.then(m=>{for(const v of m||[])v.status==="rejected"&&u(v.reason);return a().catch(u)})},jt=()=>R(()=>import("./LoginView-iH8wfxpA.js"),__vite__mapDeps([0,1])),Nt=()=>R(()=>import("./DashboardView-BkOr9aJK.js"),__vite__mapDeps([2,1,3,4,5,6,7])),Dt=()=>R(()=>import("./AdminDashboardView-6Uz0BoWS.js"),__vite__mapDeps([8,1])),Rt=()=>R(()=>import("./AdminView-BHF9J84J.js"),__vite__mapDeps([9,1])),Ft=()=>R(()=>import("./StationView-CNvPR5eW.js"),__vite__mapDeps([10,3,1,4,11,12,13,6])),Ot=()=>R(()=>import("./PlatformView-C96d_Wmy.js"),__vite__mapDeps([14,1,11,3,4,12,13,15])),qt=()=>R(()=>import("./InstrumentView-jQsWhCBQ.js"),__vite__mapDeps([16,1,11,3,4,15,17])),Ut=()=>R(()=>import("./NotFoundView-C73XeW2G.js"),__vite__mapDeps([18,1])),Zt=[{path:"/login",name:"login",component:jt,meta:{requiresAuth:!1,title:"Login"}},{path:"/",name:"dashboard",component:Nt,meta:{requiresAuth:!0,title:"Dashboard"}},{path:"/dashboard",redirect:"/"},{path:"/admin",name:"admin",component:Dt,meta:{requiresAuth:!0,requiresAdmin:!0,title:"Admin Dashboard"}},{path:"/admin/settings",name:"admin-settings",component:Rt,meta:{requiresAuth:!0,requiresAdmin:!0,title:"Admin Settings"}},{path:"/stations/:acronym",name:"station",component:Ft,props:!0,meta:{requiresAuth:!0,title:"Station"}},{path:"/platforms/:id",name:"platform",component:Ot,props:e=>({id:Number(e.params.id)}),meta:{requiresAuth:!0,title:"Platform"}},{path:"/instruments/:id",name:"instrument",component:qt,props:e=>({id:Number(e.params.id)}),meta:{requiresAuth:!0,title:"Instrument"}},{path:"/:pathMatch(.*)*",name:"not-found",component:Ut,meta:{requiresAuth:!1,title:"Not Found"}}],de=be({history:xe(),routes:Zt,scrollBehavior(e,a,n){return n||{top:0}}});de.beforeEach(async(e,a,n)=>{const t=Y();if(document.title=e.meta.title?`${e.meta.title} | SITES Spectral`:"SITES Spectral",e.meta.requiresAuth&&!t.isAuthenticated){t.setRedirectPath(e.fullPath),n({name:"login"});return}if(e.meta.requiresAdmin&&!t.isAdmin){n({name:"dashboard"});return}if(e.name==="login"&&t.isAuthenticated){n({name:"dashboard"});return}n()});const Q=ke(Bt);Q.use(Me());Q.use(de);Q.config.errorHandler=(e,a,n)=>{console.error("Vue Error:",e),console.error("Component:",a),console.error("Info:",n)};Q.mount("#app");export{te as A,Se as _,ce as a,ue as b,Mt as c,I as d,Pe as e,Ue as f,Ze as g,R as h,Y as u};
