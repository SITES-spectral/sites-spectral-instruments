import{d as Oe,r as S,c as $,m as Ie,M as $e,D as De,E as oe,e as y,o as g,f as e,G as fe,k as O,n as J,t as C,h as te,F as ye,i as _e,p as we,N as Me,l as Y,w as he,g as ve,A as Le,B as ge,C as be,b as Ee,H as Ve,a as Pe}from"./vendor-oiqY8oHn.js";import{u as Ae,_ as Be}from"./instruments-DXCV3k3W.js";import{u as Te,a as je,e as Ne,_ as Ce,f as ze}from"./platforms-B4nEbBu-.js";import{c as ce,_ as Se,u as Ue,b as Fe}from"./index-CwZwIHTT.js";import{_ as Ye,g as Xe,a as He}from"./BaseModal-C2sPkbo_.js";const Ge=Oe("rois",()=>{const f=S([]),B=S(null),h=S(!1),i=S(null),w=S(!0),t=$(()=>f.value.length),E=$(()=>f.value.filter(n=>!n.is_legacy)),d=$(()=>f.value.filter(n=>n.is_legacy)),c=$(()=>E.value.length),M=$(()=>d.value.length),v=$(()=>{const n={};return f.value.forEach(p=>{const D=p.instrument_id;n[D]||(n[D]=[]),n[D].push(p)}),n});function _(n){if(!n)return n;if(n.points_json&&typeof n.points_json=="string")try{n.points=JSON.parse(n.points_json)}catch{n.points=[]}else n.points_json&&Array.isArray(n.points_json)?n.points=n.points_json:n.points||(n.points=[]);return n}async function N(n,p=!0){var D;h.value=!0,i.value=null;try{const V={instrument:n};p&&(V.include_legacy="true");const z=await ce.get("/rois",V);z.success?f.value=(((D=z.data)==null?void 0:D.rois)||[]).map(_):i.value=z.error||"Failed to fetch ROIs"}catch(V){i.value=V.message}finally{h.value=!1}}async function F(n){var p;h.value=!0,i.value=null;try{const D=await ce.get("/rois",{station:n});D.success?f.value=(((p=D.data)==null?void 0:p.rois)||[]).map(_):i.value=D.error||"Failed to fetch ROIs"}catch(D){i.value=D.message}finally{h.value=!1}}async function q(n){h.value=!0,i.value=null;try{const p=await ce.get(`/rois/${n}`);return p.success?(B.value=_(p.data),B.value):(i.value=p.error||"ROI not found",null)}catch(p){return i.value=p.message,null}finally{h.value=!1}}async function K(n){h.value=!0,i.value=null;try{const p={...n};p.points&&Array.isArray(p.points)&&(p.points_json=JSON.stringify(p.points),delete p.points);const D=await ce.post("/rois",p);return D.success?(n.instrument_id&&await N(n.instrument_id),D.data):(i.value=D.error||"Failed to create ROI",null)}catch(p){return i.value=p.message,null}finally{h.value=!1}}async function L(n,p){var D;h.value=!0,i.value=null;try{const V={...p};V.points&&Array.isArray(V.points)&&(V.points_json=JSON.stringify(V.points),delete V.points);const z=await ce.put(`/rois/${n}`,V);if(z.success){const T=f.value.findIndex(Q=>Q.id===n);return T!==-1&&(f.value[T]=_({...f.value[T],...p})),((D=B.value)==null?void 0:D.id)===n&&(B.value=_({...B.value,...p})),z.data}else return i.value=z.error||"Failed to update ROI",null}catch(V){return i.value=V.message,null}finally{h.value=!1}}async function x(n){var p;h.value=!0,i.value=null;try{const D=await ce.delete(`/rois/${n}`);return D.success?(f.value=f.value.filter(V=>V.id!==n),((p=B.value)==null?void 0:p.id)===n&&(B.value=null),!0):(i.value=D.error||"Failed to delete ROI",!1)}catch(D){return i.value=D.message,!1}finally{h.value=!1}}function U(){B.value=null}function G(){f.value=[],B.value=null}async function j(n){try{const p=await ce.get(`/rois/${n}/edit-mode`);return p.success?p.data:(i.value=p.error||"Failed to get edit mode",null)}catch(p){return i.value=p.message,null}}async function X(n,p,D="Replaced by new ROI"){var V;h.value=!0,i.value=null;try{const z=await ce.post(`/rois/${n}/legacy`,{reason:D,replacement_data:p});if(z.success){const T=(V=f.value.find(Q=>Q.id===n))==null?void 0:V.instrument_id;return T&&await N(T),z.data}return i.value=z.error||"Failed to mark ROI as legacy",null}catch(z){return i.value=z.message,null}finally{h.value=!1}}async function k(n,p){var D;h.value=!0,i.value=null;try{const V={...p};V.points&&Array.isArray(V.points)&&(V.points_json=JSON.stringify(V.points),delete V.points);const z=await ce.put(`/rois/${n}/override`,V);if(z.success){const T=f.value.findIndex(Q=>Q.id===n);return T!==-1&&(f.value[T]={...f.value[T],...p,timeseries_broken:!0}),((D=B.value)==null?void 0:D.id)===n&&(B.value={...B.value,...p,timeseries_broken:!0}),z.data}return i.value=z.error||"Failed to update ROI",null}catch(V){return i.value=V.message,null}finally{h.value=!1}}function m(n){w.value=n}return{rois:f,currentROI:B,loading:h,error:i,includeLegacy:w,roiCount:t,roisByInstrument:v,activeRois:E,legacyRois:d,activeRoiCount:c,legacyRoiCount:M,fetchROIsByInstrument:N,fetchROIsByStation:F,fetchROI:q,createROI:K,updateROI:L,deleteROI:x,clearCurrentROI:U,clearROIs:G,getROIEditMode:j,markAsLegacyAndReplace:X,adminOverrideUpdate:k,setIncludeLegacy:m}}),We={class:"absolute top-2 right-2 flex gap-1"},qe=["title"],Je={class:"text-xs"},Ke={class:"absolute bottom-2 left-2 flex gap-1"},Qe={class:"badge badge-neutral"},Ze={key:0,class:"badge badge-warning badge-outline"},et={__name:"ROIViewer",props:{imageUrl:{type:String,default:""},rois:{type:Array,default:()=>[]},selectedRoiId:{type:[Number,String],default:null},showLabels:{type:Boolean,default:!0},height:{type:[Number,String],default:400},showLegacyToggle:{type:Boolean,default:!0},initialShowLegacy:{type:Boolean,default:!1}},emits:["roi-click","roi-hover","toggle-legacy"],setup(f,{expose:B,emit:h}){const i=f,w=h,t=S(null),E=S(null),d=S(!1),c=S(!1),M=S(null),v=S(i.initialShowLegacy),_=$(()=>i.rois.some(a=>a.is_legacy)),N=$(()=>v.value?i.rois:i.rois.filter(a=>!a.is_legacy)),F=$(()=>i.rois.filter(a=>a.is_legacy).length),q=$(()=>i.rois.filter(a=>!a.is_legacy).length);function K(){v.value=!v.value,w("toggle-legacy",v.value),T()}let L=null;const x=S(1),U=S(0),G=S(0);let j=!1,X=0,k=0;const m=$(()=>typeof i.height=="number"?i.height:parseInt(i.height)||400);function n(a,r=1){const I=a.color_r??255,o=a.color_g??0,l=a.color_b??0;return`rgba(${I}, ${o}, ${l}, ${r})`}function p(a,r){return{x:a*x.value+U.value,y:r*x.value+G.value}}function D(a,r){return{x:(a-U.value)/x.value,y:(r-G.value)/x.value}}function V(a,r,I){if(!I||I.length<3)return!1;let o=!1;for(let l=0,u=I.length-1;l<I.length;u=l++){const s=I[l].x,b=I[l].y,R=I[u].x,P=I[u].y;b>r!=P>r&&a<(R-s)*(r-b)/(P-b)+s&&(o=!o)}return o}function z(a,r){const I=D(a,r);for(const o of N.value)if(o.points&&V(I.x,I.y,o.points))return o;return null}function T(){const a=E.value;if(!a)return;const r=a.getContext("2d"),I=a.width,o=a.height;r.clearRect(0,0,I,o),r.fillStyle="#1a1a2e",r.fillRect(0,0,I,o),L&&d.value?(r.save(),r.translate(U.value,G.value),r.scale(x.value,x.value),r.drawImage(L,0,0),r.restore()):i.imageUrl?c.value?(r.fillStyle="#ff6b6b",r.font="16px sans-serif",r.textAlign="center",r.fillText("Failed to load image",I/2,o/2)):(r.fillStyle="#888",r.font="16px sans-serif",r.textAlign="center",r.fillText("Loading image...",I/2,o/2)):(r.fillStyle="#4a4a6a",r.font="16px sans-serif",r.textAlign="center",r.fillText("No image available",I/2,o/2)),N.value.forEach(l=>{if(!l.points||l.points.length<3)return;const u=l.id===i.selectedRoiId,s=l.id===M.value,b=l.is_legacy,R=l.alpha??.3,P=b?R*.5:R;r.beginPath();const A=p(l.points[0].x,l.points[0].y);r.moveTo(A.x,A.y);for(let ee=1;ee<l.points.length;ee++){const ne=p(l.points[ee].x,l.points[ee].y);r.lineTo(ne.x,ne.y)}r.closePath();const Z=u?P+.2:s?P+.1:P;r.fillStyle=n(l,Z),r.fill(),r.lineWidth=u?3:s?2:l.thickness??2;const le=b?.6:1;if(r.strokeStyle=n(l,le),b&&r.setLineDash([4,4]),r.stroke(),r.setLineDash([]),i.showLabels&&l.roi_name){let ee=0,ne=0;l.points.forEach(Re=>{ee+=Re.x,ne+=Re.y}),ee/=l.points.length,ne/=l.points.length;const ae=p(ee,ne);r.font=b?"11px sans-serif":"bold 12px sans-serif";const xe=b?`${l.roi_name} (legacy)`:l.roi_name,H=r.measureText(xe),ke=4;r.fillStyle=b?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.7)",r.fillRect(ae.x-H.width/2-ke,ae.y-8-ke,H.width+ke*2,16+ke),r.fillStyle=b?"rgba(255, 255, 255, 0.7)":"#fff",r.textAlign="center",r.textBaseline="middle",r.fillText(xe,ae.x,ae.y)}})}function Q(){if(!L||!E.value)return;const a=E.value,r=a.width/L.width,I=a.height/L.height;x.value=Math.min(r,I)*.95,U.value=(a.width-L.width*x.value)/2,G.value=(a.height-L.height*x.value)/2,T()}function me(a){a.preventDefault();const I=E.value.getBoundingClientRect(),o=a.clientX-I.left,l=a.clientY-I.top,u=a.deltaY>0?.9:1.1,s=Math.max(.1,Math.min(5,x.value*u)),b=D(o,l);x.value=s,U.value=o-b.x*s,G.value=l-b.y*s,T()}function pe(a){j=!0,X=a.clientX,k=a.clientY}function de(a){const r=E.value,I=r.getBoundingClientRect(),o=a.clientX-I.left,l=a.clientY-I.top;if(j){const u=a.clientX-X,s=a.clientY-k;U.value+=u,G.value+=s,X=a.clientX,k=a.clientY,T()}else{const u=z(o,l),s=(u==null?void 0:u.id)||null;s!==M.value&&(M.value=s,w("roi-hover",u),T()),r.style.cursor=u?"pointer":j?"grabbing":"grab"}}function ie(){j=!1}function re(a){const I=E.value.getBoundingClientRect(),o=a.clientX-I.left,l=a.clientY-I.top,u=z(o,l);u&&w("roi-click",u)}function se(){const a=E.value,r=t.value;!a||!r||(a.width=r.clientWidth,a.height=m.value,d.value?Q():T())}function ue(){if(!i.imageUrl){d.value=!1,c.value=!1,T();return}L=new Image,L.crossOrigin="anonymous",L.onload=()=>{d.value=!0,c.value=!1,Q()},L.onerror=()=>{d.value=!1,c.value=!0,T()},L.src=i.imageUrl}return Ie(()=>{$e(()=>{se(),ue()}),window.addEventListener("resize",se),window.addEventListener("mouseup",ie)}),De(()=>{window.removeEventListener("resize",se),window.removeEventListener("mouseup",ie)}),oe(()=>i.imageUrl,ue),oe(()=>i.rois,T,{deep:!0}),oe(()=>i.selectedRoiId,T),oe(()=>i.showLabels,T),B({fitToCanvas:Q,draw:T}),(a,r)=>(g(),y("div",{ref_key:"containerRef",ref:t,class:"roi-viewer-container relative w-full bg-base-300 rounded-lg overflow-hidden"},[e("canvas",{ref_key:"canvasRef",ref:E,style:fe({height:`${m.value}px`}),class:"w-full cursor-grab",onWheel:me,onMousedown:pe,onMousemove:de,onClick:re},null,36),e("div",We,[f.showLegacyToggle&&_.value?(g(),y("button",{key:0,class:J(["btn btn-sm btn-ghost bg-base-100/80 hover:bg-base-100 gap-1",{"btn-active":v.value}]),title:v.value?"Hide legacy ROIs":"Show legacy ROIs",onClick:K},[r[0]||(r[0]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Je,C(F.value),1)],10,qe)):O("",!0),e("button",{class:"btn btn-sm btn-square btn-ghost bg-base-100/80 hover:bg-base-100",title:"Fit to view",onClick:Q},[...r[1]||(r[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)])])]),e("div",Ke,[e("div",Qe,C(q.value)+" active ",1),v.value&&F.value>0?(g(),y("div",Ze,C(F.value)+" legacy ",1)):O("",!0)])],512))}},tt=Se(et,[["__scopeId","data-v-e5a4ad9c"]]),lt={class:"flex-1 min-w-0"},nt={class:"flex items-center gap-2"},st={key:0,class:"badge badge-xs badge-warning gap-1"},at={key:1,class:"badge badge-xs badge-error gap-1",title:"Time series data may be inconsistent"},ot={key:0,class:"text-xs text-base-content/60"},it={key:0,class:"badge badge-xs badge-ghost ml-1"},rt={key:1,class:"ml-1"},ut={key:0,class:"flex gap-1 flex-shrink-0"},ct={key:1,class:"flex-shrink-0"},dt={__name:"ROICard",props:{roi:{type:Object,required:!0},selected:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},isLegacy:{type:Boolean,default:!1}},emits:["select","edit","delete"],setup(f,{emit:B}){const h=f,i=B,w=$(()=>{const v=h.roi.color_r??255,_=h.roi.color_g??0,N=h.roi.color_b??0,F=h.isLegacy?.5:1;return{backgroundColor:`rgba(${v}, ${_}, ${N}, ${F})`}}),t=$(()=>{const v="roi-card flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all border";return h.isLegacy?[v,"border-base-300 opacity-60",h.selected?"bg-base-200 border-base-content/30":"bg-base-100/50 hover:bg-base-200/50"]:[v,"border-base-300 hover:border-primary/50",h.selected?"bg-primary/10 border-primary":"bg-base-100 hover:bg-base-200"]}),E=$(()=>{const v=h.roi.points||h.roi.points_json;if(Array.isArray(v))return v.length;if(typeof v=="string")try{return JSON.parse(v).length}catch{return 0}return 0});function d(){i("select",h.roi)}function c(v){v.stopPropagation(),i("edit",h.roi)}function M(v){v.stopPropagation(),i("delete",h.roi)}return(v,_)=>(g(),y("div",{class:J(t.value),onClick:d},[e("div",{class:"w-4 h-4 rounded flex-shrink-0 border border-base-300",style:fe(w.value)},null,4),e("div",lt,[e("div",nt,[e("span",{class:J(["font-medium truncate",{"line-through":f.isLegacy}])},C(f.roi.roi_name),3),f.isLegacy?(g(),y("span",st,[..._[0]||(_[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),te(" Legacy ",-1)])])):O("",!0),f.roi.timeseries_broken?(g(),y("span",at,[..._[1]||(_[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)])])):O("",!0)]),f.compact?O("",!0):(g(),y("div",ot,[te(C(E.value)+" points ",1),f.roi.auto_generated?(g(),y("span",it,"auto")):O("",!0),f.isLegacy&&f.roi.legacy_date?(g(),y("span",rt," ("+C(new Date(f.roi.legacy_date).toLocaleDateString())+") ",1)):O("",!0)]))]),f.canEdit&&!f.isLegacy?(g(),y("div",ut,[e("button",{class:"btn btn-ghost btn-xs btn-square",title:"Edit ROI",onClick:c},[..._[2]||(_[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),e("button",{class:"btn btn-ghost btn-xs btn-square text-error",title:"Delete ROI",onClick:M},[..._[3]||(_[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])):O("",!0),f.isLegacy?(g(),y("div",ct,[..._[4]||(_[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-base-content/40",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)])])):O("",!0)],2))}},vt={class:"roi-list"},gt={class:"flex items-center justify-between mb-3"},ft={class:"flex items-center gap-2"},mt={class:"badge badge-sm"},pt={key:0,class:"tabs tabs-boxed mb-3 bg-base-200"},bt={class:"badge badge-sm ml-1"},ht={class:"badge badge-sm badge-ghost ml-1"},yt={key:1,class:"flex justify-center py-8"},xt={key:2,class:"text-center py-8 text-base-content/60"},wt={key:0,class:"text-sm mt-1"},kt={key:4,class:"mt-3"},_t={__name:"ROIList",props:{rois:{type:Array,default:()=>[]},selectedId:{type:[Number,String],default:null},canEdit:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},maxHeight:{type:[Number,String],default:null},showLegacyTabs:{type:Boolean,default:!0}},emits:["select","edit","delete","create"],setup(f,{emit:B}){const h=f,i=B,w=S("active"),t=$(()=>h.rois.filter(L=>!L.is_legacy)),E=$(()=>h.rois.filter(L=>L.is_legacy)),d=$(()=>E.value.length>0),c=$(()=>h.showLegacyTabs&&d.value),M=$(()=>[...c.value?w.value==="legacy"?E.value:t.value:h.rois].sort((x,U)=>(x.roi_name||"").localeCompare(U.roi_name||"",void 0,{numeric:!0}))),v=$(()=>c.value?w.value==="legacy"?E.value.length:t.value.length:h.rois.length),_=$(()=>h.maxHeight?{maxHeight:typeof h.maxHeight=="number"?`${h.maxHeight}px`:h.maxHeight,overflowY:"auto"}:{});function N(L){i("select",L)}function F(L){i("edit",L)}function q(L){i("delete",L)}function K(){i("create")}return(L,x)=>(g(),y("div",vt,[e("div",gt,[e("div",ft,[x[2]||(x[2]=e("span",{class:"font-medium"},"ROIs",-1)),e("span",mt,C(f.rois.length),1)]),f.canEdit&&w.value==="active"?(g(),y("button",{key:0,class:"btn btn-primary btn-sm",onClick:K},[...x[3]||(x[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),te(" Add ROI ",-1)])])):O("",!0)]),c.value?(g(),y("div",pt,[e("button",{class:J(["tab",{"tab-active":w.value==="active"}]),onClick:x[0]||(x[0]=U=>w.value="active")},[x[4]||(x[4]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),x[5]||(x[5]=te(" Active ",-1)),e("span",bt,C(t.value.length),1)],2),e("button",{class:J(["tab",{"tab-active":w.value==="legacy"}]),onClick:x[1]||(x[1]=U=>w.value="legacy")},[x[6]||(x[6]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),x[7]||(x[7]=te(" Legacy ",-1)),e("span",ht,C(E.value.length),1)],2)])):O("",!0),f.loading?(g(),y("div",yt,[...x[8]||(x[8]=[e("span",{class:"loading loading-spinner loading-md"},null,-1)])])):v.value===0?(g(),y("div",xt,[x[12]||(x[12]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto mb-3 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),w.value==="legacy"?(g(),y(ye,{key:0},[x[9]||(x[9]=e("p",null,"No legacy ROIs",-1)),x[10]||(x[10]=e("p",{class:"text-sm mt-1"},"Legacy ROIs are preserved for historical data integrity",-1))],64)):(g(),y(ye,{key:1},[x[11]||(x[11]=e("p",null,"No ROIs defined",-1)),f.canEdit?(g(),y("p",wt,'Click "Add ROI" to create one')):O("",!0)],64))])):(g(),y("div",{key:3,class:"space-y-2",style:fe(_.value)},[(g(!0),y(ye,null,_e(M.value,U=>(g(),we(dt,{key:U.id,roi:U,selected:U.id===f.selectedId,"can-edit":f.canEdit&&!U.is_legacy,compact:f.compact,"is-legacy":U.is_legacy,onSelect:N,onEdit:F,onDelete:q},null,8,["roi","selected","can-edit","compact","is-legacy"]))),128))],4)),c.value&&w.value==="legacy"&&E.value.length>0?(g(),y("div",kt,[...x[13]||(x[13]=[e("div",{class:"alert alert-info py-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"text-sm"}," Legacy ROIs are preserved for L2/L3 historical product consistency. They cannot be edited or deleted. ")],-1)])])):O("",!0)]))}},W={IDLE:"idle",DRAWING:"drawing",EDITING:"editing"};function It(f={}){const{minPoints:B=3,vertexRadius:h=8,snapDistance:i=10}=f,w=S(W.IDLE),t=S([]),E=S({x:0,y:0}),d=S(-1),c=S(-1),M=S(!1),v=Me({r:255,g:100,b:100}),_=S(2),N=S(.3),F=$(()=>t.value.length>=B),q=$(()=>w.value===W.DRAWING),K=$(()=>w.value===W.EDITING),L=$(()=>w.value!==W.IDLE);function x(a,r){const I=r.x-a.x,o=r.y-a.y;return Math.sqrt(I*I+o*o)}function U(){w.value=W.DRAWING,t.value=[],d.value=-1,c.value=-1,M.value=!1}function G(a){return!a||a.length<B?(console.warn("Cannot edit polygon with fewer than",B,"points"),!1):(w.value=W.EDITING,t.value=a.map(r=>({x:r.x,y:r.y})),d.value=-1,c.value=-1,!0)}function j(a,r){w.value===W.DRAWING&&t.value.push({x:a,y:r})}function X(){t.value.length>0&&t.value.pop()}function k(){return F.value?(w.value=W.IDLE,!0):!1}function m(){w.value=W.IDLE,t.value=[],d.value=-1,c.value=-1,M.value=!1}function n(){return w.value!==W.EDITING||!F.value?null:(w.value=W.IDLE,[...t.value])}function p(a,r,I){for(let o=0;o<t.value.length;o++){const l=I(t.value[o].x,t.value[o].y);if(x({x:a,y:r},l)<=h)return o}return-1}function D(a,r,I,o,l){if(E.value={x:a,y:r},w.value===W.DRAWING&&t.value.length>0){const u=l(t.value[0].x,t.value[0].y);M.value=x({x:I,y:o},u)<=i}c.value>=0?t.value[c.value]={x:a,y:r}:w.value===W.EDITING&&(d.value=p(I,o,l))}function V(a,r){return w.value!==W.DRAWING?!1:M.value&&F.value?k():(j(a,r),!1)}function z(){return w.value!==W.DRAWING?!1:(t.value.length>B&&X(),k())}function T(a){w.value===W.EDITING&&(a<0||a>=t.value.length||(c.value=a))}function Q(){c.value=-1}function me(a,r,I){a<0||a>=t.value.length||(t.value[a]={x:r,y:I})}function pe(a){return t.value.length<=B||a<0||a>=t.value.length?!1:(t.value.splice(a,1),d.value=-1,!0)}function de(a,r,I){a<0||a>=t.value.length||t.value.splice(a+1,0,{x:r,y:I})}function ie(a,r,I){v.r=Math.max(0,Math.min(255,a)),v.g=Math.max(0,Math.min(255,r)),v.b=Math.max(0,Math.min(255,I))}function re(){return{points:[...t.value],color_r:v.r,color_g:v.g,color_b:v.b,thickness:_.value,alpha:N.value}}function se(a){a.points&&Array.isArray(a.points)&&G(a.points),a.color_r!==void 0&&(v.r=a.color_r),a.color_g!==void 0&&(v.g=a.color_g),a.color_b!==void 0&&(v.b=a.color_b),a.thickness!==void 0&&(_.value=a.thickness),a.alpha!==void 0&&(N.value=a.alpha)}function ue(){w.value=W.IDLE,t.value=[],E.value={x:0,y:0},d.value=-1,c.value=-1,M.value=!1}return{DRAWING_MODES:W,vertexRadius:h,snapDistance:i,minPoints:B,mode:w,points:t,cursorPosition:E,hoveredVertexIndex:d,draggingVertexIndex:c,isNearFirstVertex:M,color:v,thickness:_,alpha:N,isValidPolygon:F,isDrawing:q,isEditing:K,isActive:L,startDrawing:U,startEditing:G,addPoint:j,removeLastPoint:X,closePolygon:k,cancel:m,finishEditing:n,findVertexAtPosition:p,handleMouseMove:D,handleClick:V,handleDoubleClick:z,startDragVertex:T,stopDragVertex:Q,moveVertex:me,deleteVertex:pe,insertVertex:de,setColor:ie,getPolygonData:re,loadPolygonData:se,reset:ue}}const Rt={key:1,class:"absolute bottom-2 left-2 badge badge-neutral"},Ct={key:2,class:"absolute bottom-2 right-2 flex gap-2"},$t=["disabled"],Dt={__name:"ROIDrawingCanvas",props:{imageUrl:{type:String,default:""},existingRois:{type:Array,default:()=>[]},editingRoi:{type:Object,default:null},disabled:{type:Boolean,default:!1},height:{type:[Number,String],default:400},defaultColor:{type:Object,default:()=>({r:255,g:100,b:100})}},emits:["points-change","drawing-complete","drawing-cancel","roi-click"],setup(f,{expose:B,emit:h}){const i=f,w=h,t=It(),E=S(null),d=S(null),c=S(!1),M=S(!1);let v=null;const _=S(1),N=S(0),F=S(0);let q=!1,K=0,L=0;const x=$(()=>typeof i.height=="number"?i.height:parseInt(i.height)||400),U=$(()=>i.disabled?"not-allowed":t.isDrawing.value?"crosshair":t.draggingVertexIndex.value>=0?"grabbing":t.hoveredVertexIndex.value>=0?"grab":t.isEditing.value?"default":"crosshair");function G(o,l=1){const u=o.color_r??255,s=o.color_g??0,b=o.color_b??0;return`rgba(${u}, ${s}, ${b}, ${l})`}function j(o,l){return{x:o*_.value+N.value,y:l*_.value+F.value}}function X(o,l){return{x:(o-N.value)/_.value,y:(l-F.value)/_.value}}function k(o,l,u){if(!u||u.length<3)return!1;let s=!1;for(let b=0,R=u.length-1;b<u.length;R=b++){const P=u[b].x,A=u[b].y,Z=u[R].x,le=u[R].y;A>l!=le>l&&o<(Z-P)*(l-A)/(le-A)+P&&(s=!s)}return s}function m(o,l){const u=X(o,l);for(const s of i.existingRois)if(s.points&&k(u.x,u.y,s.points))return s;return null}function n(){const o=d.value;if(!o)return;const l=o.getContext("2d"),u=o.width,s=o.height;l.clearRect(0,0,u,s),l.fillStyle="#1a1a2e",l.fillRect(0,0,u,s),v&&c.value?(l.save(),l.translate(N.value,F.value),l.scale(_.value,_.value),l.drawImage(v,0,0),l.restore()):i.imageUrl?M.value?(l.fillStyle="#ff6b6b",l.font="16px sans-serif",l.textAlign="center",l.fillText("Failed to load image",u/2,s/2)):(l.fillStyle="#888",l.font="16px sans-serif",l.textAlign="center",l.fillText("Loading image...",u/2,s/2)):(l.fillStyle="#4a4a6a",l.font="16px sans-serif",l.textAlign="center",l.fillText("No image available",u/2,s/2)),i.existingRois.forEach(R=>{if(!R.points||R.points.length<3)return;l.beginPath();const P=j(R.points[0].x,R.points[0].y);l.moveTo(P.x,P.y);for(let A=1;A<R.points.length;A++){const Z=j(R.points[A].x,R.points[A].y);l.lineTo(Z.x,Z.y)}if(l.closePath(),l.fillStyle=G(R,.15),l.fill(),l.lineWidth=R.thickness??2,l.strokeStyle=G(R,.5),l.setLineDash([4,4]),l.stroke(),l.setLineDash([]),R.roi_name){const A=R.points;let Z=0,le=0;A.forEach(ne=>{Z+=ne.x,le+=ne.y}),Z/=A.length,le/=A.length;const ee=j(Z,le);l.font="11px sans-serif",l.fillStyle="rgba(255, 255, 255, 0.6)",l.textAlign="center",l.textBaseline="middle",l.fillText(R.roi_name,ee.x,ee.y)}});const b=t.points.value;if(b.length>0){l.beginPath();const R=j(b[0].x,b[0].y);l.moveTo(R.x,R.y);for(let P=1;P<b.length;P++){const A=j(b[P].x,b[P].y);l.lineTo(A.x,A.y)}if(t.isEditing.value&&b.length>=3&&(l.closePath(),l.fillStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, ${t.alpha.value})`,l.fill()),l.lineWidth=t.thickness.value,l.strokeStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 1)`,l.stroke(),t.isDrawing.value&&b.length>0){const P=j(b[b.length-1].x,b[b.length-1].y),A=j(t.cursorPosition.value.x,t.cursorPosition.value.y);l.beginPath(),l.moveTo(P.x,P.y),l.lineTo(A.x,A.y),l.setLineDash([5,5]),l.stroke(),l.setLineDash([]),t.isNearFirstVertex.value&&(l.beginPath(),l.moveTo(A.x,A.y),l.lineTo(R.x,R.y),l.strokeStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 0.5)`,l.setLineDash([3,3]),l.stroke(),l.setLineDash([]))}b.forEach((P,A)=>{const Z=j(P.x,P.y),le=A===t.hoveredVertexIndex.value,ee=A===t.draggingVertexIndex.value,ae=A===0&&t.isDrawing.value&&t.isNearFirstVertex.value;l.beginPath(),l.arc(Z.x,Z.y,ae?t.vertexRadius*1.5:t.vertexRadius,0,Math.PI*2),ee||ae?l.fillStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 1)`:le?l.fillStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 0.8)`:l.fillStyle="white",l.fill(),l.lineWidth=2,l.strokeStyle=`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, 1)`,l.stroke()})}if(t.isDrawing.value){l.fillStyle="rgba(0, 0, 0, 0.7)",l.fillRect(10,s-30,300,20),l.font="12px sans-serif",l.fillStyle="white",l.textAlign="left";let R="Click to add points";b.length>=3&&(t.isNearFirstVertex.value?R="Click to close polygon":R="Double-click or click first point to close"),l.fillText(R+" | Right-click: undo | Esc: cancel",15,s-16)}else t.isEditing.value&&(l.fillStyle="rgba(0, 0, 0, 0.7)",l.fillRect(10,s-30,250,20),l.font="12px sans-serif",l.fillStyle="white",l.textAlign="left",l.fillText("Drag vertices to edit | Esc: cancel",15,s-16))}function p(){if(!v||!d.value)return;const o=d.value,l=o.width/v.width,u=o.height/v.height;_.value=Math.min(l,u)*.95,N.value=(o.width-v.width*_.value)/2,F.value=(o.height-v.height*_.value)/2,n()}function D(o){o.preventDefault();const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top,R=o.deltaY>0?.9:1.1,P=Math.max(.1,Math.min(5,_.value*R)),A=X(s,b);_.value=P,N.value=s-A.x*P,F.value=b-A.y*P,n()}function V(o){if(i.disabled)return;const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top;if(t.isEditing.value&&o.button===0){const R=t.findVertexAtPosition(s,b,j);if(R>=0){t.startDragVertex(R);return}}(o.button===1||!t.isActive.value&&o.button===0)&&(q=!0,K=o.clientX,L=o.clientY)}function z(o){const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top,R=X(s,b);if(q){const P=o.clientX-K,A=o.clientY-L;N.value+=P,F.value+=A,K=o.clientX,L=o.clientY,n()}else t.isActive.value&&(t.handleMouseMove(R.x,R.y,s,b,j),n())}function T(){q=!1,t.draggingVertexIndex.value>=0&&(t.stopDragVertex(),w("points-change",[...t.points.value]))}function Q(o){if(i.disabled||o.button!==0)return;const u=d.value.getBoundingClientRect(),s=o.clientX-u.left,b=o.clientY-u.top,R=X(s,b);if(!t.isActive.value){const P=m(s,b);if(P){w("roi-click",P);return}ie()}t.isDrawing.value&&(t.handleClick(R.x,R.y)?w("drawing-complete",t.getPolygonData()):w("points-change",[...t.points.value]),n())}function me(o){if(i.disabled||!t.isDrawing.value)return;o.preventDefault(),t.handleDoubleClick()&&w("drawing-complete",t.getPolygonData()),n()}function pe(o){o.preventDefault(),!i.disabled&&t.isDrawing.value&&(t.removeLastPoint(),w("points-change",[...t.points.value]),n())}function de(o){o.key==="Escape"&&t.isActive.value&&se()}function ie(){t.startDrawing(),t.setColor(i.defaultColor.r,i.defaultColor.g,i.defaultColor.b),n()}function re(o){t.loadPolygonData(o),n()}function se(){t.cancel(),w("drawing-cancel"),n()}function ue(){if(!t.isValidPolygon.value)return null;const o=t.getPolygonData();return t.reset(),n(),o}function a(o,l,u){t.setColor(o,l,u),n()}function r(){const o=d.value,l=E.value;!o||!l||(o.width=l.clientWidth,o.height=x.value,c.value?p():n())}function I(){if(!i.imageUrl){c.value=!1,M.value=!1,n();return}v=new Image,v.crossOrigin="anonymous",v.onload=()=>{c.value=!0,M.value=!1,p()},v.onerror=()=>{c.value=!1,M.value=!0,n()},v.src=i.imageUrl}return Ie(()=>{$e(()=>{r(),I(),i.editingRoi&&re(i.editingRoi)}),window.addEventListener("resize",r),window.addEventListener("mouseup",T),window.addEventListener("keydown",de)}),De(()=>{window.removeEventListener("resize",r),window.removeEventListener("mouseup",T),window.removeEventListener("keydown",de)}),oe(()=>i.imageUrl,I),oe(()=>i.existingRois,n,{deep:!0}),oe(()=>i.editingRoi,o=>{o&&re(o)},{deep:!0}),B({fitToCanvas:p,draw:n,startDrawing:ie,startEditing:re,cancelDrawing:se,confirmEditing:ue,setColor:a,isDrawing:t.isDrawing,isEditing:t.isEditing,isActive:t.isActive,isValidPolygon:t.isValidPolygon,points:t.points}),(o,l)=>(g(),y("div",{ref_key:"containerRef",ref:E,class:"roi-drawing-container relative w-full bg-base-300 rounded-lg overflow-hidden"},[e("canvas",{ref_key:"canvasRef",ref:d,style:fe({height:`${x.value}px`,cursor:U.value}),class:"w-full",onWheel:D,onMousedown:V,onMousemove:z,onClick:Q,onDblclick:me,onContextmenu:pe},null,36),e("div",{class:"absolute top-2 right-2 flex gap-1"},[e("button",{class:"btn btn-sm btn-square btn-ghost bg-base-100/80 hover:bg-base-100",title:"Fit to view",onClick:p},[...l[1]||(l[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)])])]),Y(t).isActive.value?(g(),y("div",{key:0,class:J(["absolute top-2 left-2 badge",Y(t).isDrawing.value?"badge-primary":"badge-secondary"])},C(Y(t).isDrawing.value?"Drawing":"Editing"),3)):O("",!0),Y(t).points.value.length>0?(g(),y("div",Rt,C(Y(t).points.value.length)+" point"+C(Y(t).points.value.length!==1?"s":""),1)):O("",!0),Y(t).isActive.value?(g(),y("div",Ct,[e("button",{class:"btn btn-sm btn-ghost bg-base-100/80",onClick:se}," Cancel "),Y(t).isEditing.value||Y(t).isValidPolygon.value?(g(),y("button",{key:0,class:"btn btn-sm btn-primary",disabled:!Y(t).isValidPolygon.value,onClick:l[0]||(l[0]=()=>{Y(t).isDrawing.value?(Y(t).closePolygon(),w("drawing-complete",Y(t).getPolygonData())):w("drawing-complete",ue())})}," Confirm ",8,$t)):O("",!0)])):O("",!0)],512))}},St=Se(Dt,[["__scopeId","data-v-3d84026e"]]),Ot={key:0,class:"flex items-center justify-center gap-4 mb-4"},Mt={class:"flex items-center gap-2"},Lt={class:"flex items-center gap-2"},Et={key:1,class:"space-y-4"},Vt={class:"flex flex-wrap gap-2"},Pt=["title","onClick"],At={class:"alert alert-info py-2"},Bt={class:"text-sm"},Tt={key:0,class:"alert py-2"},jt={class:"text-sm"},Nt={class:"form-control"},zt=["disabled"],Ut={key:0,class:"label"},Ft={class:"form-control"},Yt={class:"form-control"},Xt={class:"flex flex-wrap gap-2 mb-3"},Ht=["title","onClick"],Gt={class:"grid grid-cols-3 gap-3"},Wt={class:"flex items-center gap-3 mt-3"},qt={class:"form-control"},Jt={class:"label"},Kt={class:"label-text-alt"},Qt={class:"form-control"},Zt={class:"label"},el={class:"label-text-alt"},tl=["disabled"],ll=["disabled"],nl=["disabled"],sl={key:0,class:"loading loading-spinner loading-sm"},al={__name:"ROIFormModal",props:{modelValue:{type:Boolean,default:!1},roi:{type:Object,default:null},instrumentId:{type:[Number,String],required:!0},instrumentName:{type:String,default:""},loading:{type:Boolean,default:!1},imageUrl:{type:String,default:""},existingRois:{type:Array,default:()=>[]}},emits:["update:modelValue","submit"],setup(f,{emit:B}){const h=f,i=B,w=S(null),t=S("draw"),E=S([]),d=S({roi_name:"",description:"",color_r:255,color_g:0,color_b:0,alpha:.3,thickness:2}),c=$(()=>E.value.length>=3),M=[{name:"Red",r:255,g:0,b:0},{name:"Green",r:0,g:200,b:0},{name:"Blue",r:0,g:100,b:255},{name:"Yellow",r:255,g:220,b:0},{name:"Magenta",r:255,g:0,b:200},{name:"Cyan",r:0,g:200,b:200},{name:"Orange",r:255,g:140,b:0},{name:"Purple",r:128,g:0,b:255}],v=$(()=>{var k;return!!((k=h.roi)!=null&&k.id)}),_=$(()=>v.value?`Edit ${h.roi.roi_name}`:t.value==="draw"?"Draw ROI Polygon":"ROI Details"),N=$(()=>h.imageUrl&&t.value==="draw"),F=$(()=>({backgroundColor:`rgb(${d.value.color_r}, ${d.value.color_g}, ${d.value.color_b})`}));oe(()=>h.roi,k=>{k?d.value={roi_name:k.roi_name||"",description:k.description||"",color_r:k.color_r??255,color_g:k.color_g??0,color_b:k.color_b??0,alpha:k.alpha??.3,thickness:k.thickness??2}:q()},{immediate:!0}),oe(()=>h.modelValue,k=>{k&&!h.roi&&q()});function q(){d.value={roi_name:"",description:"",color_r:255,color_g:0,color_b:0,alpha:.3,thickness:2},E.value=[],t.value=h.imageUrl?"draw":"details"}function K(k){d.value.color_r=k.r,d.value.color_g=k.g,d.value.color_b=k.b,w.value&&w.value.setColor(k.r,k.g,k.b)}function L(){i("update:modelValue",!1)}function x(k){E.value=k}function U(k){E.value=k.points,d.value.color_r=k.color_r,d.value.color_g=k.color_g,d.value.color_b=k.color_b,d.value.alpha=k.alpha,d.value.thickness=k.thickness,t.value="details"}function G(){E.value=[]}function j(){t.value="draw"}function X(){const k={...d.value,instrument_id:parseInt(h.instrumentId),points:E.value};v.value&&E.value.length===0&&h.roi.points&&(k.points=h.roi.points),i("submit",k)}return(k,m)=>(g(),we(Ye,{"model-value":f.modelValue,title:_.value,size:N.value?"lg":"md","onUpdate:modelValue":m[7]||(m[7]=n=>k.$emit("update:modelValue",n))},{default:he(()=>[f.imageUrl&&!v.value?(g(),y("div",Ot,[e("div",Mt,[e("div",{class:J(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",t.value==="draw"?"bg-primary text-primary-content":"bg-success text-success-content"])},C(t.value==="draw"?"1":"âœ“"),3),e("span",{class:J(t.value==="draw"?"font-medium":"text-base-content/60")},"Draw",2)]),m[8]||(m[8]=e("div",{class:"w-8 h-0.5 bg-base-300"},null,-1)),e("div",Lt,[e("div",{class:J(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",t.value==="details"?"bg-primary text-primary-content":"bg-base-300 text-base-content/60"])}," 2 ",2),e("span",{class:J(t.value==="details"?"font-medium":"text-base-content/60")},"Details",2)])])):O("",!0),N.value?(g(),y("div",Et,[m[10]||(m[10]=e("div",{class:"alert alert-info py-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"text-sm"},"Click on the image to draw ROI points. Double-click or click the first point to close.")],-1)),e("div",Vt,[m[9]||(m[9]=e("span",{class:"text-sm text-base-content/70"},"Color:",-1)),(g(),y(ye,null,_e(M,n=>e("button",{key:n.name,type:"button",class:"w-6 h-6 rounded border-2 border-base-300 hover:border-primary transition-colors",style:fe({backgroundColor:`rgb(${n.r}, ${n.g}, ${n.b})`}),title:n.name,onClick:p=>K(n)},null,12,Pt)),64))]),ve(St,{ref_key:"canvasRef",ref:w,"image-url":f.imageUrl,"existing-rois":f.existingRois,"editing-roi":v.value?f.roi:null,height:400,"default-color":{r:d.value.color_r,g:d.value.color_g,b:d.value.color_b},onPointsChange:x,onDrawingComplete:U,onDrawingCancel:G},null,8,["image-url","existing-rois","editing-roi","default-color"])])):(g(),y("form",{key:2,onSubmit:Le(X,["prevent"]),class:"space-y-4"},[e("div",At,[m[12]||(m[12]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Bt,[m[11]||(m[11]=te("ROI for: ",-1)),e("strong",null,C(f.instrumentName),1)])]),c.value?(g(),y("div",Tt,[m[13]||(m[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",jt,"Polygon drawn with "+C(E.value.length)+" points",1),f.imageUrl?(g(),y("button",{key:0,type:"button",class:"btn btn-ghost btn-xs",onClick:j}," Redraw ")):O("",!0)])):O("",!0),e("div",Nt,[m[15]||(m[15]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"ROI Name"),e("span",{class:"label-text-alt text-base-content/60"},"e.g., ROI_01")],-1)),ge(e("input",{"onUpdate:modelValue":m[0]||(m[0]=n=>d.value.roi_name=n),type:"text",class:"input input-bordered",placeholder:"Leave empty for auto-generated name",disabled:v.value},null,8,zt),[[be,d.value.roi_name]]),v.value?O("",!0):(g(),y("label",Ut,[...m[14]||(m[14]=[e("span",{class:"label-text-alt"},"Auto-generated if left empty",-1)])]))]),e("div",Ft,[m[16]||(m[16]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Description")],-1)),ge(e("textarea",{"onUpdate:modelValue":m[1]||(m[1]=n=>d.value.description=n),class:"textarea textarea-bordered",rows:"2",placeholder:"Optional description of this ROI..."},null,512),[[be,d.value.description]])]),e("div",Yt,[m[21]||(m[21]=e("label",{class:"label"},[e("span",{class:"label-text font-medium"},"Color")],-1)),e("div",Xt,[(g(),y(ye,null,_e(M,n=>e("button",{key:n.name,type:"button",class:"w-8 h-8 rounded-lg border-2 border-base-300 hover:border-primary transition-colors",style:fe({backgroundColor:`rgb(${n.r}, ${n.g}, ${n.b})`}),title:n.name,onClick:p=>K(n)},null,12,Ht)),64))]),e("div",Gt,[e("div",null,[m[17]||(m[17]=e("label",{class:"label py-0"},[e("span",{class:"label-text text-xs"},"Red")],-1)),ge(e("input",{"onUpdate:modelValue":m[2]||(m[2]=n=>d.value.color_r=n),type:"number",min:"0",max:"255",class:"input input-bordered input-sm w-full"},null,512),[[be,d.value.color_r,void 0,{number:!0}]])]),e("div",null,[m[18]||(m[18]=e("label",{class:"label py-0"},[e("span",{class:"label-text text-xs"},"Green")],-1)),ge(e("input",{"onUpdate:modelValue":m[3]||(m[3]=n=>d.value.color_g=n),type:"number",min:"0",max:"255",class:"input input-bordered input-sm w-full"},null,512),[[be,d.value.color_g,void 0,{number:!0}]])]),e("div",null,[m[19]||(m[19]=e("label",{class:"label py-0"},[e("span",{class:"label-text text-xs"},"Blue")],-1)),ge(e("input",{"onUpdate:modelValue":m[4]||(m[4]=n=>d.value.color_b=n),type:"number",min:"0",max:"255",class:"input input-bordered input-sm w-full"},null,512),[[be,d.value.color_b,void 0,{number:!0}]])])]),e("div",Wt,[e("div",{class:"w-12 h-12 rounded-lg border border-base-300",style:fe(F.value)},null,4),m[20]||(m[20]=e("span",{class:"text-sm text-base-content/60"},"Color preview",-1))])]),e("div",qt,[e("label",Jt,[m[22]||(m[22]=e("span",{class:"label-text font-medium"},"Opacity",-1)),e("span",Kt,C(Math.round(d.value.alpha*100))+"%",1)]),ge(e("input",{"onUpdate:modelValue":m[5]||(m[5]=n=>d.value.alpha=n),type:"range",min:"0.1",max:"0.8",step:"0.1",class:"range range-primary range-sm"},null,512),[[be,d.value.alpha,void 0,{number:!0}]])]),e("div",Qt,[e("label",Zt,[m[23]||(m[23]=e("span",{class:"label-text font-medium"},"Border Thickness",-1)),e("span",el,C(d.value.thickness)+"px",1)]),ge(e("input",{"onUpdate:modelValue":m[6]||(m[6]=n=>d.value.thickness=n),type:"range",min:"1",max:"10",step:"1",class:"range range-sm"},null,512),[[be,d.value.thickness,void 0,{number:!0}]])])],32))]),actions:he(()=>[e("button",{type:"button",class:"btn btn-ghost",disabled:f.loading,onClick:L}," Cancel ",8,tl),t.value==="details"&&f.imageUrl&&!v.value?(g(),y("button",{key:0,type:"button",class:"btn btn-ghost",disabled:f.loading,onClick:j}," Back ",8,ll)):O("",!0),t.value==="details"?(g(),y("button",{key:1,type:"submit",class:"btn btn-primary",disabled:f.loading||!c.value&&!v.value,onClick:X},[f.loading?(g(),y("span",sl)):O("",!0),te(" "+C(v.value?"Save Changes":"Create ROI"),1)],8,nl)):O("",!0)]),_:1},8,["model-value","title","size"]))}},ol={key:0,class:"flex justify-center py-12"},il={key:1,class:"alert alert-error"},rl={key:2},ul={class:"text-sm breadcrumbs mb-4"},cl={key:0},dl={key:1},vl={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},gl={class:"flex items-start justify-between"},fl={class:"flex items-start gap-4"},ml={class:"flex items-center gap-3"},pl={class:"text-2xl font-bold"},bl={class:"text-sm text-base-content/60 font-mono block mt-1"},hl={class:"flex items-center gap-4 mt-2"},yl={key:0,class:"text-base-content/50 ml-1"},xl={key:0,class:"text-base-content/60 mt-2"},wl={key:0,class:"flex gap-2"},kl={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},_l={class:"text-xl font-semibold mb-4"},Il={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Rl={class:"text-sm text-base-content/60"},Cl={key:1,class:"text-center py-8 text-base-content/60"},$l={key:0,class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},Dl={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Sl={key:0},Ol={class:"font-medium"},Ml={key:1},Ll={class:"font-medium"},El={key:2},Vl={class:"font-medium"},Pl={class:"bg-base-100 rounded-lg shadow-lg p-6 mb-6"},Al={class:"flex items-center justify-between mb-4"},Bl={class:"flex items-center gap-3"},Tl={class:"badge badge-lg"},jl={class:"flex items-center gap-2"},Nl={class:"label cursor-pointer gap-2"},zl={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ul={class:"lg:col-span-2"},Fl={class:"lg:col-span-1"},Yl={key:0,class:"mt-4 p-4 bg-base-200 rounded-lg"},Xl={class:"flex items-center justify-between mb-2"},Hl={class:"font-semibold"},Gl={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},Wl={class:"flex items-center gap-2"},ql={key:0,class:"mt-2 text-sm text-base-content/70"},Jl={class:"bg-base-100 rounded-lg shadow-lg p-6"},Kl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm"},Ql={class:"font-mono"},sn={__name:"InstrumentView",props:{id:{type:[Number,String],required:!0}},setup(f){const B=f,h=Pe(),i=Ae(),w=Te(),t=Ge(),E=Ue(),d=Fe(),c=$(()=>i.currentInstrument),M=$(()=>w.currentPlatform),v=$(()=>t.rois),_=$(()=>c.value?je(c.value.instrument_type):null),N=$(()=>c.value?Ne(c.value.instrument_type):{}),F=$(()=>{if(!c.value)return{};const u=c.value.specifications;if(u&&typeof u=="object")return u;if(typeof u=="string")try{return JSON.parse(u)}catch{return{}}return{}}),q=$(()=>N.value?Object.entries(N.value).map(([u,s])=>{var R;const b=F.value[u]??((R=c.value)==null?void 0:R[u]);return{key:u,label:s.label,value:b,config:s,hasValue:b!=null&&b!==""}}):[]),K=$(()=>c.value?Xe(c.value.status):null),L=$(()=>c.value?He(c.value.measurement_status):null),x=$(()=>M.value?E.canEditStation(M.value.station_id):!1),U=$(()=>i.loading||w.loading),G=$(()=>t.loading),j=S(!1),X=S(!1),k=S(!1),m=S(!1),n=S(null),p=S(null),D=S(null),V=S(!0);async function z(){const u=parseInt(B.id),s=await i.fetchInstrument(u);s&&(await w.fetchPlatform(s.platform_id),await t.fetchROIsByInstrument(u))}Ie(z),oe(()=>B.id,z);function T(){j.value=!0}async function Q(u){await i.updateInstrument(c.value.id,u)?(d.success("Instrument updated successfully"),j.value=!1):d.error(i.error||"Failed to update instrument")}function me(){X.value=!0}async function pe(){const u=c.value.platform_id;await i.deleteInstrument(c.value.id)?(d.success("Instrument deleted successfully"),X.value=!1,h.push({name:"platform",params:{id:u}})):d.error(i.error||"Failed to delete instrument")}function de(u){n.value=u}function ie(u){}function re(u){n.value=u}function se(){p.value=null,k.value=!0}function ue(u){p.value=u,k.value=!0}function a(u){D.value=u,m.value=!0}async function r(u){var s;(s=p.value)!=null&&s.id?await t.updateROI(p.value.id,u)?(d.success("ROI updated successfully"),k.value=!1,p.value=null):d.error(t.error||"Failed to update ROI"):await t.createROI(u)?(d.success("ROI created successfully"),k.value=!1):d.error(t.error||"Failed to create ROI")}async function I(){var s,b;if(!D.value)return;await t.deleteROI(D.value.id)?(d.success("ROI deleted successfully"),m.value=!1,D.value=null,((s=n.value)==null?void 0:s.id)===((b=D.value)==null?void 0:b.id)&&(n.value=null)):d.error(t.error||"Failed to delete ROI")}const o=$(()=>_.value&&{phenocam:"text-blue-500",multispectral:"text-purple-500",par_sensor:"text-amber-500",ndvi_sensor:"text-green-500",pri_sensor:"text-cyan-500",hyperspectral:"text-pink-500",thermal:"text-red-500",lidar:"text-teal-500",radar:"text-indigo-500"}[_.value.key]||"text-gray-500"),l=$(()=>_.value&&{phenocam:"bg-blue-500/10",multispectral:"bg-purple-500/10",par_sensor:"bg-amber-500/10",ndvi_sensor:"bg-green-500/10",pri_sensor:"bg-cyan-500/10",hyperspectral:"bg-pink-500/10",thermal:"bg-red-500/10",lidar:"bg-teal-500/10",radar:"bg-indigo-500/10"}[_.value.key]||"bg-gray-500/10");return(u,s)=>{var R,P,A,Z,le,ee,ne,ae,xe;const b=Ee("router-link");return g(),y("div",null,[U.value&&!c.value?(g(),y("div",ol,[...s[6]||(s[6]=[e("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):Y(i).error?(g(),y("div",il,[s[7]||(s[7]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,C(Y(i).error),1)])):c.value?(g(),y("div",rl,[e("div",ul,[e("ul",null,[e("li",null,[ve(b,{to:"/dashboard"},{default:he(()=>[...s[8]||(s[8]=[te("Dashboard",-1)])]),_:1})]),M.value?(g(),y("li",cl,[ve(b,{to:`/stations/${M.value.station_acronym}`},{default:he(()=>[te(C(M.value.station_acronym),1)]),_:1},8,["to"])])):O("",!0),M.value?(g(),y("li",dl,[ve(b,{to:`/platforms/${M.value.id}`},{default:he(()=>[te(C(M.value.normalized_name),1)]),_:1},8,["to"])])):O("",!0),e("li",null,C(c.value.normalized_name),1)])]),e("div",vl,[e("div",gl,[e("div",fl,[e("div",{class:J(["p-4 rounded-lg",l.value])},[(g(),y("svg",{xmlns:"http://www.w3.org/2000/svg",class:J(["h-8 w-8",o.value]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...s[9]||(s[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z M15 13a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])],2))],2),e("div",null,[e("div",ml,[e("h1",pl,C(c.value.display_name||c.value.normalized_name),1),e("span",{class:J(["badge",(R=K.value)==null?void 0:R.badgeClass])},C(c.value.status),3)]),e("code",bl,C(c.value.normalized_name),1),e("div",hl,[e("span",{class:J(["font-medium",o.value])},[te(C(((P=_.value)==null?void 0:P.name)||c.value.instrument_type)+" ",1),(A=_.value)!=null&&A.code?(g(),y("span",yl," ("+C(_.value.code)+") ",1)):O("",!0)],2),L.value?(g(),y("span",{key:0,class:J([L.value.textClass,"flex items-center gap-1"])},[e("span",{class:J(["w-2 h-2 rounded-full",L.value.dotClass])},null,2),te(" "+C(c.value.measurement_status),1)],2)):O("",!0)]),c.value.description?(g(),y("p",xl,C(c.value.description),1)):O("",!0)])]),x.value?(g(),y("div",wl,[e("button",{class:"btn btn-outline btn-sm",onClick:T},[...s[10]||(s[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),te(" Edit ",-1)])]),e("button",{class:"btn btn-outline btn-error btn-sm",onClick:me},[...s[11]||(s[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),te(" Delete ",-1)])])])):O("",!0)])]),e("div",kl,[e("h2",_l,C(((Z=_.value)==null?void 0:Z.name)||"Instrument")+" Specifications ",1),q.value.length>0?(g(),y("div",Il,[(g(!0),y(ye,null,_e(q.value,H=>(g(),y("div",{key:H.key,class:"space-y-1"},[e("label",Rl,C(H.label),1),e("div",{class:J(["font-medium",{"text-base-content/40 italic":!H.hasValue}])},C(H.hasValue?Y(ze)(H.value,H.config):"Not specified"),3)]))),128))])):(g(),y("div",Cl,[...s[12]||(s[12]=[e("p",null,"No specifications defined for this instrument type.",-1)])]))]),c.value.deployment_date||c.value.calibration_date?(g(),y("div",$l,[s[16]||(s[16]=e("h2",{class:"text-xl font-semibold mb-4"},"Timeline",-1)),e("div",Dl,[c.value.deployment_date?(g(),y("div",Sl,[s[13]||(s[13]=e("label",{class:"text-sm text-base-content/60"},"Deployment Date",-1)),e("div",Ol,C(new Date(c.value.deployment_date).toLocaleDateString()),1)])):O("",!0),c.value.calibration_date?(g(),y("div",Ml,[s[14]||(s[14]=e("label",{class:"text-sm text-base-content/60"},"Last Calibration",-1)),e("div",Ll,C(new Date(c.value.calibration_date).toLocaleDateString()),1)])):O("",!0),c.value.created_at?(g(),y("div",El,[s[15]||(s[15]=e("label",{class:"text-sm text-base-content/60"},"Added to System",-1)),e("div",Vl,C(new Date(c.value.created_at).toLocaleDateString()),1)])):O("",!0)])])):O("",!0),e("div",Pl,[e("div",Al,[e("div",Bl,[s[17]||(s[17]=e("h2",{class:"text-xl font-semibold"}," Regions of Interest (ROIs) ",-1)),e("span",Tl,C(v.value.length),1)]),e("div",jl,[e("label",Nl,[s[18]||(s[18]=e("span",{class:"label-text text-sm"},"Labels",-1)),ge(e("input",{"onUpdate:modelValue":s[0]||(s[0]=H=>V.value=H),type:"checkbox",class:"toggle toggle-sm toggle-primary"},null,512),[[Ve,V.value]])])])]),e("div",zl,[e("div",Ul,[ve(Y(tt),{rois:v.value,"selected-roi-id":(le=n.value)==null?void 0:le.id,"show-labels":V.value,height:400,onRoiClick:de,onRoiHover:ie},null,8,["rois","selected-roi-id","show-labels"]),s[19]||(s[19]=e("p",{class:"text-sm text-base-content/60 mt-2"}," Scroll to zoom, drag to pan. Click ROI to select. ",-1))]),e("div",Fl,[ve(Y(_t),{rois:v.value,"selected-id":(ee=n.value)==null?void 0:ee.id,"can-edit":x.value,loading:G.value,"max-height":350,onSelect:re,onEdit:ue,onDelete:a,onCreate:se},null,8,["rois","selected-id","can-edit","loading"])])]),n.value?(g(),y("div",Yl,[e("div",Xl,[e("h3",Hl,C(n.value.roi_name),1),e("button",{class:"btn btn-ghost btn-xs",onClick:s[1]||(s[1]=H=>n.value=null)},[...s[20]||(s[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Gl,[e("div",null,[s[21]||(s[21]=e("label",{class:"text-base-content/60"},"Points",-1)),e("div",null,C(((ne=n.value.points)==null?void 0:ne.length)||0),1)]),e("div",null,[s[22]||(s[22]=e("label",{class:"text-base-content/60"},"Color",-1)),e("div",Wl,[e("div",{class:"w-4 h-4 rounded border border-base-300",style:fe({backgroundColor:`rgb(${n.value.color_r??255}, ${n.value.color_g??0}, ${n.value.color_b??0})`})},null,4),e("span",null,"RGB("+C(n.value.color_r??255)+", "+C(n.value.color_g??0)+", "+C(n.value.color_b??0)+")",1)])]),e("div",null,[s[23]||(s[23]=e("label",{class:"text-base-content/60"},"Auto Generated",-1)),e("div",null,C(n.value.auto_generated?"Yes":"No"),1)]),e("div",null,[s[24]||(s[24]=e("label",{class:"text-base-content/60"},"Created",-1)),e("div",null,C(n.value.created_at?new Date(n.value.created_at).toLocaleDateString():"-"),1)])]),n.value.description?(g(),y("p",ql,C(n.value.description),1)):O("",!0)])):O("",!0)]),e("div",Jl,[s[29]||(s[29]=e("h2",{class:"text-xl font-semibold mb-4"},"Metadata",-1)),e("div",Kl,[e("div",null,[s[25]||(s[25]=e("label",{class:"text-base-content/60"},"ID",-1)),e("div",Ql,C(c.value.id),1)]),e("div",null,[s[26]||(s[26]=e("label",{class:"text-base-content/60"},"Platform",-1)),M.value?(g(),we(b,{key:0,to:`/platforms/${M.value.id}`,class:"link link-primary"},{default:he(()=>[te(C(M.value.normalized_name),1)]),_:1},8,["to"])):O("",!0)]),e("div",null,[s[27]||(s[27]=e("label",{class:"text-base-content/60"},"Created",-1)),e("div",null,C(c.value.created_at?new Date(c.value.created_at).toLocaleString():"-"),1)]),e("div",null,[s[28]||(s[28]=e("label",{class:"text-base-content/60"},"Last Updated",-1)),e("div",null,C(c.value.updated_at?new Date(c.value.updated_at).toLocaleString():"-"),1)])])])])):O("",!0),c.value&&M.value?(g(),we(Y(Be),{key:3,modelValue:j.value,"onUpdate:modelValue":s[2]||(s[2]=H=>j.value=H),instrument:c.value,"platform-id":c.value.platform_id,"platform-name":M.value.normalized_name,"platform-type":M.value.platform_type,onSubmit:Q},null,8,["modelValue","instrument","platform-id","platform-name","platform-type"])):O("",!0),ve(Y(Ce),{modelValue:X.value,"onUpdate:modelValue":s[3]||(s[3]=H=>X.value=H),title:"Delete Instrument",message:`Are you sure you want to delete '${(ae=c.value)==null?void 0:ae.normalized_name}'? This will also delete all associated ROIs. This action cannot be undone.`,"confirm-text":"Delete Instrument",variant:"error",loading:Y(i).loading,onConfirm:pe},null,8,["modelValue","message","loading"]),c.value?(g(),we(Y(al),{key:4,modelValue:k.value,"onUpdate:modelValue":s[4]||(s[4]=H=>k.value=H),roi:p.value,"instrument-id":c.value.id,"instrument-name":c.value.normalized_name,loading:Y(t).loading,onSubmit:r},null,8,["modelValue","roi","instrument-id","instrument-name","loading"])):O("",!0),ve(Y(Ce),{modelValue:m.value,"onUpdate:modelValue":s[5]||(s[5]=H=>m.value=H),title:"Delete ROI",message:`Are you sure you want to delete '${(xe=D.value)==null?void 0:xe.roi_name}'? This action cannot be undone.`,"confirm-text":"Delete ROI",variant:"error",loading:Y(t).loading,onConfirm:I},null,8,["modelValue","message","loading"])])}}};export{sn as default};
