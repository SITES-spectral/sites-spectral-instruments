/**
 * Mobile Enhancements
 * SITES Spectral v13.13.0
 *
 * Enhanced mobile responsiveness including:
 * - 1024px tablet landscape breakpoint
 * - Hamburger navigation improvements
 * - Modal overflow fixes (max-height: 90vh)
 * - 44x44px minimum touch targets (WCAG 2.5.5)
 * - Touch-friendly controls
 */

/* ==========================================================================
   Touch Target Sizing (WCAG 2.5.5 - Minimum 44x44px)
   ========================================================================== */

/* Ensure all buttons meet minimum touch target size */
.btn,
.btn-primary,
.btn-secondary,
.btn-danger,
.btn-ghost,
.tab-button,
.modal-close,
.modal-close-large {
    min-height: 44px;
    min-width: 44px;
}

/* Icon-only buttons need padding for touch targets */
.btn-icon,
.action-btn,
.admin-edit-btn,
.admin-delete-btn {
    min-height: 44px;
    min-width: 44px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

/* Form inputs touch targets */
.form-input,
.form-select,
select,
input[type="text"],
input[type="email"],
input[type="password"],
input[type="number"],
input[type="date"],
input[type="url"],
textarea {
    min-height: 44px;
    padding: 0.625rem 0.875rem;
}

/* Checkbox and radio touch targets */
input[type="checkbox"],
input[type="radio"] {
    min-width: 20px;
    min-height: 20px;
    cursor: pointer;
}

/* Clickable labels need adequate spacing */
label {
    padding: 0.25rem 0;
}

/* ==========================================================================
   Tablet Landscape Breakpoint (1024px)
   ========================================================================== */

@media (max-width: 1024px) {
    /* Dashboard layout adjustments */
    .dashboard-content {
        padding: 1.5rem;
    }

    .dashboard-controls {
        flex-direction: column;
        gap: 1.5rem;
        padding: 1.25rem;
    }

    .dashboard-stats {
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
    }

    /* Grid adjustments for tablet */
    .stations-grid {
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    }

    .platforms-container {
        grid-template-columns: 1fr;
    }

    .analytics-overview {
        grid-template-columns: repeat(2, 1fr);
    }

    .analytics-charts {
        grid-template-columns: 1fr;
    }

    /* Table horizontal scroll */
    .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    /* Form layout */
    .form-row {
        flex-direction: column;
        gap: 1rem;
    }

    .form-row .form-group {
        width: 100%;
    }

    /* Modal adjustments */
    .modal-content-large {
        width: 95%;
        max-width: 95%;
        margin: 1rem auto;
    }
}

/* ==========================================================================
   Mobile Breakpoint (768px)
   ========================================================================== */

@media (max-width: 768px) {
    /* Header/Navigation */
    .dashboard-header {
        padding: 1.25rem 0;
    }

    .dashboard-header .container {
        padding: 0 1rem;
    }

    .dashboard-title {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }

    .dashboard-title h1 {
        font-size: 1.75rem;
    }

    /* User info responsive */
    .user-info {
        flex-wrap: wrap;
        justify-content: center;
        padding: 0.75rem 1rem;
    }

    /* Stats grid */
    .dashboard-stats {
        flex-direction: column;
        gap: 0.75rem;
    }

    .stat-item {
        width: 100%;
        justify-content: flex-start;
    }

    /* Admin controls */
    .admin-controls {
        width: 100%;
        justify-content: center;
    }

    /* Tab navigation - horizontal scroll */
    .dashboard-tabs {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        flex-wrap: nowrap;
        gap: 0;
        padding-bottom: 0.5rem;
    }

    .tab-button {
        flex-shrink: 0;
        padding: 0.875rem 1.25rem;
        white-space: nowrap;
    }

    /* Stations grid single column */
    .stations-grid,
    .users-grid {
        grid-template-columns: 1fr;
    }

    /* Station cards */
    .station-card {
        padding: 1rem;
    }

    .station-card-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
    }

    .station-stats {
        flex-wrap: wrap;
        gap: 0.5rem;
    }

    .station-stat {
        flex: 1;
        min-width: 80px;
    }

    /* Platform cards */
    .platform-card {
        padding: 1rem;
    }

    .platform-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
    }

    /* Instrument lists */
    .instrument-item {
        padding: 0.875rem;
    }

    .instrument-info {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }

    /* Analytics */
    .analytics-overview {
        grid-template-columns: 1fr;
    }

    .analytics-card {
        padding: 1.25rem;
    }

    /* Form sections */
    .form-section {
        padding: 1rem;
    }

    .form-actions {
        flex-direction: column-reverse;
        gap: 0.75rem;
    }

    .form-actions .btn {
        width: 100%;
    }

    /* Hide secondary text on mobile */
    .hide-on-mobile {
        display: none;
    }
}

/* ==========================================================================
   Small Mobile (480px)
   ========================================================================== */

@media (max-width: 480px) {
    /* Dashboard content */
    .dashboard-content {
        padding: 0.75rem;
    }

    .dashboard-controls {
        padding: 1rem;
    }

    /* Title sizing */
    .dashboard-title h1 {
        font-size: 1.5rem;
    }

    /* Stat items stack */
    .stat-item {
        padding: 0.75rem;
    }

    .stat-icon {
        font-size: 1.25rem;
    }

    .stat-details h3 {
        font-size: 1.25rem;
    }

    /* Card adjustments */
    .station-card,
    .platform-card,
    .user-card {
        border-radius: 12px;
    }

    /* Buttons stack */
    .btn-group {
        flex-direction: column;
        width: 100%;
    }

    .btn-group .btn {
        width: 100%;
    }
}

/* ==========================================================================
   Modal Overflow Fixes
   ========================================================================== */

/* Base modal constraints */
.modal-content,
.modal-content-large,
.station-modal .modal-content-large,
.platform-modal .modal-content-large,
.security-modal-content {
    max-height: 90vh;
    max-height: 90dvh; /* Dynamic viewport height for mobile browsers */
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

/* Modal body scrollable */
.modal-body,
.modal-body-large,
.security-modal-body {
    max-height: calc(90vh - 140px);
    max-height: calc(90dvh - 140px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

/* Fixed modal header */
.modal-header,
.modal-header-large,
.security-modal-header {
    position: sticky;
    top: 0;
    z-index: 10;
    background: inherit;
}

/* Modal close button touch target */
.modal-close,
.modal-close-large {
    min-width: 44px;
    min-height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    border-radius: 8px;
    transition: background-color 0.2s ease;
}

.modal-close:hover,
.modal-close-large:hover {
    background-color: rgba(0, 0, 0, 0.1);
}

@media (max-width: 768px) {
    /* Full-width modals on mobile */
    .modal-content,
    .modal-content-large {
        width: 100%;
        max-width: 100%;
        margin: 0;
        border-radius: 16px 16px 0 0;
        max-height: 95vh;
        max-height: 95dvh;
    }

    /* Position modals at bottom on mobile (drawer style) */
    .station-modal,
    .platform-modal,
    .security-modal {
        align-items: flex-end;
    }

    .modal-body-large {
        max-height: calc(95vh - 140px);
        max-height: calc(95dvh - 140px);
    }
}

/* ==========================================================================
   Hamburger Navigation
   ========================================================================== */

/* Mobile navigation toggle */
.nav-toggle {
    display: none;
    min-width: 44px;
    min-height: 44px;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    color: inherit;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 8px;
    transition: background-color 0.2s ease;
}

.nav-toggle:hover,
.nav-toggle:focus {
    background-color: rgba(255, 255, 255, 0.1);
}

.nav-toggle-icon {
    width: 24px;
    height: 2px;
    background: currentColor;
    position: relative;
    transition: background-color 0.2s ease;
}

.nav-toggle-icon::before,
.nav-toggle-icon::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 2px;
    background: currentColor;
    left: 0;
    transition: transform 0.3s ease;
}

.nav-toggle-icon::before {
    top: -8px;
}

.nav-toggle-icon::after {
    bottom: -8px;
}

/* Hamburger open state */
.nav-toggle.is-open .nav-toggle-icon {
    background-color: transparent;
}

.nav-toggle.is-open .nav-toggle-icon::before {
    transform: rotate(45deg) translate(5px, 6px);
}

.nav-toggle.is-open .nav-toggle-icon::after {
    transform: rotate(-45deg) translate(5px, -6px);
}

@media (max-width: 768px) {
    .nav-toggle {
        display: flex;
    }

    /* Mobile navigation menu */
    .nav-menu {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.9);
        z-index: 1000;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 1.5rem;
    }

    .nav-menu.is-open {
        display: flex;
    }

    .nav-menu a {
        font-size: 1.25rem;
        padding: 1rem 2rem;
        min-height: 44px;
        display: flex;
        align-items: center;
    }
}

/* ==========================================================================
   Touch-Friendly Interactions
   ========================================================================== */

/* Remove hover styles on touch devices */
@media (hover: none) and (pointer: coarse) {
    /* Disable hover effects on touch devices */
    .station-card:hover,
    .platform-card:hover,
    .user-card:hover,
    .instrument-item:hover {
        transform: none;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    /* Active states instead */
    .station-card:active,
    .platform-card:active,
    .user-card:active,
    .instrument-item:active {
        transform: scale(0.98);
        opacity: 0.9;
    }

    /* Larger tap targets for links */
    a {
        padding: 0.25rem 0;
    }
}

/* Smooth scrolling for all scrollable areas */
.modal-body,
.modal-body-large,
.table-container,
.dashboard-tabs {
    scroll-behavior: smooth;
}

/* Prevent text selection during scroll */
.touchscroll {
    -webkit-user-select: none;
    user-select: none;
}

/* ==========================================================================
   Safe Area Insets (Notch Devices)
   ========================================================================== */

/* Support for devices with notches (iPhone X+, etc.) */
@supports (padding: env(safe-area-inset-top)) {
    .dashboard-header {
        padding-top: calc(1.5rem + env(safe-area-inset-top));
    }

    .modal-content,
    .modal-content-large {
        padding-bottom: env(safe-area-inset-bottom);
    }

    /* Bottom-positioned modals */
    @media (max-width: 768px) {
        .station-modal .modal-content-large,
        .platform-modal .modal-content-large {
            padding-bottom: calc(1rem + env(safe-area-inset-bottom));
        }
    }
}

/* ==========================================================================
   Landscape Orientation Fixes
   ========================================================================== */

@media (max-height: 500px) and (orientation: landscape) {
    /* Reduce header padding in landscape */
    .dashboard-header {
        padding: 0.75rem 0;
    }

    .dashboard-title h1 {
        font-size: 1.5rem;
    }

    /* Smaller modals in landscape */
    .modal-content,
    .modal-content-large {
        max-height: 85vh;
    }

    .modal-body-large {
        max-height: calc(85vh - 100px);
    }

    /* Hide non-essential elements */
    .dashboard-subtitle {
        display: none;
    }
}

/* ==========================================================================
   Print Styles for Mobile
   ========================================================================== */

@media print {
    /* Hide interactive elements */
    .nav-toggle,
    .btn,
    .admin-controls,
    .form-actions {
        display: none !important;
    }

    /* Reset modal styles */
    .modal-content,
    .modal-content-large {
        max-height: none;
        overflow: visible;
    }
}
